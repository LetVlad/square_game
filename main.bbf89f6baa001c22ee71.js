(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/6Yf":function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return u}),n.d(e,"c",function(){return a});var r=n("mAIw"),i=n("qOnz"),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),s="[DEFAULT]",a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=s);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.a;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Object(r.a)({identifier:s,optional:!1},t),n=e.optional,i=this.normalizeInstanceIdentifier(e.identifier);try{var o=this.getOrInitializeService(i);if(!o){if(n)return null;throw Error("Service "+this.name+" is not available")}return o}catch(a){if(n)return null;throw a}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(s)}catch(h){}try{for(var i=Object(r.h)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=Object(r.e)(o.value,2),u=a[1],c=this.normalizeInstanceIdentifier(a[0]);try{var l=this.getOrInitializeService(c);u.resolve(l)}catch(h){}}}catch(f){e={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=s),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Object(r.b)(this,void 0,void 0,function(){var t;return Object(r.d)(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Object(r.f)(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return e.sent(),[2]}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===s?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:s:t},t}(),u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},0:function(t,e,n){t.exports=n("zUnb")},"2QA8":function(t,e,n){"use strict";n.d(e,"a",function(){return r});const r=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())()},"2fFW":function(t,e,n){"use strict";n.d(e,"a",function(){return i});let r=!1;const i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}}},"3N8a":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("quSY");class i extends r.a{constructor(t,e){super()}schedule(t,e=0){return this}}class o extends i{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}},"3UD+":function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},"6Uf2":function(t,e,n){"use strict";(function(t){var e,r=n("zIRd"),i=n("mAIw"),o=n("qOnz"),s=n("q/0M"),a=n("/6Yf"),u=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Object(o.F)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:Object(o.z)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),c=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return Object(o.h)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),l=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new u(e)}}catch(n){}return new c},h=l("localStorage"),f=l("sessionStorage"),d=new s.b("@firebase/database"),p=(e=1,function(){return e++}),y=function(t){var e=Object(o.E)(t),n=new o.c;n.update(e);var r=n.digest();return o.f.encodeByteArray(r)},v=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=v.apply(null,i):n+="object"==typeof i?Object(o.F)(i):i,n+=" "}return n},g=null,m=!0,_=function(t,e){Object(o.d)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(d.logLevel=s.a.VERBOSE,g=d.log.bind(d),e&&f.set("logging_enabled",!0)):"function"==typeof t?g=t:(g=null,f.remove("logging_enabled"))},b=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===m&&(m=!1,null===g&&!0===f.get("logging_enabled")&&_(!0)),g){var n=v.apply(null,t);g(n)}},w=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];b.apply(void 0,Object(i.f)([t],e))}},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+v.apply(void 0,Object(i.f)(t));d.error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+v.apply(void 0,Object(i.f)(t));throw d.error(n),new Error(n)},O=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+v.apply(void 0,Object(i.f)(t));d.warn(n)},T=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},I="[MIN_NAME]",S="[MAX_NAME]",x=function(t,e){if(t===e)return 0;if(t===I||e===S)return-1;if(e===I||t===S)return 1;var n=G(t),r=G(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},N=function(t,e){return t===e?0:t<e?-1:1},j=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Object(o.F)(e))},A=function(t){if("object"!=typeof t||null===t)return Object(o.F)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=Object(o.F)(e[i]),r+=":",r+=A(t[e[i]]);return r+"}"},k=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function D(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var P,R,F,L,M,V,U,H,q,B,z=function(t){var e,n,r,i,s;Object(o.d)(!T(t),"Invalid JSON number"),0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var a=[];for(s=52;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse();var u=a.join(""),c="";for(s=0;s<64;s+=8){var l=parseInt(u.substr(s,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},W=new RegExp("^-?(0*)\\d{1,10}$"),G=function(t){if(W.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},Q=function(t){try{t()}catch(e){setTimeout(function(){throw O("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},K=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},Y=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!1,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=x(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),J=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(o.D)(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=Object(o.D)(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=Object(o.D)(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),$="firebaseio.com",X="websocket",Z="long_polling",tt=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=h.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&h.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(Object(o.d)("string"==typeof t,"typeof type must == string"),Object(o.d)("object"==typeof e,"typeof params must == object"),t===X)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==Z)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return D(e,function(t,e){r.push(t+"="+e)}),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}(),et=function(t,e){var n=nt(t),r=n.namespace;return"firebase.com"===n.domain&&C(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||C("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&O("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new tt(n.host,n.secure,r,e,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new Y(n.pathString)}},nt=function(t){var e="",n="",r="",o="",s="",a=!0,u="https",c=443;if("string"==typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(o=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}(t.substring(h,f)));var d=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var o=Object(i.h)(t.split("&")),s=o.next();!s.done;s=o.next()){var a=s.value;if(0!==a.length){var u=a.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):O("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(l=e.indexOf(":"))>=0?(a="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=e.length;var p=e.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var y=e.indexOf(".");r=e.substring(0,y).toLowerCase(),n=e.substring(y+1),s=r}"ns"in d&&(s=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:a,scheme:u,pathString:o,namespace:s}},rt=/[\[\].#$\/\u0000-\u001F\u007F]/,it=/[\[\].#$\u0000-\u001F\u007F]/,ot=10485760,st=function(t){return"string"==typeof t&&0!==t.length&&!rt.test(t)},at=function(t){return"string"==typeof t&&0!==t.length&&!it.test(t)},ut=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!T(t)||t&&"object"==typeof t&&Object(o.h)(t,".sv")},ct=function(t,e,n,r,i){i&&void 0===n||lt(Object(o.l)(t,e,i),n,r)},lt=function(t,e,n){var r=n instanceof Y?new J(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(T(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>ot/3&&Object(o.D)(e)>ot)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,s=!1;if(D(e,function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!st(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),lt(t,n,r),r.pop()}),i&&s)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},ht=function(t,e,n,r,i){if(!i||void 0!==n){var s=Object(o.l)(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(s+" must be an object containing the children to replace.");var a=[];D(n,function(t,e){var n=new Y(t);if(lt(s,e,r.child(n)),".priority"===n.getBack()&&!ut(e))throw new Error(s+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)}),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!st(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Y.comparePaths);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&s.contains(r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(s,a)}},ft=function(t,e,n,r){if(!r||void 0!==n){if(T(n))throw new Error(Object(o.l)(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ut(n))throw new Error(Object(o.l)(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},dt=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(o.l)(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},pt=function(t,e,n,r){if(!(r&&void 0===n||st(n)))throw new Error(Object(o.l)(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},yt=function(t,e,n,r){if(!(r&&void 0===n||at(n)))throw new Error(Object(o.l)(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},vt=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),yt(t,e,n,r)},gt=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},mt=function(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!st(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),at(t)}(r))throw new Error(Object(o.l)(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},_t=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(o.l)(t,e,r)+"must be a boolean.")},bt=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){Object(o.G)("OnDisconnect.cancel",0,1,arguments.length),Object(o.H)("OnDisconnect.cancel",1,t,!0);var e=new o.a;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){Object(o.G)("OnDisconnect.remove",0,1,arguments.length),gt("OnDisconnect.remove",this.path_),Object(o.H)("OnDisconnect.remove",1,t,!0);var e=new o.a;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){Object(o.G)("OnDisconnect.set",1,2,arguments.length),gt("OnDisconnect.set",this.path_),ct("OnDisconnect.set",1,t,this.path_,!1),Object(o.H)("OnDisconnect.set",2,e,!0);var n=new o.a;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){Object(o.G)("OnDisconnect.setWithPriority",2,3,arguments.length),gt("OnDisconnect.setWithPriority",this.path_),ct("OnDisconnect.setWithPriority",1,t,this.path_,!1),ft("OnDisconnect.setWithPriority",2,e,!1),Object(o.H)("OnDisconnect.setWithPriority",3,n,!0);var r=new o.a;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(Object(o.G)("OnDisconnect.update",1,2,arguments.length),gt("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,O("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ht("OnDisconnect.update",1,t,this.path_,!1),Object(o.H)("OnDisconnect.update",2,e,!0);var i=new o.a;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),wt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return Object(o.G)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Et=(P="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",R=0,F=[],function(t){var e,n=t===R;R=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=P.charAt(t%64),t=Math.floor(t/64);Object(o.d)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===F[e];e--)F[e]=0;F[e]++}else for(e=0;e<12;e++)F[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=P.charAt(F[e]);return Object(o.d)(20===i.length,"nextPushId: Length should be 20."),i}),Ct=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Ot=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ct(I,t),r=new Ct(I,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ct.MIN},t}(),Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return L},set:function(t){L=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return x(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw Object(o.e)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ct.MIN},e.prototype.maxPost=function(){return new Ct(S,L)},e.prototype.makePost=function(t,e){return Object(o.d)("string"==typeof t,"KeyIndex indexValue must always be a string."),new Ct(t,L)},e.prototype.toString=function(){return".key"},e}(Ot),It=new Tt,St=function(t){return"number"==typeof t?"number:"+z(t):"string:"+t},xt=function(t){if(t.isLeafNode()){var e=t.val();Object(o.d)("string"==typeof e||"number"==typeof e||"object"==typeof e&&Object(o.h)(e,".sv"),"Priority must be a string or number.")}else Object(o.d)(t===M||t.isEmpty(),"priority of unexpected type.");Object(o.d)(t===M||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Nt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Object(o.d)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),xt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return V},set:function(t){V=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(o.d)(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+St(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?z(this.value_):this.value_,this.lazyHash_=y(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(Object(o.d)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),s=t.VALUE_TYPE_ORDER.indexOf(r);return Object(o.d)(i>=0,"Unknown leaf type: "+n),Object(o.d)(s>=0,"Unknown leaf type: "+r),i===s?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){return t===this||!!t.isLeafNode()&&this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),jt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?x(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ct.MIN},e.prototype.maxPost=function(){return new Ct(S,new Nt("[PRIORITY-POST]",H))},e.prototype.makePost=function(t,e){var n=U(t);return new Ct(e,new Nt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Ot)),At=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),kt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Pt.EMPTY_NODE,this.right=null!=o?o:Pt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Pt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Pt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Dt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new kt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Pt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,kt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,kt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new At(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new At(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new At(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new At(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Dt,t}(),Rt=Math.log(2),Ft=function(){function t(t){this.count=parseInt(Math.log(t+1)/Rt,10),this.current_=this.count-1;var e=parseInt(Array(this.count+1).join("1"),2);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Lt=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,s,a=r-e;if(0===a)return null;if(1===a)return o=t[e],s=n?n(o):o,new kt(s,o.node,kt.BLACK,null,null);var u=parseInt(a/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],s=n?n(o):o,new kt(s,o.node,kt.BLACK,c,l)},o=function(e){for(var r=null,o=null,s=t.length,a=function(e,r){var o=s-e,a=s;s-=e;var c=i(o+1,a),l=t[o],h=n?n(l):l;u(new kt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?a(h,kt.BLACK):(a(h,kt.BLACK),a(h,kt.RED))}return o}(new Ft(t.length));return new Pt(r||e,o)},Mt={},Vt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return Object(o.d)(Mt&&jt,"ChildrenNode.ts has not been loaded"),q=q||new t({".priority":Mt},{".priority":jt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=Object(o.C)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Pt?e:null},t.prototype.hasIndex=function(t){return Object(o.h)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){Object(o.d)(e!==It,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,s=[],a=!1,u=n.getIterator(Ct.Wrap),c=u.getNext();c;)a=a||e.isDefinedOn(c.node),s.push(c),c=u.getNext();r=a?Lt(s,e.getCompare()):Mt;var l=e.toString(),h=Object(i.a)({},this.indexSet_);h[l]=e;var f=Object(i.a)({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(Object(o.A)(this.indexes_,function(t,i){var s=Object(o.C)(r.indexSet_,i);if(Object(o.d)(s,"Missing index implementation for "+i),t===Mt){if(s.isDefinedOn(e.node)){for(var a=[],u=n.getIterator(Ct.Wrap),c=u.getNext();c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Lt(a,s.getCompare())}return Mt}var l=n.get(e.name),h=t;return l&&(h=h.remove(new Ct(e.name,l))),h.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(Object(o.A)(this.indexes_,function(t){if(t===Mt)return t;var r=n.get(e.name);return r?t.remove(new Ct(e.name,r)):t}),this.indexSet_)},t}();function Ut(t,e){return x(t.name,e.name)}function Ht(t,e){return x(t,e)}var qt=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&xt(this.priorityNode_),this.children_.isEmpty()&&Object(o.d)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return B||(B=new t(new Pt(Ht),null,Vt.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||B},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?B:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(Object(o.d)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ct(e,n),i=void 0,s=void 0;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?B:this.priorityNode_;return new t(i,a,s)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;Object(o.d)(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(jt,function(s,a){n[s]=a.val(e),r++,o&&t.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1}),!e&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+St(this.getPriority().val())+":"),this.forEachChild(jt,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":y(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ct(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ct(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ct(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,Ct.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,Ct.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Bt?-1:0},t.prototype.withIndex=function(e){if(e===It||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===It||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(jt),r=e.getIterator(jt),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===It?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Bt=new(function(t){function e(){return t.call(this,new Pt(Ht),qt.EMPTY_NODE,Vt.Default)||this}return Object(i.c)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return qt.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(qt));function zt(t,e){if(void 0===e&&(e=null),null===t)return qt.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),Object(o.d)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Nt(t,zt(e));if(t instanceof Array){var n=qt.EMPTY_NODE;return D(t,function(e,r){if(Object(o.h)(t,e)&&"."!==e.substring(0,1)){var i=zt(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}}),n.updatePriority(zt(e))}var r=[],i=!1;if(D(t,function(t,e){if("."!==t.substring(0,1)){var n=zt(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Ct(t,n)))}}),0===r.length)return qt.EMPTY_NODE;var s=Lt(r,Ut,function(t){return t.name},Ht);if(i){var a=Lt(r,jt.getCompare());return new qt(s,zt(e),new Vt({".priority":a},{".priority":jt}))}return new qt(s,zt(e),Vt.Default)}Object.defineProperties(Ct,{MIN:{value:new Ct(I,qt.EMPTY_NODE)},MAX:{value:new Ct(S,Bt)}}),Tt.__EMPTY_NODE=qt.EMPTY_NODE,Nt.__childrenNodeConstructor=qt,M=Bt,H=Bt,U=zt;var Wt,Gt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?x(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ct.MIN},e.prototype.maxPost=function(){return Ct.MAX},e.prototype.makePost=function(t,e){var n=zt(t);return new Ct(e,n)},e.prototype.toString=function(){return".value"},e}(Ot)),Qt=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,Object(o.d)(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return Object(i.c)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?x(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=zt(t),r=qt.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ct(e,r)},e.prototype.maxPost=function(){var t=qt.EMPTY_NODE.updateChild(this.indexPath_,Bt);return new Ct(S,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(Ot),Kt=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return Object(o.G)("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return Object(o.G)("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return Object(o.G)("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return Object(o.G)("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){Object(o.G)("DataSnapshot.child",0,1,arguments.length),e=String(e),yt("DataSnapshot.child",1,e,!1);var n=new Y(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,jt)},t.prototype.hasChild=function(t){Object(o.G)("DataSnapshot.hasChild",1,1,arguments.length),yt("DataSnapshot.hasChild",1,t,!1);var e=new Y(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return Object(o.G)("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(Object(o.G)("DataSnapshot.forEach",1,1,arguments.length),Object(o.H)("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,function(r,i){return e(new t(i,n.ref_.child(r),jt))})},t.prototype.hasChildren=function(){return Object(o.G)("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return Object(o.G)("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return Object(o.G)("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Yt=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(o.F)(this.snapshot.exportVal())},t}(),Jt=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),$t=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Yt("value",this,new Kt(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Object(o.d)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Jt(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Xt=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,Object(o.h)(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Jt(this,t,e):null},t.prototype.createEvent=function(t,e){Object(o.d)(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Yt(t.type,this,new Kt(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Object(o.d)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var s=r[0],a=i[0];return!(a!==s||e.callbacks_[s]&&this.callbacks_[a]&&e.callbacks_[s]!==this.callbacks_[a])}return i.every(function(t){return e.callbacks_[t]===n.callbacks_[t]})}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),Zt=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Object(o.d)(Wt,"Reference.ts has not been loaded"),Wt},set:function(t){Wt=t},enumerable:!1,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===It){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==I)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==S)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===jt){if(null!=e&&!ut(e)||null!=n&&!ut(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(o.d)(t.getIndex()instanceof Qt||t.getIndex()===Gt,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return Object(o.G)("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){Object(o.G)("Query.on",2,4,arguments.length),dt("Query.on",1,e,!1),Object(o.H)("Query.on",2,n,!1);var s=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,s.cancel,s.context);else{var a={};a[e]=n,this.onChildEvent(a,s.cancel,s.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new $t(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new Xt(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){Object(o.G)("Query.off",0,3,arguments.length),dt("Query.off",1,t,!0),Object(o.H)("Query.off",2,e,!0),Object(o.I)("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var s=e||null;r=new $t(s,null,n||null)}else t&&(e&&((i={})[t]=e),r=new Xt(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.get=function(){return this.repo.getValue(this)},t.prototype.once=function(e,n,r,i){var s=this;Object(o.G)("Query.once",1,4,arguments.length),dt("Query.once",1,e,!1),Object(o.H)("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new o.a;c.promise.catch(function(){});var l=function(t){u&&(u=!1,s.off(e,l),n&&n.bind(a.context)(t),c.resolve(t))};return this.on(e,l,function(t){s.off(e,l),a.cancel&&a.cancel.bind(a.context)(t),c.reject(t)}),c.promise},t.prototype.limitToFirst=function(e){if(Object(o.G)("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(Object(o.G)("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(Object(o.G)("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');yt("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new Y(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Qt(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){Object(o.G)("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(It);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){Object(o.G)("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(jt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){Object(o.G)("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Gt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),Object(o.G)("Query.startAt",0,2,arguments.length),ct("Query.startAt",1,e,this.path,!0),pt("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),Object(o.G)("Query.endAt",0,2,arguments.length),ct("Query.endAt",1,e,this.path,!0),pt("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(Object(o.G)("Query.equalTo",1,2,arguments.length),ct("Query.equalTo",1,t,this.path,!1),pt("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return Object(o.G)("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return Object(o.G)("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=A(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(Object(o.G)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),s=this.queryIdentifier()===e.queryIdentifier();return r&&i&&s},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,Object(o.H)(t,3,r.cancel,!0),r.context=n,Object(o.I)(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(Object(o.l)(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),te=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),ee=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=this.path_.child(e);return new t(this.syncTree_,n)},t.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},t}(),ne=function(t,e,n){return t&&"object"==typeof t?(Object(o.d)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?re(t[".sv"],e,n):"object"==typeof t[".sv"]?ie(t[".sv"],e):void Object(o.d)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},re=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Object(o.d)(!1,"Unexpected server value: "+t)}},ie=function(t,e,n){t.hasOwnProperty("increment")||Object(o.d)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&Object(o.d)(!1,"Unexpected increment value: "+r);var i=e.node();if(Object(o.d)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var s=i.getValue();return"number"!=typeof s?r:s+r},oe=function(t,e,n,r){return ae(e,new ee(n,t),r)},se=function(t,e,n){return ae(t,new te(e),n)};function ae(t,e,n){var r,i=t.getPriority().val(),o=ne(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var s=t,a=ne(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new Nt(a,zt(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Nt(o))),u.forEachChild(jt,function(t,i){var o=ae(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))}),r}var ue,ce,le=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(jt,function(t,e){n.remember(new Y(t),e)}),this.forget(t)}if(this.children.size>0){var r=t.getFront();return t=t.popFront(),this.children.has(r)&&this.children.get(r).forget(t)&&this.children.delete(r),0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild(function(n,r){var i=new Y(t.toString()+"/"+n);r.forEachTree(i,e)})},t.prototype.forEachChild=function(t){this.children.forEach(function(e,n){t(n,e)})},t}(),he=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}({}),fe=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,Object(o.d)(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),de=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=he.ACK_USER_WRITE,this.source=fe.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Object(o.d)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new Y(e));return new t(Y.Empty,n,this.revert)}return Object(o.d)(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),pe=function(){function t(t,e){void 0===e&&(ue||(ue=new Pt(N)),e=ue),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return D(e,function(t,e){n=n.set(new Y(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:Y.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new Y(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||t.Empty).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(Y.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(t.child(r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,Y.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,Y.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(Y.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}(),ye=function(){function t(t,e){this.source=t,this.path=e,this.type=he.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Y.Empty):new t(this.source,this.path.popFront())},t}(),ve=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=he.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Y.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),ge=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=he.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new Y(e));return n.isEmpty()?null:n.value?new ve(this.source,Y.Empty,n.value):new t(this.source,Y.Empty,n)}return Object(o.d)(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),me=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),_e=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new me(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new me(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new me(qt.EMPTY_NODE,!1,!1),new me(qt.EMPTY_NODE,!1,!1)),t}(),be=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),we=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,s){Object(o.d)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(be.childRemovedChange(e,a)):Object(o.d)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(be.childAddedChange(e,n)):s.trackChildChange(be.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(jt,function(t,r){e.hasChild(t)||n.trackChildChange(be.childRemovedChange(t,r))}),e.isLeafNode()||e.forEachChild(jt,function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(be.childChangedChange(e,r,i))}else n.trackChildChange(be.childAddedChange(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?qt.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ee=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;Object(o.d)(e===be.CHILD_ADDED||e===be.CHILD_CHANGED||e===be.CHILD_REMOVED,"Only child changes supported for tracking"),Object(o.d)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e===be.CHILD_ADDED&&i===be.CHILD_REMOVED)this.changeMap.set(n,be.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e===be.CHILD_REMOVED&&i===be.CHILD_ADDED)this.changeMap.delete(n);else if(e===be.CHILD_REMOVED&&i===be.CHILD_CHANGED)this.changeMap.set(n,be.childRemovedChange(n,r.oldSnap));else if(e===be.CHILD_CHANGED&&i===be.CHILD_ADDED)this.changeMap.set(n,be.childAddedChange(n,t.snapshotNode));else{if(e!==be.CHILD_CHANGED||i!==be.CHILD_CHANGED)throw Object(o.e)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,be.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),Ce=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Oe=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new me(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),Te=function(){return function(t,e){this.viewCache=t,this.changes=e}}(),Ie=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){Object(o.d)(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Object(o.d)(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var s,a,u=new Ee;if(n.type===he.OVERWRITE){var c=n;c.source.fromUser?s=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):(Object(o.d)(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),s=this.applyServerOverwrite_(e,c.path,c.snap,r,i,a,u))}else if(n.type===he.MERGE){var l=n;l.source.fromUser?s=this.applyUserMerge_(e,l.path,l.children,r,i,u):(Object(o.d)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.getServerCache().isFiltered(),s=this.applyServerMerge_(e,l.path,l.children,r,i,a,u))}else if(n.type===he.ACK_USER_WRITE){var h=n;s=h.revert?this.revertUserWrite_(e,h.path,r,i,u):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==he.LISTEN_COMPLETE)throw Object(o.e)("Unknown operation type: "+n.type);s=this.listenComplete_(e,n.path,r,u)}var f=u.getChanges();return t.maybeAddValueEvent_(e,s,f),new Te(s,f)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(be.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var s=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,u=void 0;if(e.isEmpty())if(Object(o.d)(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),l=n.calcCompleteEventChildren(c instanceof qt?c:qt.EMPTY_NODE);a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var h=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var f=e.getFront();if(".priority"===f){Object(o.d)(1===e.getLength(),"Can't have a priority with additional path components");var d=s.getNode();u=t.getServerCache().getNode();var p=n.calcEventCacheAfterServerOverwrite(e,d,u);a=null!=p?this.filter_.updatePriority(d,p):s.getNode()}else{var y=e.popFront(),v=void 0;if(s.isCompleteForChild(f)){u=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,s.getNode(),u);v=null!=g?s.getNode().getImmediateChild(f).updateChild(y,g):s.getNode().getImmediateChild(f)}else v=n.calcCompleteChild(f,t.getServerCache());a=null!=v?this.filter_.updateChild(s.getNode(),f,v,y,r,i):s.getNode()}}return t.updateEventSnap(a,s.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,s){var a,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);a=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),d=u.getNode().getImmediateChild(h).updateChild(f,n);a=".priority"===h?c.updatePriority(u.getNode(),d):c.updateChild(u.getNode(),h,d,f,Ce,null)}var p=t.updateServerSnap(a,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),y=new Oe(r,p,i);return this.generateEventCacheAfterServerEvent_(p,e,r,y,s)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var s,a,u=t.getEventCache(),c=new Oe(r,t,i);if(e.isEmpty())a=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),s=t.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)a=this.filter_.updatePriority(t.getEventCache().getNode(),n),s=t.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),f=u.getNode().getImmediateChild(l),d=void 0;if(h.isEmpty())d=n;else{var p=c.getCompleteChild(l);d=null!=p?".priority"===h.getBack()&&p.getChild(h.parent()).isEmpty()?p:p.updateChild(h,n):qt.EMPTY_NODE}if(f.equals(d))s=t;else{var y=this.filter_.updateChild(u.getNode(),l,d,h,c,o);s=t.updateEventSnap(y,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,s){var a=this,u=e;return r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=a.applyUserOverwrite_(u,l,c,i,o,s))}),r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=a.applyUserOverwrite_(u,l,c,i,o,s))}),u},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,s){var a=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:pe.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal(function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=a.applyMerge_(u,n);c=a.applyServerOverwrite_(c,new Y(e),h,r,i,o,s)}}),u.children.inorderTraversal(function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),f=a.applyMerge_(h,n);c=a.applyServerOverwrite_(c,new Y(e),f,r,i,o,s)}}),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var s=t.getServerCache().isFiltered(),a=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,a.getNode().getChild(e),r,i,s,o);if(e.isEmpty()){var u=pe.Empty;return a.getNode().forEachChild(It,function(t,e){u=u.set(new Y(t),e)}),this.applyServerMerge_(t,e,u,r,i,s,o)}return t}var c=pe.Empty;return n.foreach(function(t,n){var r=e.child(t);a.isCompleteForPath(r)&&(c=c.set(t,a.getNode().getChild(r)))}),this.applyServerMerge_(t,e,c,r,i,s,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,Ce,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var s;if(null!=n.shadowingWrite(e))return t;var a=new Oe(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var l=void 0;if(t.getServerCache().isFullyInitialized())l=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();Object(o.d)(h instanceof qt,"serverChildren would be complete if leaf node"),l=n.calcCompleteEventChildren(h)}c=this.filter_.updateFullNode(u,l=l,i)}else{var f=e.getFront(),d=n.calcCompleteChild(f,t.getServerCache());null==d&&t.getServerCache().isCompleteForChild(f)&&(d=u.getImmediateChild(f)),(c=null!=d?this.filter_.updateChild(u,f,d,e.popFront(),a,i):t.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,qt.EMPTY_NODE,e.popFront(),a,i):u).isEmpty()&&t.getServerCache().isFullyInitialized()&&(s=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(c=this.filter_.updateFullNode(c,s,i))}return s=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(Y.Empty),t.updateEventSnap(c,s,this.filter_.filtersNodes())},t}(),Se=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach(function(t){t.type===be.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(be.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(i,be.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,be.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,be.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,be.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,be.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,s=n.filter(function(t){return t.type===e});s.sort(this.compareChanges_.bind(this)),s.forEach(function(e){var n=o.materializeSingleChange_(e,i);r.forEach(function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_)),t},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw Object(o.e)("Should only compare child_ events.");var n=new Ct(t.childName,t.snapshotNode),r=new Ct(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),xe=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new we(n.getIndex()),i=n.getNodeFilter();this.processor_=new Ie(i);var o=e.getServerCache(),s=e.getEventCache(),a=r.updateFullNode(qt.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(qt.EMPTY_NODE,s.getNode(),null),c=new me(a,o.isFullyInitialized(),r.filtersNodes()),l=new me(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new _e(l,c),this.eventGenerator_=new Se(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){Object(o.d)(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(t){var i=t.createCancelEvent(e=e,r);i&&n.push(i)})}if(t){for(var i=[],s=0;s<this.eventRegistrations_.length;++s){var a=this.eventRegistrations_[s];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(s+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===he.MERGE&&null!==t.source.queryId&&(Object(o.d)(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Object(o.d)(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),Object(o.d)(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(jt,function(t,e){n.push(be.childAddedChange(t,e))}),e.isFullyInitialized()&&n.push(be.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){return this.eventGenerator_.generateEventsForChanges(t,e,n?[n]:this.eventRegistrations_)},t}(),Ne=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Object(o.d)(ce,"Reference.ts has not been loaded"),ce},set:function(t){Object(o.d)(!ce,"__referenceConstructor has already been defined"),ce=t},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,s,a=t.source.queryId;if(null!==a){var u=this.views.get(a);return Object(o.d)(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(t,e,n)}var c=[];try{for(var l=Object(i.h)(this.views.values()),h=l.next();!h.done;h=l.next())c=c.concat((u=h.value).applyOperation(t,e,n))}catch(f){r={error:f}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(r)throw r.error}}return c},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),s=this.views.get(o);if(!s){var a=n.calcCompleteEventCache(i?r:null),u=!1;a?u=!0:r instanceof qt?(a=n.calcCompleteEventChildren(r),u=!1):(a=qt.EMPTY_NODE,u=!1);var c=new _e(new me(a,u,!1),new me(r,i,!1));s=new xe(t,c),this.views.set(o,s)}return s.addEventRegistration(e),s.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var o,s,a=e.queryIdentifier(),u=[],c=[],l=this.hasCompleteView();if("default"===a)try{for(var h=Object(i.h)(this.views.entries()),f=h.next();!f.done;f=h.next()){var d,p=Object(i.e)(f.value,2),y=p[0];c=c.concat((d=p[1]).removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(y),d.getQuery().getQueryParams().loadsAllData()||u.push(d.getQuery()))}}catch(v){o={error:v}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}else(d=this.views.get(a))&&(c=c.concat(d.removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(a),d.getQuery().getQueryParams().loadsAllData()||u.push(d.getQuery())));return l&&!this.hasCompleteView()&&u.push(new t.__referenceConstructor(e.repo,e.path)),{removed:u,events:c}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=Object(i.h)(this.views.values()),o=r.next();!o.done;o=r.next()){var s=o.value;s.getQuery().getQueryParams().loadsAllData()||n.push(s)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var o=Object(i.h)(this.views.values()),s=o.next();!s.done;s=o.next())r=r||s.value.getCompleteServerCache(t)}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=Object(i.h)(this.views.values()),r=n.next();!r.done;r=n.next()){var o=r.value;if(o.getQuery().getQueryParams().loadsAllData())return o}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),je=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new pe(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,s=Y.relativePath(i,e);return o=o.updateChild(s,n),new t(this.writeTree_.set(i,o))}var a=new pe(n);return new t(this.writeTree_.setTree(e,a))},t.prototype.addWrites=function(t,e){var n=this;return D(e,function(e,r){n=n.addWrite(t.child(e),r)}),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,pe.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(Y.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(jt,function(e,n){t.push(new Ct(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new Ct(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new pe(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return Ae(Y.Empty,this.writeTree_,t)},t.Empty=new t(new pe(null)),t}();function Ae(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal(function(e,i){".priority"===e?(Object(o.d)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ae(t.child(e),i,n)}),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(t.child(".priority"),r)),n}var ke=function(){function t(){this.visibleWrites_=je.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new De(t,this)},t.prototype.addOverwrite=function(t,e,n,r){Object(o.d)(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){Object(o.d)(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});Object(o.d)(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,s=!1,a=this.allWrites_.length-1;i&&a>=0;){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(s=!0)),a--}return!!i&&(s?(this.resetTree_(),!0):(r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):D(r.children,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))}),!0))},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);return!i&&o.isEmpty()?n:i||null!=n||o.hasCompleteWrite(Y.Empty)?t.layerTree_(this.allWrites_,function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},e).apply(n||qt.EMPTY_NODE):null}var s=this.visibleWrites_.getCompleteNode(e);if(null!=s)return s;var a=this.visibleWrites_.childCompoundWrite(e);return a.isEmpty()?n:null!=n||a.hasCompleteWrite(Y.Empty)?a.apply(n||qt.EMPTY_NODE):null},t.prototype.calcCompleteEventChildren=function(t,e){var n=qt.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(jt,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(jt,function(t,e){var r=i.childCompoundWrite(new Y(t)).apply(e);n=n.updateImmediateChild(t,r)}),i.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){Object(o.d)(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var s=this.visibleWrites_.childCompoundWrite(i);return s.isEmpty()?r.getChild(e):s.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var s,a=this.visibleWrites_.childCompoundWrite(t),u=a.getCompleteNode(Y.Empty);if(null!=u)s=u;else{if(null==e)return[];s=a.apply(e)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),f=h.getNext();f&&c.length<r;)0!==l(f,n)&&c.push(f),f=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,Y.Empty),this.lastWriteId_=this.allWrites_.length>0?this.allWrites_[this.allWrites_.length-1].writeId:-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=je.Empty,i=0;i<t.length;++i){var s=t[i];if(e(s)){var a=s.path,u=void 0;if(s.snap)n.contains(a)?(u=Y.relativePath(n,a),r=r.addWrite(u,s.snap)):a.contains(n)&&(u=Y.relativePath(a,n),r=r.addWrite(Y.Empty,s.snap.getChild(u)));else{if(!s.children)throw Object(o.e)("WriteRecord should have .snap or .children");if(n.contains(a))u=Y.relativePath(n,a),r=r.addWrites(u,s.children);else if(a.contains(n))if((u=Y.relativePath(a,n)).isEmpty())r=r.addWrites(Y.Empty,s.children);else{var c=Object(o.C)(s.children,u.getFront());if(c){var l=c.getChild(u.popFront());r=r.addWrite(Y.Empty,l)}}}}}return r},t}(),De=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Pe=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=pe.Empty,this.pendingWriteTree_=new ke,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new ve(fe.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=pe.fromObject(e);return this.applyOperationToSyncPoints_(new ge(fe.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=pe.Empty;return null!=n.snap?r=r.set(Y.Empty,!0):D(n.children,function(t,e){r=r.set(new Y(t),e)}),this.applyOperationToSyncPoints_(new de(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new ve(fe.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=pe.fromObject(e);return this.applyOperationToSyncPoints_(new ge(fe.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new ye(fe.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=Y.relativePath(s,e),c=new ve(fe.forServerTaggedQuery(a),u,n);return this.applyTaggedOperation_(s,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=Y.relativePath(s,e),c=pe.fromObject(n),l=new ge(fe.forServerTaggedQuery(a),u,c);return this.applyTaggedOperation_(s,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,s=i.queryId,a=Y.relativePath(o,e),u=new ye(fe.forServerTaggedQuery(s),a);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,s=!1;this.syncPointTree_.foreachOnPath(r,function(t,e){var n=Y.relativePath(t,r);i=i||e.getCompleteServerCache(n),s=s||e.hasCompleteView()});var a,u=this.syncPointTree_.get(r);u?(s=s||u.hasCompleteView(),i=i||u.getCompleteServerCache(Y.Empty)):(u=new Ne,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i?a=!0:(a=!1,i=qt.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild(function(t,e){var n=e.getCompleteServerCache(Y.Empty);n&&(i=i.updateImmediateChild(t,n))}));var c=u.viewExistsForQuery(e);if(!c&&!e.getQueryParams().loadsAllData()){var l=t.makeQueryKey_(e);Object(o.d)(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=t.getNextQueryTag_();this.queryToTagMap.set(l,h),this.tagToQueryMap.set(h,l)}var f=this.pendingWriteTree_.childWrites(r),d=u.addEventRegistration(e,n,f,i,a);if(!c&&!s){var p=u.viewForQuery(e);d=d.concat(this.setupListener_(e,p))}return d},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,s=this.syncPointTree_.get(o),a=[];if(s&&("default"===e.queryIdentifier()||s.viewExistsForQuery(e))){var u=s.removeEventRegistration(e,n,r);s.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;a=u.events;var l=-1!==c.findIndex(function(t){return t.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(t,e){return e.hasCompleteView()});if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var d=this.collectDistinctViewsForSubTree_(f),p=0;p<d.length;++p){var y=d[p],v=y.getQuery(),g=this.createListenerForView_(y);this.listenProvider_.startListening(t.queryForListening_(v),this.tagForQuery_(v),g.hashFn,g.onComplete)}}!h&&c.length>0&&!r&&(l?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach(function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)})),this.removeTags_(c)}return a},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,function(e,n){var r=Y.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),D(n,function(t,e){r=r.concat(e)}),r})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),s=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,s.hashFn,s.onComplete),u=this.syncPointTree_.subtree(r);if(i)Object(o.d)(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),D(n,function(t,e){r=r.concat(e)}),r}),l=0;l<c.length;++l){var h=c[l];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||qt.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return Object(o.d)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Y(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);Object(o.d)(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Y.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(Y.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(Y.Empty));var o=[],s=t.path.getFront(),a=t.operationForChild(s),u=e.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,l=r.child(s);o=o.concat(this.applyOperationHelper_(a,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(Y.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(Y.Empty));var s=[];return e.children.inorderTraversal(function(e,o){var a=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(s=s.concat(i.applyOperationDescendantsHelper_(c,o,a,u)))}),o&&(s=s.concat(o.applyOperation(t,r,n))),s},t.nextQueryTag_=1,t}(),Re=function(){function t(){this.rootNode_=qt.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Fe=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),Object(o.h)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return Object(o.j)(this.counters_)},t}(),Le=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Fe),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),Me=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=Object(i.a)({},t);return this.last_&&D(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}(),Ve=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Me(t);var n=1e4+2e4*Math.random();K(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;D(e,function(e,i){i>0&&Object(o.h)(t.statsToReport_,e)&&(n[e]=i,r=!0)}),r&&this.server_.reportStats(n),K(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Ue=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new He(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),He=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();g&&b("event: "+e.toString()),Q(n)}}},t.prototype.getPath=function(){return this.path_},t}(),qe=function(){function t(t){this.allowedEvents_=t,this.listeners_={},Object(o.d)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=Object(i.f)(this.listeners_[t]),o=0;o<r.length;o++)r[o].callback.apply(r[o].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){Object(o.d)(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}(),Be=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return Object(i.c)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(o.d)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(qe),ze=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(o.t)()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return Object(i.c)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(o.d)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(qe),We=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&Q(function(){n.onMessage_(t[e])})},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),Ge="start",Qe="close",Ke=function(){function t(t,e,n,r,i){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=w(t),this.stats_=Le.getCollection(e),this.urlFn=function(t){return e.connectionURL(Z,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new We(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if(Object(o.v)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new Ye(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(i.e)(t,5),o=r[0],s=r[1],a=r[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,o===Ge)n.id=s,n.password=a;else{if(o!==Qe)throw new Error("Unrecognized command received: "+o);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(i.e)(t,2),o=r[0],s=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(o,s)},function(){n.onClosed_()},n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf($)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(Object(o.v)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=Object(o.F)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=Object(o.g)(e),r=k(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!Object(o.v)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=Object(o.F)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Ye=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(o.v)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=p(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(s='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(u){b("frame writing exception"),u.stack&&b(u.stack),b(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||b("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return this.addLongPollTag_(e+=n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},t.prototype.addTag=function(t,e){var n=this;Object(o.v)()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){b("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))},t}(),Je="";function $e(t){Je=t}var Xe=null;"undefined"!=typeof MozWebSocket?Xe=MozWebSocket:"undefined"!=typeof WebSocket&&(Xe=WebSocket);var Ze=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=w(this.connId),this.stats_=Le.getCollection(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!Object(o.v)()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf($)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL(X,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,h.set("previous_websocket_failure",!0);try{if(Object(o.v)()){var r={headers:{"User-Agent":"Firebase/5/"+Je+"/"+process.platform+"/"+(this.nodeAdmin?"AdminNode":"Node"),"X-Firebase-GMPID":this.applicationId||""}},i=process.env,s=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;s&&(r.proxy={origin:s}),this.mySock=new Xe(this.connURL,[],r)}else this.mySock=new Xe(this.connURL,[],r={headers:{"X-Firebase-GMPID":this.applicationId||""}})}catch(u){this.log_("Error instantiating WebSocket.");var a=u.message||u.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Xe&&!t.forceDisallow_},t.previouslyFailed=function(){return h.isInMemoryStorage||!0===h.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){h.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=Object(o.z)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(Object(o.d)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=Object(o.F)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=k(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),tn=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Ke,Ze]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,o=Ze&&Ze.isAvailable(),s=o&&!Ze.previouslyFailed();if(e.webSocketOnly&&(o||O("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Ze];else{var a=this.transports_=[];try{for(var u=Object(i.h)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&a.push(l)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),en=function(){function t(t,e,n,r,i,o,s,a){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=w("c:"+this.id+":"),this.transportManager_=new tn(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=K(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){this.sendData_({t:"d",d:t})},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=j("t",t),n=j("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=j("t",t),n=j("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=j("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?E("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&O("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),K(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):K(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(h.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),nn=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),rn=1e3,on=function(t){function e(n,r,i,s,a,u,c){var l=t.call(this)||this;if(l.repoInfo_=n,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=s,l.onServerInfoUpdate_=a,l.authTokenProvider_=u,l.authOverride_=c,l.id=e.nextPersistentConnectionId_++,l.log_=w("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=rn,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!Object(o.v)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),Be.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&ze.getInstance().on("online",l.onOnline_,l),l}return Object(i.c)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(Object(o.F)(i)),Object(o.d)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this,n=new o.a,r={p:t.path.toString(),q:t.queryObject()},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var s=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var t=e.outstandingGets_[s];void 0!==t&&i===t&&(delete e.outstandingGets_[s],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+s+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(s),n.promise},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),s=t.path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Object(o.d)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Object(o.d)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(s).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var s={p:i};t.tag&&(s.q=r.queryObject(),s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,function(s){var a=s.d,u=s.s;e.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",s),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,a))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&Object(o.h)(t,"w")){var n=Object(o.C)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();O("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||Object(o.n)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=Object(o.y)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),Object(o.d)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){"ok"!==t.s&&e.log_("reportStats","Error sending stats: "+t.d)})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+Object(o.F)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):E("Unrecognized action received from server: "+Object(o.F)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;Object(o.d)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=rn,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=rn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=rn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+e.nextConnectionId_++,a=this,u=this.lastSessionId,c=!1,l=null,h=function(){l?l.close():(c=!0,i())};this.realtime_={close:h,sendRequest:function(t){Object(o.d)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(t)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then(function(t){c?b("getToken() completed but was canceled"):(b("getToken() completed. Creating connection."),a.authToken_=t&&t.accessToken,l=new en(s,a.repoInfo_,a.applicationId_,n,r,i,function(t){O(t+" ("+a.repoInfo_.toString()+")"),a.interrupt("server_kill")},u))}).then(null,function(e){a.log_("Failed to get token: "+e),c||(t.repoInfo_.nodeAdmin&&O(e),h())})}},e.prototype.interrupt=function(t){b("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){b("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Object(o.r)(this.interruptReasons_)&&(this.reconnectDelay_=rn,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return A(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new Y(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){b("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var o=Object(i.h)(this.listens.values()),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,Object(i.h)(a.values())),c=u.next();!c.done;c=u.next())this.sendListen_(c.value)}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(d){t={error:d}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},e.prototype.sendConnectStats_=function(){var t={},e="js";Object(o.v)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+Je.replace(/\./g,"-")]=1,Object(o.t)()?t["framework.cordova"]=1:Object(o.w)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=ze.getInstance().currentlyOnline();return Object(o.r)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(nn),sn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=w("p:rest:"),i.listens_={},i}return Object(i.c)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(Object(o.d)(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var s=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",l,function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&s.onDataUpdate_(a,n,!1,r),Object(o.C)(s.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=t.getQueryParams().toRestQueryStringParameters(),r=t.path.toString(),i=new o.a;return this.restRequest_(r+".json",n,function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var s=i&&i.accessToken;s&&(e.auth=s);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+Object(o.B)(e);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=Object(o.z)(u.responseText)}catch(e){O("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&O("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()})},e}(nn),an="repo_interrupt",un=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new le,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.start=function(){var t=this;if(this.stats_=Le.getCollection(this.repoInfo_),this.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new sn(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var e=this.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(o.F)(e)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}this.persistentConnection_=new on(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,e),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener(function(e){t.server_.refreshAuthToken(e)}),this.statsReporter_=Le.getOrCreateReporter(this.repoInfo_,function(){return new Ve(t.stats_,t.server_)}),this.transactionsInit_(),this.infoData_=new Re,this.infoSyncTree_=new Pe({startListening:function(e,n,r,i){var o=[],s=t.infoData_.getNode(e.path);return s.isEmpty()||(o=t.infoSyncTree_.applyServerOverwrite(e.path,s),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Pe({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,function(n,r){var o=i(n,r);t.eventQueue_.raiseEventsForChangedPath(e.path,o)}),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})},t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new Y(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new Y(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var s=[];if(r)if(n){var a=Object(o.A)(e,function(t){return zt(t)});s=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=zt(e);s=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=Object(o.A)(e,function(t){return zt(t)});s=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=zt(e);s=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;s.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,s)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;D(t,function(t,n){e.updateInfo_(t,n)})},t.prototype.updateInfo_=function(t,e){var n=new Y("/.info/"+t),r=zt(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.getValue=function(t){var e=this;return this.server_.get(t).then(function(n){var r=zt(n),i=e.serverSyncTree_.applyServerOverwrite(t.path,r);return e.eventQueue_.raiseEventsAtPath(t.path,i),Promise.resolve(new Kt(r,t.getRef(),t.getQueryParams().getIndex()))},function(n){e.log_("get for query "+Object(o.F)(t)+" falling back to cache after error: "+n);var r=e.serverSyncTree_.calcCompleteEventCache(t.path);return r.isEmpty()?Promise.reject(new Error(n)):Promise.resolve(new Kt(r,t.getRef(),t.getQueryParams().getIndex()))})},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),s=zt(e,n),a=this.serverSyncTree_.calcCompleteEventCache(t),u=se(s,a,o),c=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(t,u,c,!0);this.eventQueue_.queueEvents(l),this.server_.put(t.toString(),s.val(!0),function(e,n){var o="ok"===e;o||O("set at "+t+" failed: "+e);var s=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,s),i.callOnCompleteCallback(r,e,n)});var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),s={};if(D(e,function(e,n){i=!1,s[e]=oe(t.child(e),zt(n),r.serverSyncTree_,o)}),i)b("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var a=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,s,a);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,function(e,i){var o="ok"===e;o||O("update at "+t+" failed: "+e);var s=r.serverSyncTree_.ackUserWrite(a,!o),u=s.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,s),r.callOnCompleteCallback(n,e,i)}),D(e,function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=new le;this.onDisconnect_.forEachTree(Y.Empty,function(r,i){var o=oe(r,i,t.serverSyncTree_,e);n.remember(r,o)});var r=[];n.forEachTree(Y.Empty,function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)}),this.onDisconnect_=new le,this.eventQueue_.raiseEventsForChangedPath(Y.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)})},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=zt(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=zt(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(Object(o.r)(e))return b("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(i,o){"ok"===i&&D(e,function(e,n){var i=zt(n);r.onDisconnect_.remember(t.child(e),i)}),r.callOnCompleteCallback(n,i,o)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(an)},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(an)},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new Me(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);D(e,function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),b.apply(void 0,Object(i.f)([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&Q(function(){if("ok"===e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new bn(this))},enumerable:!1,configurable:!0}),t}(),cn=function(){function t(e){this.indexedFilter_=new we(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ct(e,n))||(n=qt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=qt.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(qt.EMPTY_NODE);var i=this;return e.forEachChild(jt,function(t,e){i.matches(new Ct(t,e))||(r=r.updateImmediateChild(t,qt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),ln=function(){function t(t){this.rangedFilter_=new cn(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ct(e,n))||(n=qt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=qt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=qt.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(qt.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)s=i.getNext(),!h&&c(a,s)<=0&&(h=!0),h&&o<this.limit_&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,qt.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var s;if(this.reverse_){var a=this.index_.getCompare();s=function(t,e){return a(e,t)}}else s=this.index_.getCompare();var u=t;Object(o.d)(u.numChildren()===this.limit_,"");var c=new Ct(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,l,this.reverse_);null!=d&&(d.name===e||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:s(d,c);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(be.childChangedChange(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(be.childRemovedChange(e,f));var y=u.updateImmediateChild(e,qt.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(be.childAddedChange(d.name,d.node)),y.updateImmediateChild(d.name,d.node)):y}return n.isEmpty()?t:h&&s(l,c)>=0?(null!=i&&(i.trackChildChange(be.childRemovedChange(l.name,l.node)),i.trackChildChange(be.childAddedChange(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,qt.EMPTY_NODE)):t},t}(),hn=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=jt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return Object(o.d)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return Object(o.d)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:I},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return Object(o.d)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return Object(o.d)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:S},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return Object(o.d)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==jt&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===jt},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new we(this.getIndex()):this.hasLimit()?new ln(this):new cn(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()||(this.index_===jt?e=n.PRIORITY_INDEX:this.index_===Gt?e=n.VALUE_INDEX:this.index_===It?e=n.KEY_INDEX:(Object(o.d)(this.index_ instanceof Qt,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=Object(o.F)(e),this.startSet_&&(r[n.START_AT]=Object(o.F)(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+Object(o.F)(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=Object(o.F)(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+Object(o.F)(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_)),r},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),fn=function(t){function e(e,n){if(!(e instanceof un))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,hn.DEFAULT,!1)||this}return Object(i.c)(e,t),e.prototype.getKey=function(){return Object(o.G)("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return Object(o.G)("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof Y||(null===this.path.getFront()?vt("Reference.child",1,t,!1):yt("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){Object(o.G)("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){Object(o.G)("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){Object(o.G)("Reference.set",1,2,arguments.length),gt("Reference.set",this.path),ct("Reference.set",1,t,this.path,!1),Object(o.H)("Reference.set",2,e,!0);var n=new o.a;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(Object(o.G)("Reference.update",1,2,arguments.length),gt("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,O("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ht("Reference.update",1,t,this.path,!1),Object(o.H)("Reference.update",2,e,!0);var i=new o.a;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(Object(o.G)("Reference.setWithPriority",2,3,arguments.length),gt("Reference.setWithPriority",this.path),ct("Reference.setWithPriority",1,t,this.path,!1),ft("Reference.setWithPriority",2,e,!1),Object(o.H)("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new o.a;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return Object(o.G)("Reference.remove",0,1,arguments.length),gt("Reference.remove",this.path),Object(o.H)("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(Object(o.G)("Reference.transaction",1,3,arguments.length),gt("Reference.transaction",this.path),Object(o.H)("Reference.transaction",1,t,!1),Object(o.H)("Reference.transaction",2,e,!0),_t("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new o.a;"function"==typeof e&&r.promise.catch(function(){});var i=function(t,n,i){t?r.reject(t):r.resolve(new wt(n,i)),"function"==typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){Object(o.G)("Reference.setPriority",1,2,arguments.length),gt("Reference.setPriority",this.path),ft("Reference.setPriority",1,t,!1),Object(o.H)("Reference.setPriority",2,e,!0);var n=new o.a;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){Object(o.G)("Reference.push",0,2,arguments.length),gt("Reference.push",this.path),ct("Reference.push",1,t,this.path,!0),Object(o.H)("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=Et(r),s=this.child(i),a=this.child(i);return n=null!=t?s.set(t,e).then(function(){return a}):Promise.resolve(a),s.then=n.then.bind(n),s.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),s},e.prototype.onDisconnect=function(){return gt("Reference.onDisconnect",this.path),new bt(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Zt);Zt.__referenceConstructor=fn,Ne.__referenceConstructor=fn;var dn=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),pn=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new dn),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n=e instanceof Y?e:new Y(e),r=this,i=n.getFront();null!==i;)r=new t(i,r,Object(o.C)(r.node_.children,i)||new dn),i=(n=n.popFront()).getFront();return r},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){Object(o.d)(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;D(this.node_.children,function(r,i){e(new t(r,n,i))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new Y(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=Object(o.h)(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}(),yn=function(t){return t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT",t}({});un.MAX_TRANSACTION_RETRIES_=25,un.prototype.transactionsInit_=function(){this.transactionQueueTree_=new pn},un.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},s=new fn(this,t);s.on("value",i);var a={path:t,update:e,onComplete:n,status:null,order:p(),applyLocally:r,retryCount:0,unwatcher:function(){s.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(t);a.currentInputSnapshot=u;var c=a.update(u.val());if(void 0===c){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new Kt(a.currentInputSnapshot,new fn(this,a.path),jt);a.onComplete(null,!1,l)}}else{lt("transaction failed: Data returned ",c,a.path),a.status=yn.RUN;var h=this.transactionQueueTree_.subTree(t),f=h.getValue()||[];f.push(a),h.setValue(f);var d=void 0;"object"==typeof c&&null!==c&&Object(o.h)(c,".priority")?(d=Object(o.C)(c,".priority"),Object(o.d)(ut(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(this.serverSyncTree_.calcCompleteEventCache(t)||qt.EMPTY_NODE).getPriority().val(),d=d;var y=this.generateServerValues(),v=zt(c,d),g=se(v,u,y);a.currentOutputSnapshotRaw=v,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(t,g,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,m),this.sendReadyTransactions_()}},un.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||qt.EMPTY_NODE},un.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);Object(o.d)(n.length>0,"Sending zero length transaction queue"),n.every(function(t){return t.status===yn.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},un.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map(function(t){return t.currentWriteId}),i=this.getLatestState_(t,r),s=i,a=i.hash(),u=0;u<e.length;u++){var c=e[u];Object(o.d)(c.status===yn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=yn.SENT,c.retryCount++;var l=Y.relativePath(t,c.path);s=s.updateChild(l,c.currentOutputSnapshotRaw)}var h=s.val(!0),f=t;this.server_.put(f.toString(),h,function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=0;s<e.length;s++){if(e[s].status=yn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[s].currentWriteId)),e[s].onComplete){var a=e[s].currentOutputSnapshotResolved,u=new fn(n,e[s].path),c=new Kt(a,u,jt);o.push(e[s].onComplete.bind(null,null,!0,c))}e[s].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i),s=0;s<o.length;s++)Q(o[s])}else{if("datastale"===r)for(s=0;s<e.length;s++)e[s].status=e[s].status===yn.SENT_NEEDS_ABORT?yn.NEEDS_ABORT:yn.RUN;else for(O("transaction at "+f.toString()+" failed: "+r),s=0;s<e.length;s++)e[s].status=yn.NEEDS_ABORT,e[s].abortReason=r;n.rerunTransactions_(t)}},a)},un.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},un.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],r=[],i=t.filter(function(t){return t.status===yn.RUN}).map(function(t){return t.currentWriteId}),s=0;s<t.length;s++){var a=t[s],u=Y.relativePath(e,a.path),c=!1,l=void 0;if(Object(o.d)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===yn.NEEDS_ABORT)c=!0,l=a.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===yn.RUN)if(a.retryCount>=un.MAX_TRANSACTION_RETRIES_)c=!0,l="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var h=this.getLatestState_(a.path,i);a.currentInputSnapshot=h;var f=t[s].update(h.val());if(void 0!==f){lt("transaction failed: Data returned ",f,a.path);var d=zt(f);"object"==typeof f&&null!=f&&Object(o.h)(f,".priority")||(d=d.updatePriority(h.getPriority()));var p=a.currentWriteId,y=this.generateServerValues(),v=se(d,h,y);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=v,a.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(p),1),r=(r=r.concat(this.serverSyncTree_.applyUserOverwrite(a.path,v,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(p,!0))}else c=!0,l="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,r),r=[],c&&(t[s].status=yn.COMPLETED,setTimeout(t[s].unwatcher,Math.floor(0)),t[s].onComplete))if("nodata"===l){var g=new fn(this,t[s].path),m=new Kt(t[s].currentInputSnapshot,g,jt);n.push(t[s].onComplete.bind(null,null,!1,m))}else n.push(t[s].onComplete.bind(null,new Error(l),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),s=0;s<n.length;s++)Q(n[s]);this.sendReadyTransactions_()}},un.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;for(e=t.getFront();null!==e&&null===n.getValue();)n=n.subTree(e),e=(t=t.popFront()).getFront();return n},un.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},un.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},un.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==yn.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},un.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},un.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,s=0;s<e.length;s++)e[s].status===yn.SENT_NEEDS_ABORT||(e[s].status===yn.SENT?(Object(o.d)(i===s-1,"All SENT items should be at beginning of queue."),i=s,e[s].status=yn.SENT_NEEDS_ABORT,e[s].abortReason="set"):(Object(o.d)(e[s].status===yn.RUN,"Unexpected transaction status in abort"),e[s].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[s].currentWriteId,!0)),e[s].onComplete&&n.push(e[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r),s=0;s<n.length;s++)Q(n[s])}};var vn,gn=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then(function(t){return n.auth_=t})}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch(function(t){return t&&"auth/token-not-initialized"===t.code?(b("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)}):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout(function(){return t(null)},0),this.authProvider_.get().then(function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then(function(e){return e.removeAuthTokenListener(t)})},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';O(t+="credential"in this.app_.options?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},t}(),mn=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),_n=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return vn||(vn=new t),vn},t.prototype.interrupt=function(){var t,e,n,r;try{for(var o=Object(i.h)(Object.keys(this.repos_)),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,Object(i.h)(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next())this.repos_[a][c.value].interrupt()}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.resume=function(){var t,e,n,r;try{for(var o=Object(i.h)(Object.keys(this.repos_)),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,Object(i.h)(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next())this.repos_[a][c.value].resume()}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.applyEmulatorSettings=function(t,e,n){t.repoInfo_=new tt(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),t.repoInfo_.nodeAdmin&&(t.authTokenProvider_=new mn)},t.prototype.databaseFromApp=function(t,e,n,r){var i=n||t.options.databaseURL;void 0===i&&(t.options.projectId||C("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),b("Using default host for project ",t.options.projectId),i=t.options.projectId+"-default-rtdb.firebaseio.com");var o,s=et(i,r),a=s.repoInfo,u=void 0;"undefined"!=typeof process&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(o=!0,a=(s=et(i="http://"+u+"?ns="+a.namespace,r)).repoInfo):o=!s.repoInfo.secure;var c=r&&o?new mn:new gn(t,e);return mt("Invalid Firebase Database URL",1,s),s.path.isEmpty()||C("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(a,t,c).database},t.prototype.deleteRepo=function(t){var e=Object(o.C)(this.repos_,t.app.name);e&&Object(o.C)(e,t.key)===t||C("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.key]},t.prototype.createRepo=function(t,e,n){var r=Object(o.C)(this.repos_,e.name);r||(this.repos_[e.name]=r={});var i=Object(o.C)(r,t.toURLString());return i&&C("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new un(t,this.useRestClient_,e,n),r[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),bn=function(){function t(t){var e=this;this.repoInternal_=t,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return Object(i.b)(e,void 0,void 0,function(){return Object(i.d)(this,function(t){return this.checkDeleted_("delete"),_n.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]})})}},t instanceof un||C("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(t.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new fn(this.repo_,Y.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),t.prototype.useEmulator=function(t,e){this.checkDeleted_("useEmulator"),this.instanceStarted_?C("Cannot call useEmulator() after instance has already been initialized."):_n.getInstance().applyEmulatorSettings(this.repoInternal_,t,e)},t.prototype.ref=function(t){return this.checkDeleted_("ref"),Object(o.G)("database.ref",0,1,arguments.length),t instanceof fn?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),Object(o.G)(e,1,1,arguments.length);var n=et(t,this.repo_.repoInfo_.nodeAdmin);mt(e,1,n);var r=n.repoInfo;return r.isCustomHost()||r.host===this.repo_.repoInfo_.host||C(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repoInternal_&&C("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){Object(o.G)("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){Object(o.G)("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(t){return{".sv":{increment:t}}}},t}(),wn=Object.freeze({__proto__:null,forceLongPolling:function(){Ze.forceDisallow(),Ke.forceAllow()},forceWebSockets:function(){Ke.forceDisallow()},isWebSocketsAvailable:function(){return Ze.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.customAuthImpl,i=t.namespace,o=t.nodeAdmin,s=void 0!==o&&o;$e(t.version);var u=new a.c("auth-internal",new a.b("database-standalone"));return u.setComponent(new a.a("auth-internal",function(){return r},"PRIVATE")),{instance:_n.getInstance().databaseFromApp(e,u,n,s),namespace:i}}}),En=on;on.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},on.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Cn=Object.freeze({__proto__:null,DataConnection:En,RealTimeConnection:en,hijackHash:function(t){var e=on.prototype.put;return on.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){on.prototype.put=e}},ConnectionTarget:tt,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){_n.getInstance().forceRestClient(t)}}),On=bn.ServerValue;!function(e){$e(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new a.a("database",function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return _n.getInstance().databaseFromApp(n,r,e)},"PUBLIC").setServiceProps({Reference:fn,Query:Zt,Database:bn,DataSnapshot:Kt,enableLogging:_,INTERNAL:wn,ServerValue:On,TEST_ACCESS:Cn}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.8.1"),Object(o.v)()&&(t.exports=n)}(r.a)}).call(this,n("3UD+")(t))},"7o/Q":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n("n6bG"),i=n("gRHU"),o=n("quSY"),s=n("2QA8"),a=n("2fFW"),u=n("NJ4a");class c extends o.a{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=i.a;break;case 1:if(!t){this.destination=i.a;break}if("object"==typeof t){t instanceof c?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new l(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new l(this,t,e,n)}}[s.a](){return this}static create(t,e,n){const r=new c(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class l extends c{constructor(t,e,n,o){let s;super(),this._parentSubscriber=t;let a=this;Object(r.a)(e)?s=e:e&&(s=e.next,n=e.error,o=e.complete,e!==i.a&&(a=Object.create(e),Object(r.a)(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=s,this._error=n,this._complete=o}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;a.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=a.a;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):Object(u.a)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;Object(u.a)(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);a.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),a.a.useDeprecatedSynchronousErrorHandling)throw n;Object(u.a)(n)}}__tryOrSetError(t,e,n){if(!a.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return a.a.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(Object(u.a)(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}},"9ppp":function(t,e,n){"use strict";n.d(e,"a",function(){return r});const r=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})()},Cfvw:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n("HDdC"),i=n("SeVD"),o=n("quSY"),s=n("kJWO"),a=n("jZKg"),u=n("Lhse"),c=n("c2HN"),l=n("I55L");function h(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[s.a]}(t))return function(t,e){return new r.a(n=>{const r=new o.a;return r.add(e.schedule(()=>{const i=t[s.a]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(Object(c.a)(t))return function(t,e){return new r.a(n=>{const r=new o.a;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if(Object(l.a)(t))return Object(a.a)(t,e);if(function(t){return t&&"function"==typeof t[u.a]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new r.a(n=>{const r=new o.a;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[u.a](),r.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof r.a?t:new r.a(Object(i.a)(t))}},D0XW:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n("3N8a");const i=new(n("IjjT").a)(r.a)},DH7j:function(t,e,n){"use strict";n.d(e,"a",function(){return r});const r=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))()},EY2u:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("HDdC");const i=new r.a(t=>t.complete());function o(t){return t?function(t){return new r.a(e=>t.schedule(()=>e.complete()))}(t):i}},HDdC:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n("7o/Q"),i=n("2QA8"),o=n("gRHU"),s=n("kJWO"),a=n("SpAZ"),u=n("2fFW");let c=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:s}=this,a=function(t,e,n){if(t){if(t instanceof r.a)return t;if(t[i.a])return t[i.a]()}return t||e||n?new r.a(t,e,n):new r.a(o.a)}(t,e,n);if(a.add(s?s.call(a,this.source):this.source||u.a.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),u.a.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(t){try{return this._subscribe(t)}catch(e){u.a.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:i}=t;if(e||i)return!1;t=n&&n instanceof r.a?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=l(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[s.a](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?a.a:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=l(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function l(t){if(t||(t=u.a.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},I55L:function(t,e,n){"use strict";n.d(e,"a",function(){return r});const r=t=>t&&"number"==typeof t.length&&"function"!=typeof t},IjjT:function(t,e,n){"use strict";n.d(e,"a",function(){return i});let r=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class i extends r{constructor(t,e=r.now){super(t,()=>i.delegate&&i.delegate!==this?i.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return i.delegate&&i.delegate!==this?i.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}},Jgta:function(t,e,n){"use strict";var r=n("zIRd");n.d(e,"a",function(){return r.a}),r.a.registerVersion("firebase","8.2.1","app")},LRne:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n("z+Ro"),i=n("yCtX"),o=n("jZKg");function s(...t){let e=t[t.length-1];return Object(r.a)(e)?(t.pop(),Object(o.a)(t,e)):Object(i.a)(t)}},Lhse:function(t,e,n){"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(e,"a",function(){return i});const i=r()},NJ4a:function(t,e,n){"use strict";function r(t){setTimeout(()=>{throw t},0)}n.d(e,"a",function(){return r})},SeVD:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n("ngJS"),i=n("NJ4a"),o=n("Lhse"),s=n("kJWO"),a=n("I55L"),u=n("c2HN"),c=n("XoHu");const l=t=>{if(t&&"function"==typeof t[s.a])return l=t,t=>{const e=l[s.a]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(Object(a.a)(t))return Object(r.a)(t);if(Object(u.a)(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,i.a),t);if(t&&"function"==typeof t[o.a])return e=t,t=>{const n=e[o.a]();for(;;){let e;try{e=n.next()}catch(r){return t.error(r),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=Object(c.a)(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,l}},SpAZ:function(t,e,n){"use strict";function r(t){return t}n.d(e,"a",function(){return r})},VRyK:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("HDdC"),i=n("z+Ro"),o=n("bHdf"),s=n("yCtX");function a(...t){let e=Number.POSITIVE_INFINITY,n=null,a=t[t.length-1];return Object(i.a)(a)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof a&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof r.a?t[0]:Object(o.a)(e)(Object(s.a)(t,n))}},XNiG:function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"a",function(){return l});var r=n("HDdC"),i=n("7o/Q"),o=n("quSY"),s=n("9ppp"),a=n("Ylt2"),u=n("2QA8");class c extends i.a{constructor(t){super(t),this.destination=t}}let l=(()=>{class t extends r.a{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[u.a](){return new c(this)}lift(t){const e=new h(this,this);return e.operator=t,e}next(t){if(this.closed)throw new s.a;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new s.a;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new s.a;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new s.a;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new s.a;return this.hasError?(t.error(this.thrownError),o.a.EMPTY):this.isStopped?(t.complete(),o.a.EMPTY):(this.observers.push(t),new a.a(this,t))}asObservable(){const t=new r.a;return t.source=this,t}}return t.create=(t,e)=>new h(t,e),t})();class h extends l{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):o.a.EMPTY}}},XoHu:function(t,e,n){"use strict";function r(t){return null!==t&&"object"==typeof t}n.d(e,"a",function(){return r})},Ylt2:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n("quSY");class i extends r.a{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},bHdf:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n("lJxs"),i=n("Cfvw"),o=n("zx2A");function s(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?o=>o.pipe(s((n,o)=>Object(i.a)(t(n,o)).pipe(Object(r.a)((t,r)=>e(n,t,o,r))),n)):("number"==typeof e&&(n=e),e=>e.lift(new a(t,n)))}class a{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new u(t,this.project,this.concurrent))}}class u extends o.b{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e)}_innerSub(t){const e=new o.a(this),n=this.destination;n.add(e);const r=Object(o.c)(t,e);r!==e&&n.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}var c=n("SpAZ");function l(t=Number.POSITIVE_INFINITY){return s(c.a,t)}},c2HN:function(t,e,n){"use strict";function r(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}n.d(e,"a",function(){return r})},fXoL:function(t,e,n){"use strict";n.d(e,"a",function(){return ks}),n.d(e,"b",function(){return js}),n.d(e,"c",function(){return As}),n.d(e,"d",function(){return Ta}),n.d(e,"e",function(){return ba}),n.d(e,"f",function(){return Do}),n.d(e,"g",function(){return Us}),n.d(e,"h",function(){return Lo}),n.d(e,"i",function(){return Jn}),n.d(e,"j",function(){return xs}),n.d(e,"k",function(){return xi}),n.d(e,"l",function(){return Ue}),n.d(e,"m",function(){return Bi}),n.d(e,"n",function(){return ts}),n.d(e,"o",function(){return es}),n.d(e,"p",function(){return Vs}),n.d(e,"q",function(){return fs}),n.d(e,"r",function(){return ya}),n.d(e,"s",function(){return $s}),n.d(e,"t",function(){return Ke}),n.d(e,"u",function(){return Fs}),n.d(e,"v",function(){return Rs}),n.d(e,"w",function(){return Vo}),n.d(e,"x",function(){return Mo}),n.d(e,"y",function(){return tr}),n.d(e,"z",function(){return Ho}),n.d(e,"A",function(){return Gn}),n.d(e,"B",function(){return cs}),n.d(e,"C",function(){return ia}),n.d(e,"D",function(){return Bo}),n.d(e,"E",function(){return qo}),n.d(e,"F",function(){return ps}),n.d(e,"G",function(){return N}),n.d(e,"H",function(){return va}),n.d(e,"I",function(){return da}),n.d(e,"J",function(){return fa}),n.d(e,"K",function(){return Ca}),n.d(e,"L",function(){return aa}),n.d(e,"M",function(){return Ms}),n.d(e,"N",function(){return ji}),n.d(e,"O",function(){return So}),n.d(e,"P",function(){return zn}),n.d(e,"Q",function(){return Sn}),n.d(e,"R",function(){return vn}),n.d(e,"S",function(){return mn}),n.d(e,"T",function(){return En}),n.d(e,"U",function(){return bn}),n.d(e,"V",function(){return _n}),n.d(e,"W",function(){return wn}),n.d(e,"X",function(){return Co}),n.d(e,"Y",function(){return Ea}),n.d(e,"Z",function(){return Oo}),n.d(e,"ab",function(){return To}),n.d(e,"bb",function(){return gn}),n.d(e,"cb",function(){return P}),n.d(e,"db",function(){return Qi}),n.d(e,"eb",function(){return io}),n.d(e,"fb",function(){return ro}),n.d(e,"gb",function(){return Eo}),n.d(e,"hb",function(){return wt}),n.d(e,"ib",function(){return c}),n.d(e,"jb",function(){return yn}),n.d(e,"kb",function(){return yt}),n.d(e,"lb",function(){return Fr}),n.d(e,"mb",function(){return W}),n.d(e,"nb",function(){return X}),n.d(e,"ob",function(){return p}),n.d(e,"pb",function(){return y}),n.d(e,"qb",function(){return Y}),n.d(e,"rb",function(){return Z}),n.d(e,"sb",function(){return $i}),n.d(e,"tb",function(){return eo}),n.d(e,"ub",function(){return to}),n.d(e,"vb",function(){return no}),n.d(e,"wb",function(){return sn}),n.d(e,"xb",function(){return Le}),n.d(e,"yb",function(){return Ns}),n.d(e,"zb",function(){return oo}),n.d(e,"Ab",function(){return uo}),n.d(e,"Bb",function(){return Xi}),n.d(e,"Cb",function(){return Lt}),n.d(e,"Db",function(){return J}),n.d(e,"Eb",function(){return fo}),n.d(e,"Fb",function(){return Ji}),n.d(e,"Gb",function(){return mo});var r=n("XNiG"),i=n("quSY"),o=n("HDdC"),s=n("VRyK"),a=n("w1tV");function u(t){for(let e in t)if(t[e]===u)return e;throw Error("Could not find renamed property on target object.")}function c(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(c).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function l(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const h=u({__forward_ref__:u});function f(t){return t.__forward_ref__=f,t.toString=function(){return c(this())},t}function d(t){return"function"==typeof(e=t)&&e.hasOwnProperty(h)&&e.__forward_ref__===f?t():t;var e}function p(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function y(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function v(t){return g(t,_)||g(t,w)}function g(t,e){return t.hasOwnProperty(e)?t[e]:null}function m(t){return t&&(t.hasOwnProperty(b)||t.hasOwnProperty(E))?t[b]:null}const _=u({"\u0275prov":u}),b=u({"\u0275inj":u}),w=u({ngInjectableDef:u}),E=u({ngInjectorDef:u});var C=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});let O;function T(t){const e=O;return O=t,e}function I(t,e,n){const r=v(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&C.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${c(t)}]`)}function S(t){return{toString:t}.toString()}var x=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),N=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const j="undefined"!=typeof globalThis&&globalThis,A="undefined"!=typeof window&&window,k="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,D="undefined"!=typeof global&&global,P=j||D||A||k,R={},F=[],L=u({"\u0275cmp":u}),M=u({"\u0275dir":u}),V=u({"\u0275pipe":u}),U=u({"\u0275mod":u}),H=u({"\u0275loc":u}),q=u({"\u0275fac":u}),B=u({__NG_ELEMENT_ID__:u});let z=0;function W(t){return S(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===x.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||F,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||N.Emulated,id:"c",styles:t.styles||F,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,i=t.features,o=t.pipes;return n.id+=z++,n.inputs=$(t.inputs,e),n.outputs=$(t.outputs),i&&i.forEach(t=>t(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(G):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(Q):null,n})}function G(t){return tt(t)||function(t){return t[M]||null}(t)}function Q(t){return function(t){return t[V]||null}(t)}const K={};function Y(t){const e={type:t.type,bootstrap:t.bootstrap||F,declarations:t.declarations||F,imports:t.imports||F,exports:t.exports||F,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&S(()=>{K[t.id]=t.type}),e}function J(t,e){return S(()=>{const n=et(t,!0);n.declarations=e.declarations||F,n.imports=e.imports||F,n.exports=e.exports||F})}function $(t,e){if(null==t)return R;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}const X=W;function Z(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function tt(t){return t[L]||null}function et(t,e){const n=t[U]||null;if(!n&&!0===e)throw new Error(`Type ${c(t)} does not have '\u0275mod' property.`);return n}const nt=20,rt=10;function it(t){return Array.isArray(t)&&"object"==typeof t[1]}function ot(t){return Array.isArray(t)&&!0===t[1]}function st(t){return 0!=(8&t.flags)}function at(t){return 2==(2&t.flags)}function ut(t){return 1==(1&t.flags)}function ct(t){return null!==t.template}function lt(t,e){return t.hasOwnProperty(q)?t[q]:null}class ht extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function ft(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():function(t){return"string"==typeof t?t:null==t?"":String(t)}(t)}function dt(t,e){const n=e?" in "+e:"";throw new ht("201",`No provider for ${ft(t)} found${n}`)}class pt{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function yt(){return vt}function vt(t){return t.type.prototype.ngOnChanges&&(t.setInput=mt),gt}function gt(){const t=_t(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===R)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function mt(t,e,n,r){const i=_t(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:R,current:null}),o=i.current||(i.current={}),s=i.previous,a=this.declaredInputs[n],u=s[a];o[a]=new pt(u&&u.currentValue,e,s===R),t[r]=e}function _t(t){return t.__ngSimpleChanges__||null}yt.ngInherit=!0;let bt=void 0;function wt(t){bt=t}function Et(t){return!!t.listen}const Ct={createRenderer:(t,e)=>void 0!==bt?bt:"undefined"!=typeof document?document:void 0};function Ot(t){for(;Array.isArray(t);)t=t[0];return t}function Tt(t,e){return Ot(e[t.index])}function It(t,e){return t.data[e]}function St(t,e){const n=e[t];return it(n)?n:n[0]}function xt(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Nt(t){return 128==(128&t[2])}function jt(t,e){return null==e?null:t[e]}function At(t){t[18]=0}function kt(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Dt={lFrame:$t(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Pt(){return Dt.bindingsEnabled}function Rt(){return Dt.lFrame.lView}function Ft(){return Dt.lFrame.tView}function Lt(t){Dt.lFrame.contextLView=t}function Mt(){let t=Vt();for(;null!==t&&64===t.type;)t=t.parent;return t}function Vt(){return Dt.lFrame.currentTNode}function Ut(t,e){const n=Dt.lFrame;n.currentTNode=t,n.isParent=e}function Ht(){return Dt.lFrame.isParent}function qt(){return Dt.isInCheckNoChangesMode}function Bt(t){Dt.isInCheckNoChangesMode=t}function zt(t,e){const n=Dt.lFrame;n.bindingIndex=n.bindingRootIndex=t,Wt(e)}function Wt(t){Dt.lFrame.currentDirectiveIndex=t}function Gt(t){Dt.lFrame.currentQueryIndex=t}function Qt(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Kt(t,e,n){if(n&C.SkipSelf){let r=e,i=t;for(;r=r.parent,!(null!==r||n&C.Host||(r=Qt(i),null===r)||(i=i[15],10&r.type)););if(null===r)return!1;e=r,t=i}const r=Dt.lFrame=Jt();return r.currentTNode=e,r.lView=t,!0}function Yt(t){const e=Jt(),n=t[1];Dt.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Jt(){const t=Dt.lFrame,e=null===t?null:t.child;return null===e?$t(t):e}function $t(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Xt(){const t=Dt.lFrame;return Dt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Zt=Xt;function te(){const t=Xt();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function ee(){return Dt.lFrame.selectedIndex}function ne(t){Dt.lFrame.selectedIndex=t}function re(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:o,ngAfterViewChecked:s,ngOnDestroy:a}=e;r&&(t.contentHooks||(t.contentHooks=[])).push(-n,r),i&&((t.contentHooks||(t.contentHooks=[])).push(n,i),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,i)),o&&(t.viewHooks||(t.viewHooks=[])).push(-n,o),s&&((t.viewHooks||(t.viewHooks=[])).push(n,s),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,s)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(n,a)}}function ie(t,e,n){ae(t,e,3,n)}function oe(t,e,n,r){(3&t[2])===n&&ae(t,e,n,r)}function se(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function ae(t,e,n,r){const i=null!=r?r:-1;let o=0;for(let s=void 0!==r?65535&t[18]:0;s<e.length;s++)if("number"==typeof e[s+1]){if(o=e[s],null!=r&&o>=r)break}else e[s]<0&&(t[18]+=65536),(o<i||-1==i)&&(ue(t,n,e,s),t[18]=(4294901760&t[18])+s+2),s++}function ue(t,e,n,r){const i=n[r]<0,o=n[r+1],s=t[i?-n[r]:n[r]];i?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,o.call(s)):o.call(s)}const ce=-1;class le{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function he(t,e,n){const r=Et(t);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const s=n[i++],a=n[i++],u=n[i++];r?t.setAttribute(e,a,u,s):e.setAttributeNS(s,a,u)}else{const s=o,a=n[++i];de(s)?r&&t.setProperty(e,s,a):r?t.setAttribute(e,s,a):e.setAttribute(s,a),i++}}return i}function fe(t){return 3===t||4===t||6===t}function de(t){return 64===t.charCodeAt(0)}function pe(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||ye(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function ye(t,e,n,r,i){let o=0,s=t.length;if(-1===e)s=-1;else for(;o<t.length;){const n=t[o++];if("number"==typeof n){if(n===e){s=-1;break}if(n>e){s=o-1;break}}}for(;o<t.length;){const e=t[o];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==s&&(t.splice(s,0,e),o=s+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function ve(t){return t!==ce}function ge(t){return 32767&t}function me(t,e){let n=t>>16,r=e;for(;n>0;)r=r[15],n--;return r}let _e=!0;function be(t){const e=_e;return _e=t,e}let we=0;function Ee(t,e){const n=Oe(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Ce(r.data,t),Ce(e,null),Ce(r.blueprint,null));const i=Te(t,e),o=t.injectorIndex;if(ve(i)){const t=ge(i),n=me(i,e),r=n[1].data;for(let i=0;i<8;i++)e[o+i]=n[t+i]|r[t+i]}return e[o+8]=i,o}function Ce(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Oe(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Te(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){const t=i[1],e=t.type;if(r=2===e?t.declTNode:1===e?i[6]:null,null===r)return ce;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return ce}function Ie(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(B)&&(r=n[B]),null==r&&(r=n[B]=we++);const i=255&r,o=1<<i,s=64&i,a=32&i,u=e.data;128&i?s?a?u[t+7]|=o:u[t+6]|=o:a?u[t+5]|=o:u[t+4]|=o:s?a?u[t+3]|=o:u[t+2]|=o:a?u[t+1]|=o:u[t]|=o}(t,e,n)}function Se(t,e,n){if(n&C.Optional)return t;dt(e,"NodeInjector")}function xe(t,e,n,r){if(n&C.Optional&&void 0===r&&(r=null),0==(n&(C.Self|C.Host))){const i=t[9],o=T(void 0);try{return i?i.get(e,r,n&C.Optional):I(e,r,n&C.Optional)}finally{T(o)}}return Se(r,e,n)}function Ne(t,e,n,r=C.Default,i){if(null!==t){const o=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(B)?t[B]:void 0;return"number"==typeof e?e>=0?255&e:Ae:e}(n);if("function"==typeof o){if(!Kt(e,t,r))return r&C.Host?Se(i,n,r):xe(e,n,r,i);try{const t=o();if(null!=t||r&C.Optional)return t;dt(n)}finally{Zt()}}else if("number"==typeof o){let i=null,s=Oe(t,e),a=ce,u=r&C.Host?e[16][6]:null;for((-1===s||r&C.SkipSelf)&&(a=-1===s?Te(t,e):e[s+8],a!==ce&&Re(r,!1)?(i=e[1],s=ge(a),e=me(a,e)):s=-1);-1!==s;){const t=e[1];if(Pe(o,s,t.data)){const t=ke(s,e,n,i,r,u);if(t!==je)return t}a=e[s+8],a!==ce&&Re(r,e[1].data[s+8]===u)&&Pe(o,s,e)?(i=t,s=ge(a),e=me(a,e)):s=-1}}}return xe(e,n,r,i)}const je={};function Ae(){return new Fe(Mt(),Rt())}function ke(t,e,n,r,i,o){const s=e[1],a=s.data[t+8],u=function(t,e,n,r,i){const o=t.providerIndexes,s=e.data,a=1048575&o,u=t.directiveStart,c=o>>20,l=i?a+c:t.directiveEnd;for(let h=r?a:a+c;h<l;h++){const t=s[h];if(h<u&&n===t||h>=u&&t.type===n)return h}if(i){const t=s[u];if(t&&ct(t)&&t.type===n)return u}return null}(a,s,n,null==r?at(a)&&_e:r!=s&&0!=(3&a.type),i&C.Host&&o===a);return null!==u?De(e,s,u,a):je}function De(t,e,n,r){let i=t[n];const o=e.data;if(i instanceof le){const s=i;s.resolving&&function(t,e){throw new ht("200","Circular dependency in DI detected for "+t)}(ft(o[n]));const a=be(s.canSeeViewProviders);s.resolving=!0;const u=s.injectImpl?T(s.injectImpl):null;Kt(t,r,C.Default);try{i=t[n]=s.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){const r=vt(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{null!==u&&T(u),be(a),s.resolving=!1,Zt()}}return i}function Pe(t,e,n){const r=64&t,i=32&t;let o;return o=128&t?r?i?n[e+7]:n[e+6]:i?n[e+5]:n[e+4]:r?i?n[e+3]:n[e+2]:i?n[e+1]:n[e],!!(o&1<<t)}function Re(t,e){return!(t&C.Self||t&C.Host&&e)}class Fe{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Ne(this._tNode,this._lView,t,void 0,e)}}function Le(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let r=0;for(;r<t;){const i=n[r];if(fe(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<t&&"string"==typeof n[r];)r++;else{if(i===e)return n[r+1];r+=2}}}return null}(Mt(),t)}const Me="__parameters__";function Ve(t,e,n){return S(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty(Me)?t[Me]:Object.defineProperty(t,Me,{value:[]})[Me];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class Ue{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=p({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}function He(t,e){t.forEach(t=>Array.isArray(t)?He(t,e):e(t))}function qe(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Be(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function ze(t,e,n){let r=Ge(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function We(t,e){const n=Ge(t,e);if(n>=0)return t[1|n]}function Ge(t,e){return function(t,e,n){let r=0,i=t.length>>1;for(;i!==r;){const n=r+(i-r>>1),o=t[n<<1];if(e===o)return n<<1;o>e?i=n:r=n+1}return~(i<<1)}(t,e)}const Qe=Ve("Inject",t=>({token:t})),Ke=Ve("Optional"),Ye=Ve("Self"),Je=Ve("SkipSelf"),$e={},Xe=/\n/gm,Ze="__source",tn=u({provide:String,useValue:u});let en,nn=void 0;function rn(t){const e=nn;return nn=t,e}function on(t,e=C.Default){if(void 0===nn)throw new Error("inject() must be called from an injection context");return null===nn?I(t,void 0,e):nn.get(t,e&C.Optional?null:void 0,e)}function sn(t,e=C.Default){return(O||on)(d(t),e)}function an(t){const e=[];for(let n=0;n<t.length;n++){const r=d(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t=void 0,n=C.Default;for(let e=0;e<r.length;e++){const i=r[e];i instanceof Ke||"Optional"===i.ngMetadataName||i===Ke?n|=C.Optional:i instanceof Je||"SkipSelf"===i.ngMetadataName||i===Je?n|=C.SkipSelf:i instanceof Ye||"Self"===i.ngMetadataName||i===Ye?n|=C.Self:t=i instanceof Qe||i===Qe?i.token:i}e.push(sn(t,n))}else e.push(sn(r))}return e}function un(t){var e;return(null===(e=function(){if(void 0===en&&(en=null,P.trustedTypes))try{en=P.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(e){}return en}())||void 0===e?void 0:e.createHTML(t))||t}class cn{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see https://g.co/ng/security#xss)"}}class ln extends cn{getTypeName(){return"HTML"}}class hn extends cn{getTypeName(){return"Style"}}class fn extends cn{getTypeName(){return"Script"}}class dn extends cn{getTypeName(){return"URL"}}class pn extends cn{getTypeName(){return"ResourceURL"}}function yn(t){return t instanceof cn?t.changingThisBreaksApplicationSecurity:t}function vn(t,e){const n=gn(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}function gn(t){return t instanceof cn&&t.getTypeName()||null}function mn(t){return new ln(t)}function _n(t){return new hn(t)}function bn(t){return new fn(t)}function wn(t){return new dn(t)}function En(t){return new pn(t)}class Cn{getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(un(t),"text/html").body;return e.removeChild(e.firstChild),e}catch(e){return null}}}class On{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const e=this.inertDocument.createElement("body");t.appendChild(e)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=un(t),e;const n=this.inertDocument.createElement("body");return n.innerHTML=un(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Tn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,In=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Sn(t){return(t=String(t)).match(Tn)||t.match(In)?t:"unsafe:"+t}function xn(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function Nn(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const jn=xn("area,br,col,hr,img,wbr"),An=xn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),kn=xn("rp,rt"),Dn=Nn(kn,An),Pn=Nn(jn,Nn(An,xn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Nn(kn,xn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Dn),Rn=xn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Fn=xn("srcset"),Ln=Nn(Rn,Fn,xn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),xn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Mn=xn("script,style,template");class Vn{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Pn.hasOwnProperty(e))return this.sanitizedSomething=!0,!Mn.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,o=e.toLowerCase();if(!Ln.hasOwnProperty(o)){this.sanitizedSomething=!0;continue}let s=t.value;Rn[o]&&(s=Sn(s)),Fn[o]&&(r=s,s=(r=String(r)).split(",").map(t=>Sn(t.trim())).join(", ")),this.buf.push(" ",e,'="',qn(s),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Pn.hasOwnProperty(e)&&!jn.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(qn(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+t.outerHTML);return e}}const Un=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Hn=/([^\#-~ |!])/g;function qn(t){return t.replace(/&/g,"&amp;").replace(Un,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Hn,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Bn;function zn(t,e){let n=null;try{Bn=Bn||function(t){return function(){try{return!!(new window.DOMParser).parseFromString(un(""),"text/html")}catch(t){return!1}}()?new Cn:new On(t)}(t);let r=e?String(e):"";n=Bn.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Bn.getInertBodyElement(r)}while(r!==o);return(new Vn).sanitizeChildren(Wn(n)||n)}finally{if(n){const t=Wn(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}function Wn(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Gn=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function Qn(t){return t.ngDebugContext}function Kn(t){return t.ngOriginalError}function Yn(t,...e){t.error(...e)}class Jn{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||Yn}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?Qn(t)?Qn(t):this._findContext(Kn(t)):null}_findOriginalError(t){let e=Kn(t);for(;e&&Kn(e);)e=Kn(e);return e}}function $n(t,e){t.__ngContext__=e}const Xn=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(P))();function Zn(t){return t instanceof Function?t():t}var tr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});function er(t,e){return(void 0)(t,e)}function nr(t){const e=t[3];return ot(e)?e[3]:e}function rr(t){return or(t[13])}function ir(t){return or(t[4])}function or(t){for(;null!==t&&!ot(t);)t=t[4];return t}function sr(t,e,n,r,i){if(null!=r){let o,s=!1;ot(r)?o=r:it(r)&&(s=!0,r=r[0]);const a=Ot(r);0===t&&null!==n?null==i?dr(e,n,a):fr(e,n,a,i||null,!0):1===t&&null!==n?fr(e,n,a,i||null,!0):2===t?function(t,e,n){const r=yr(t,e);r&&function(t,e,n,r){Et(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,a,s):3===t&&e.destroyNode(a),null!=o&&function(t,e,n,r,i){const o=n[7];o!==Ot(n)&&sr(e,t,r,o,i);for(let s=rt;s<n.length;s++){const i=n[s];br(i[1],i,t,e,r,o)}}(e,t,o,n,i)}}function ar(t,e,n){return Et(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function ur(t,e){const n=t[9],r=n.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,kt(i,-1)),n.splice(r,1)}function cr(t,e){if(t.length<=rt)return;const n=rt+e,r=t[n];if(r){const o=r[17];null!==o&&o!==t&&ur(o,r),e>0&&(t[n-1][4]=r[4]);const s=Be(t,rt+e);br(r[1],i=r,i[11],2,null,null),i[0]=null,i[6]=null;const a=s[19];null!==a&&a.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}var i;return r}function lr(t,e){if(!(256&e[2])){const n=e[11];Et(n)&&n.destroyNode&&br(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return hr(t[1],t);for(;e;){let n=null;if(it(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)it(e)&&hr(e[1],e),e=e[3];null===e&&(e=t),it(e)&&hr(e[1],e),n=e&&e[4]}e=n}}(e)}}function hr(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];if(!(t instanceof le)){const e=n[r+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2)e[n+1].call(t[e[n]]);else e.call(t)}}}(t,e),function(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n){for(let t=0;t<n.length-1;t+=2)if("string"==typeof n[t]){const o=n[t+1],s="function"==typeof o?o(e):Ot(e[o]),a=r[i=n[t+2]],u=n[t+3];"boolean"==typeof u?s.removeEventListener(n[t],a,u):u>=0?r[i=u]():r[i=-u].unsubscribe(),t+=2}else{const e=r[i=n[t+1]];n[t].call(e)}if(null!==r)for(let t=i+1;t<r.length;t++)(0,r[t])();e[7]=null}}(t,e),1===e[1].type&&Et(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&ot(e[3])){n!==e[3]&&ur(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function fr(t,e,n,r,i){Et(t)?t.insertBefore(e,n,r,i):e.insertBefore(n,r,i)}function dr(t,e,n){Et(t)?t.appendChild(e,n):e.appendChild(n)}function pr(t,e,n,r,i){null!==r?fr(t,e,n,r,i):dr(t,e,n)}function yr(t,e){return Et(t)?t.parentNode(e):e.parentNode}function vr(t,e,n,r){const i=function(t,e,n){return function(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const e=t.data[r.directiveStart].encapsulation;if(e===N.None||e===N.Emulated)return null}return Tt(r,n)}(t,e.parent,n)}(t,r,e),o=e[11],s=function(t,e,n){return function(t,e,n){return 40&t.type?Tt(t,n):null}(t,0,n)}(r.parent||e[6],0,e);if(null!=i)if(Array.isArray(n))for(let a=0;a<n.length;a++)pr(o,i,n[a],s,!1);else pr(o,i,n,s,!1)}function gr(t,e){if(null!==e){const n=e.type;if(3&n)return Tt(e,t);if(4&n)return mr(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return gr(t,n);{const n=t[e.index];return ot(n)?mr(-1,n):Ot(n)}}if(32&n)return er(e,t)()||Ot(t[e.index]);{const n=t[16],r=n[6],i=nr(n),o=r.projection[e.projection];return null!=o?gr(i,o):gr(t,e.next)}}return null}function mr(t,e){const n=rt+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return gr(t,r)}return e[7]}function _r(t,e,n,r,i,o,s){for(;null!=n;){const a=r[n.index],u=n.type;if(s&&0===e&&(a&&$n(Ot(a),r),n.flags|=4),64!=(64&n.flags))if(8&u)_r(t,e,n.child,r,i,o,!1),sr(e,t,i,a,o);else if(32&u){const s=er(n,r);let u;for(;u=s();)sr(e,t,i,u,o);sr(e,t,i,a,o)}else 16&u?wr(t,e,r,n,i,o):sr(e,t,i,a,o);n=s?n.projectionNext:n.next}}function br(t,e,n,r,i,o){_r(n,r,t.firstChild,e,i,o,!1)}function wr(t,e,n,r,i,o){const s=n[16],a=s[6].projection[r.projection];if(Array.isArray(a))for(let u=0;u<a.length;u++)sr(e,t,i,a[u],o);else _r(t,e,a,s[3],i,o,!0)}function Er(t,e,n){Et(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Cr(t,e,n){Et(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function Or(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const n=e.length;if(i+n===r||t.charCodeAt(i+n)<=32)return i}n=i+1}}const Tr="ng-template";function Ir(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==Or(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function Sr(t){return 4===t.type&&t.value!==Tr}function xr(t,e,n){return e===(4!==t.type||n?t.value:Tr)}function Nr(t,e,n){let r=4;const i=t.attrs||[],o=function(t){for(let e=0;e<t.length;e++)if(fe(t[e]))return e;return t.length}(i);let s=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!s)if(4&r){if(r=2|1&r,""!==u&&!xr(t,u,n)||""===u&&1===e.length){if(jr(r))return!1;s=!0}}else{const c=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!Ir(t.attrs,c,n)){if(jr(r))return!1;s=!0}continue}const l=Ar(8&r?"class":u,i,Sr(t),n);if(-1===l){if(jr(r))return!1;s=!0;continue}if(""!==c){let t;t=l>o?"":i[l+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==Or(e,c,0)||2&r&&c!==t){if(jr(r))return!1;s=!0}}}}else{if(!s&&!jr(r)&&!jr(u))return!1;if(s&&jr(u))continue;s=!1,r=u|1&r}}return jr(r)||s}function jr(t){return 0==(1&t)}function Ar(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let n=!1;for(;i<e.length;){const r=e[i];if(r===t)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++i];for(;"string"==typeof t;)t=e[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function kr(t,e,n=!1){for(let r=0;r<e.length;r++)if(Nr(t,e[r],n))return!0;return!1}function Dr(t,e){return t?":not("+e.trim()+")":e}function Pr(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let s=t[n];if("string"==typeof s)if(2&r){const e=t[++n];i+="["+s+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""===i||jr(s)||(e+=Dr(o,i),i=""),r=s,o=o||!jr(r);n++}return""!==i&&(e+=Dr(o,i)),e}const Rr={};function Fr(t){Lr(Ft(),Rt(),ee()+t,qt())}function Lr(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&ie(e,r,n)}else{const r=t.preOrderHooks;null!==r&&oe(e,r,0,n)}ne(n)}function Mr(t,e){return t<<17|e<<2}function Vr(t){return t>>17&32767}function Ur(t){return 2|t}function Hr(t){return(131068&t)>>2}function qr(t,e){return-131069&t|e<<2}function Br(t){return 1|t}function zr(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const n=t.data[o];Gt(i),n.contentQueries(2,e[o],o)}}}function Wr(t,e,n,r,i,o,s,a,u,c){const l=e.blueprint.slice();return l[0]=i,l[2]=140|r,At(l),l[3]=l[15]=t,l[8]=n,l[10]=s||t&&t[10],l[11]=a||t&&t[11],l[12]=u||t&&t[12]||null,l[9]=c||t&&t[9]||null,l[6]=o,l[16]=2==e.type?t[16]:l,l}function Gr(t,e,n,r,i){let o=t.data[e];if(null===o)o=function(t,e,n,r,i){const o=Vt(),s=Ht(),a=t.data[e]=function(t,e,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=a),null!==o&&(s?null==o.child&&null!==a.parent&&(o.child=a):null===o.next&&(o.next=a)),a}(t,e,n,r,i),Dt.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const t=function(){const t=Dt.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();o.injectorIndex=null===t?-1:t.injectorIndex}return Ut(o,!0),o}function Qr(t,e,n,r){if(0===n)return-1;const i=e.length;for(let o=0;o<n;o++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Kr(t,e,n){Yt(e);try{const r=t.viewQuery;null!==r&&wi(1,r,n);const i=t.template;null!==i&&$r(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&zr(t,e),t.staticViewQueries&&wi(2,t.viewQuery,n);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)vi(t,e[n])}(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),r}finally{e[2]&=-5,te()}}function Yr(t,e,n,r){const i=e[2];if(256==(256&i))return;Yt(e);const o=qt();try{At(e),Dt.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&$r(t,e,n,2,r);const s=3==(3&i);if(!o)if(s){const n=t.preOrderCheckHooks;null!==n&&ie(e,n,null)}else{const n=t.preOrderHooks;null!==n&&oe(e,n,0,null),se(e,0)}if(function(t){for(let e=rr(t);null!==e;e=ir(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],r=n[3];0==(1024&n[2])&&kt(r,1),n[2]|=1024}}}(e),function(t){for(let e=rr(t);null!==e;e=ir(e))for(let t=rt;t<e.length;t++){const n=e[t],r=n[1];Nt(n)&&Yr(r,n,r.template,n[8])}}(e),null!==t.contentQueries&&zr(t,e),!o)if(s){const n=t.contentCheckHooks;null!==n&&ie(e,n)}else{const n=t.contentHooks;null!==n&&oe(e,n,1),se(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const r=n[t];if(r<0)ne(~r);else{const i=r,o=n[++t],s=n[++t];zt(o,i),s(2,e[i])}}}finally{ne(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)pi(t,e[n])}(e,a);const u=t.viewQuery;if(null!==u&&wi(2,u,r),!o)if(s){const n=t.viewCheckHooks;null!==n&&ie(e,n)}else{const n=t.viewHooks;null!==n&&oe(e,n,2),se(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,kt(e[3],-1))}finally{te()}}function Jr(t,e,n,r){const i=e[10],o=!qt(),s=4==(4&e[2]);try{o&&!s&&i.begin&&i.begin(),s&&Kr(t,e,r),Yr(t,e,n,r)}finally{o&&!s&&i.end&&i.end()}}function $r(t,e,n,r,i){const o=ee();try{ne(-1),2&r&&e.length>nt&&Lr(t,e,nt,qt()),n(r,i)}finally{ne(o)}}function Xr(t,e,n){Pt()&&(function(t,e,n,r){const i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||Ee(n,e),$n(r,e);const s=n.initialInputs;for(let a=i;a<o;a++){const r=t.data[a],o=ct(r);o&&li(e,n,r);const u=De(e,t,a,n);$n(u,e),null!==s&&hi(0,a-i,u,r,0,s),o&&(St(n.index,e)[8]=u)}}(t,e,n,Tt(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,o=n.index,s=Dt.lFrame.currentDirectiveIndex;try{ne(o);for(let n=r;n<i;n++){const r=t.data[n],i=e[n];Wt(n),null===r.hostBindings&&0===r.hostVars&&null===r.hostAttrs||oi(r,i)}}finally{ne(-1),Wt(s)}}(t,e,n))}function Zr(t,e,n=Tt){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],a=-1===s?n(e,t):t[s];t[i++]=a}}}function ti(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=ei(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function ei(t,e,n,r,i,o,s,a,u,c){const l=nt+r,h=l+i,f=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Rr);return n}(l,h),d="function"==typeof c?c():c;return f[1]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function ni(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function ri(t,e,n,r){let i=!1;if(Pt()){const o=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];kr(n,s.selectors,!1)&&(i||(i=[]),Ie(Ee(n,e),t,s.type),ct(s)?(si(t,n),i.unshift(s)):i.push(s))}return i}(t,e,n),s=null===r?null:{"":-1};if(null!==o){i=!0,ui(n,t.data.length,o.length);for(let t=0;t<o.length;t++){const e=o[t];e.providersResolver&&e.providersResolver(e)}let r=!1,a=!1,u=Qr(t,e,o.length,null);for(let i=0;i<o.length;i++){const c=o[i];n.mergedAttrs=pe(n.mergedAttrs,c.hostAttrs),ci(t,n,e,u,c),ai(u,c,s),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const l=c.type.prototype;!r&&(l.ngOnChanges||l.ngOnInit||l.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),r=!0),a||!l.ngOnChanges&&!l.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),u++}!function(t,e){const n=e.directiveEnd,r=t.data,i=e.attrs,o=[];let s=null,a=null;for(let u=e.directiveStart;u<n;u++){const t=r[u],n=t.inputs,c=null===i||Sr(e)?null:fi(n,i);o.push(c),s=ni(n,u,s),a=ni(t.outputs,u,a)}null!==s&&(s.hasOwnProperty("class")&&(e.flags|=16),s.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=s,e.outputs=a}(t,n)}s&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const i=n[e[t+1]];if(null==i)throw new ht("301",`Export of name '${e[t+1]}' not found!`);r.push(e[t],i)}}}(n,r,s)}return n.mergedAttrs=pe(n.mergedAttrs,n.attrs),i}function ii(t,e,n,r,i,o){const s=o.hostBindings;if(s){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const o=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=o&&n.push(o),n.push(r,i,s)}}function oi(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function si(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function ai(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ct(e)&&(n[""]=t)}}function ui(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function ci(t,e,n,r,i){t.data[r]=i;const o=i.factory||(i.factory=lt(i.type)),s=new le(o,ct(i),null);t.blueprint[r]=s,n[r]=s,ii(t,e,0,r,Qr(t,n,i.hostVars,Rr),i)}function li(t,e,n){const r=Tt(e,t),i=ti(n),o=t[10],s=gi(t,Wr(t,i,null,n.onPush?64:16,r,e,o,o.createRenderer(r,n),null,null));t[e.index]=s}function hi(t,e,n,r,i,o){const s=o[e];if(null!==s){const t=r.setInput;for(let e=0;e<s.length;){const i=s[e++],o=s[e++],a=s[e++];null!==t?r.setInput(n,a,i,o):n[o]=a}}}function fi(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function di(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function pi(t,e){const n=St(e,t);if(Nt(n)){const t=n[1];80&n[2]?Yr(t,n,t.template,n[8]):n[5]>0&&yi(n)}}function yi(t){for(let n=rr(t);null!==n;n=ir(n))for(let t=rt;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];Yr(t,e,t.template,e[8])}else e[5]>0&&yi(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const r=St(e[n],t);Nt(r)&&r[5]>0&&yi(r)}}function vi(t,e){const n=St(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),Kr(r,n,n[8])}function gi(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function mi(t){for(;t;){t[2]|=64;const e=nr(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function _i(t,e,n){const r=e[10];r.begin&&r.begin();try{Yr(t,e,t.template,n)}catch(i){throw Ti(e,i),i}finally{r.end&&r.end()}}function bi(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=xt(n),i=r[1];Jr(i,r,i.template,n)}}(t[8])}function wi(t,e,n){Gt(0),e(t,n)}const Ei=(()=>Promise.resolve(null))();function Ci(t){return t[7]||(t[7]=[])}function Oi(t){return t.cleanup||(t.cleanup=[])}function Ti(t,e){const n=t[9],r=n?n.get(Jn,null):null;r&&r.handleError(e)}function Ii(t,e,n,r,i){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],u=e[s],c=t.data[s];null!==c.setInput?c.setInput(u,i,r,a):u[a]=i}}function Si(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const t=e[s];"number"==typeof t?o=t:1==o?i=l(i,t):2==o&&(r=l(r,t+": "+e[++s]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}const xi=new Ue("INJECTOR",-1);class Ni{get(t,e=$e){if(e===$e){const e=new Error(`NullInjectorError: No provider for ${c(t)}!`);throw e.name="NullInjectorError",e}return e}}const ji=new Ue("Set Injector scope."),Ai={},ki={},Di=[];let Pi=void 0;function Ri(){return void 0===Pi&&(Pi=new Ni),Pi}function Fi(t,e=null,n=null,r){return new Li(t,n,e||Ri(),r)}class Li{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];e&&He(e,n=>this.processProvider(n,t,e)),He([t],t=>this.processInjectorType(t,[],i)),this.records.set(xi,Vi(void 0,this));const o=this.records.get(ji);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:c(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=$e,n=C.Default){this.assertNotDestroyed();const r=rn(this);try{if(!(n&C.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(i=t)||"object"==typeof i&&i instanceof Ue)&&v(t);e=n&&this.injectableDefInScope(n)?Vi(Mi(t),Ai):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&C.Self?Ri():this.parent).get(t,e=n&C.Optional&&e===$e?null:e)}catch(o){if("NullInjectorError"===o.name){if((o.ngTempTokenPath=o.ngTempTokenPath||[]).unshift(c(t)),r)throw o;return function(t,e,n,r){const i=t.ngTempTokenPath;throw e[Ze]&&i.unshift(e[Ze]),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=c(e);if(Array.isArray(e))i=e.map(c).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):c(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Xe,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(o,t,"R3InjectorError",this.source)}throw o}finally{rn(r)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(c(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=d(t)))return!1;let r=m(t);const i=null==r&&t.ngModule||void 0,o=void 0===i?t:i,s=-1!==n.indexOf(o);if(void 0!==i&&(r=m(i)),null==r)return!1;if(null!=r.imports&&!s){let t;n.push(o);try{He(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];He(r,t=>this.processProvider(t,n,r||Di))}}this.injectorDefTypes.add(o),this.records.set(o,Vi(r.factory,Ai));const a=r.providers;if(null!=a&&!s){const e=t;He(a,t=>this.processProvider(t,e,a))}return void 0!==i&&void 0!==t.providers}processProvider(t,e,n){let r=Hi(t=d(t))?t:d(t&&t.provide);const i=function(t,e,n){return Ui(t)?Vi(void 0,t.useValue):Vi(function(t,e,n){let r=void 0;if(Hi(t)){const e=d(t);return lt(e)||Mi(e)}if(Ui(t))r=()=>d(t.useValue);else if((i=t)&&i.useFactory)r=()=>t.useFactory(...an(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>sn(d(t.useExisting));else{const e=d(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return lt(e)||Mi(e);r=()=>new e(...an(t.deps))}var i;return r}(t),Ai)}(t);if(Hi(t)||!0!==t.multi)this.records.get(r);else{let e=this.records.get(r);e||(e=Vi(void 0,Ai,!0),e.factory=()=>an(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,i)}hydrate(t,e){var n;return e.value===Ai&&(e.value=ki,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function Mi(t){const e=v(t),n=null!==e?e.factory:lt(t);if(null!==n)return n;const r=m(t);if(null!==r)return r.factory;if(t instanceof Ue)throw new Error(`Token ${c(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=function(t,e){const n=[];for(let r=0;r<t;r++)n.push("?");return n}(e);throw new Error(`Can't resolve all parameters for ${c(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[_]||t[w]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Vi(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Ui(t){return null!==t&&"object"==typeof t&&tn in t}function Hi(t){return"function"==typeof t}const qi=function(t,e,n){return function(t,e=null,n=null,r){const i=Fi(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};let Bi=(()=>{class t{static create(t,e){return Array.isArray(t)?qi(t,e,""):qi(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=$e,t.NULL=new Ni,t.\u0275prov=p({token:t,providedIn:"any",factory:()=>sn(xi)}),t.__NG_ELEMENT_ID__=-1,t})();function zi(t,e){re(xt(t)[1],Mt())}let Wi=null;function Gi(){if(!Wi){const t=P.Symbol;if(t&&t.iterator)Wi=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Wi=n)}}}return Wi}function Qi(t){return!!Ki(t)&&(Array.isArray(t)||!(t instanceof Map)&&Gi()in t)}function Ki(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Yi(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Ji(t,e,n,r,i,o,s,a){const u=Rt(),c=Ft(),l=t+nt,h=c.firstCreatePass?function(t,e,n,r,i,o,s,a,u){const c=e.consts,l=Gr(e,t,4,s||null,jt(c,a));ri(e,n,l,jt(c,u)),re(e,l);const h=l.tViews=ei(2,l,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,l),h.queries=e.queries.embeddedTView(l)),l}(l,c,u,e,n,r,i,o,s):c.data[l];Ut(h,!1);const f=u[11].createComment("");vr(c,u,f,h),$n(f,u),gi(u,u[l]=di(f,u,f,h)),ut(h)&&Xr(c,u,h),null!=s&&Zr(u,h,a)}function $i(t,e=C.Default){const n=Rt();return null===n?sn(t,e):Ne(Mt(),n,d(t),e)}function Xi(t,e,n){const r=Rt();return Yi(r,Dt.lFrame.bindingIndex++,e)&&function(t,e,n,r,i,o,s,a){const u=Tt(e,n);let c,l=e.inputs;null!=l&&(c=l[r])?(Ii(t,n,c,r,i),at(e)&&function(t,e){const n=St(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=s?s(i,e.value||"",r):i,Et(o)?o.setProperty(u,r,i):de(r)||(u.setProperty?u.setProperty(r,i):u[r]=i))}(Ft(),function(){const t=Dt.lFrame;return It(t.tView,t.selectedIndex)}(),r,t,e,r[11],n),Xi}function Zi(t,e,n,r,i){const o=i?"class":"style";Ii(t,n,e.inputs[o],o,r)}function to(t,e,n,r){const i=Rt(),o=Ft(),s=nt+t,a=i[11],u=i[s]=ar(a,e,Dt.lFrame.currentNamespace),c=o.firstCreatePass?function(t,e,n,r,i,o,s){const a=e.consts,u=Gr(e,t,2,i,jt(a,o));return ri(e,n,u,jt(a,s)),null!==u.attrs&&Si(u,u.attrs,!1),null!==u.mergedAttrs&&Si(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(s,o,i,0,e,n,r):o.data[s];Ut(c,!0);const l=c.mergedAttrs;null!==l&&he(a,u,l);const h=c.classes;null!==h&&Cr(a,u,h);const f=c.styles;null!==f&&Er(a,u,f),64!=(64&c.flags)&&vr(o,i,u,c),0===Dt.lFrame.elementDepthCount&&$n(u,i),Dt.lFrame.elementDepthCount++,ut(c)&&(Xr(o,i,c),function(t,e,n){if(st(e)){const r=e.directiveEnd;for(let i=e.directiveStart;i<r;i++){const e=t.data[i];e.contentQueries&&e.contentQueries(1,n[i],i)}}}(o,c,i)),null!==r&&Zr(i,c)}function eo(){let t=Mt();Ht()?Dt.lFrame.isParent=!1:(t=t.parent,Ut(t,!1));const e=t;Dt.lFrame.elementDepthCount--;const n=Ft();n.firstCreatePass&&(re(n,t),st(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Zi(n,e,Rt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Zi(n,e,Rt(),e.stylesWithoutHost,!1)}function no(){return Rt()}function ro(t){return!!t&&"function"==typeof t.then}function io(t){return!!t&&"function"==typeof t.subscribe}function oo(t,e,n=!1,r){const i=Rt(),o=Ft(),s=Mt();return function(t,e,n,r,i,o,s=!1,a){const u=ut(r),c=t.firstCreatePass&&Oi(t),l=Ci(e);let h=!0;if(3&r.type){const f=Tt(r,e),d=a?a(f):R,p=d.target||f,y=l.length,v=a?t=>a(Ot(t[r.index])).target:r.index;if(Et(n)){let s=null;if(!a&&u&&(s=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const t=i[o];if(t===n&&i[o+1]===r){const t=e[7],n=i[o+2];return t.length>n?t[n]:null}"string"==typeof t&&(o+=2)}return null}(t,e,i,r.index)),null!==s)(s.__ngLastListenerFn__||s).__ngNextListenerFn__=o,s.__ngLastListenerFn__=o,h=!1;else{o=ao(r,e,o,!1);const t=n.listen(d.name||p,i,o);l.push(o,t),c&&c.push(i,v,y,y+1)}}else o=ao(r,e,o,!0),p.addEventListener(i,o,s),l.push(o),c&&c.push(i,v,y,s)}else o=ao(r,e,o,!1);const f=r.outputs;let d;if(h&&null!==f&&(d=f[i])){const t=d.length;if(t)for(let n=0;n<t;n+=2){const t=e[d[n]][d[n+1]].subscribe(o),s=l.length;l.push(o,t),c&&c.push(i,r.index,s,-(s+1))}}}(o,i,i[11],s,t,e,n,r),oo}function so(t,e,n){try{return!1!==e(n)}catch(r){return Ti(t,r),!1}}function ao(t,e,n,r){return function i(o){if(o===Function)return n;const s=2&t.flags?St(t.index,e):e;0==(32&e[2])&&mi(s);let a=so(e,n,o),u=i.__ngNextListenerFn__;for(;u;)a=so(e,u,o)&&a,u=u.__ngNextListenerFn__;return r&&!1===a&&(o.preventDefault(),o.returnValue=!1),a}}function uo(t=1){return function(t){return(Dt.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Dt.lFrame.contextLView))[8]}(t)}const co=[];function lo(t,e,n,r,i){const o=t[n+1],s=null===e;let a=r?Vr(o):Hr(o),u=!1;for(;0!==a&&(!1===u||s);){const n=t[a+1];ho(t[a],e)&&(u=!0,t[a+1]=r?Br(n):Ur(n)),a=r?Vr(n):Hr(n)}u&&(t[n+1]=r?Ur(o):Br(o))}function ho(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Ge(t,e)>=0}function fo(t,e,n){return function(t,e,n,r){const i=Rt(),o=Ft(),s=function(t){const e=Dt.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+2,n}();o.firstUpdatePass&&function(t,e,n,r){const i=t.data;if(null===i[n+1]){const o=i[ee()],s=function(t,e){return e>=t.expandoStartIndex}(t,n);(function(t,e){return 0!=(32&t.flags)})(o)&&null===e&&!s&&(e=!1),e=function(t,e,n,r){const i=function(t){const e=Dt.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let o=e.residualStyles;if(null===i)0===e.styleBindings&&(n=yo(n=po(null,t,e,n,r),e.attrs,r),o=null);else{const s=e.directiveStylingLast;if(-1===s||t[s]!==i)if(n=po(i,t,e,n,r),null===o){let n=function(t,e,n){const r=e.styleBindings;if(0!==Hr(r))return t[Vr(r)]}(t,e);void 0!==n&&Array.isArray(n)&&(n=po(null,t,e,n[1],r),n=yo(n,e.attrs,r),function(t,e,n,r){t[Vr(e.styleBindings)]=r}(t,e,0,n))}else o=function(t,e,n){let r=void 0;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)r=yo(r,t[o].hostAttrs,false);return yo(r,e.attrs,false)}(t,e)}return void 0!==o&&(e.residualStyles=o),n}(i,o,e,r),function(t,e,n,r,i,o){let s=e.styleBindings,a=Vr(s),u=Hr(s);t[r]=n;let c,l=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||Ge(t,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){const e=Vr(t[a+1]);t[r+1]=Mr(e,a),0!==e&&(t[e+1]=qr(t[e+1],r)),t[a+1]=131071&t[a+1]|r<<17}else t[r+1]=Mr(a,0),0!==a&&(t[a+1]=qr(t[a+1],r)),a=r;else t[r+1]=Mr(u,0),0===a?a=r:t[u+1]=qr(t[u+1],r),u=r;l&&(t[r+1]=Ur(t[r+1])),lo(t,c,r,!0),lo(t,c,r,!1),function(t,e,n,r,i){const o=t.residualStyles;null!=o&&"string"==typeof e&&Ge(o,e)>=0&&(n[r+1]=Br(n[r+1]))}(e,c,t,r),s=Mr(a,u),e.styleBindings=s}(i,o,e,n,s)}}(o,t,s,false),e!==Rr&&Yi(i,s,e)&&function(t,e,n,r,i,o,s,a){if(!(3&e.type))return;const u=t.data,c=u[a+1];go(1==(1&c)?vo(u,e,n,i,Hr(c),s):void 0)||(go(o)||function(t){return 2==(2&t)}(c)&&(o=vo(u,null,n,i,a,s)),function(t,e,n,r,i){const o=Et(t);{let e=-1===r.indexOf("-")?void 0:tr.DashCase;if(null==i)o?t.removeStyle(n,r,e):n.style.removeProperty(r);else{const s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),e|=tr.Important),o?t.setStyle(n,r,i,e):n.style.setProperty(r,i,s?"important":"")}}}(r,0,function(t,e){return Ot(e[t])}(ee(),n),i,o))}(o,o.data[ee()],i,i[11],t,i[s+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=c(yn(t)))),t}(e,n),false,s)}(t,e,n),fo}function po(t,e,n,r,i){let o=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(o=e[a],r=yo(r,o.hostAttrs,i),o!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function yo(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?i=s:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),ze(t,s,!!n||e[++o]))}return void 0===t?null:t}function vo(t,e,n,r,i,o){const s=null===e;let a=void 0;for(;i>0;){const e=t[i],o=Array.isArray(e),u=o?e[1]:e,c=null===u;let l=n[i+1];l===Rr&&(l=c?co:void 0);let h=c?We(l,r):u===r?l:void 0;if(o&&!go(h)&&(h=We(e,r)),go(h)&&(a=h,s))return a;const f=t[i+1];i=s?Vr(f):Hr(f)}if(null!==e){let t=o?e.residualClasses:e.residualStyles;null!=t&&(a=We(t,r))}return a}function go(t){return void 0!==t}function mo(t,e=""){const n=Rt(),r=Ft(),i=t+nt,o=r.firstCreatePass?Gr(r,i,1,e,null):r.data[i],s=n[i]=function(t,e){return Et(t)?t.createText(e):t.createTextNode(e)}(n[11],e);vr(r,n,s,o),Ut(o,!1)}const _o=void 0;var bo=["en",[["a","p"],["AM","PM"],_o],[["AM","PM"],_o,_o],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],_o,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],_o,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",_o,"{1} 'at' {0}",_o],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let wo={};function Eo(t,e,n){"string"!=typeof e&&(n=e,e=t[So.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),wo[e]=t,n&&(wo[e][So.ExtraData]=n)}function Co(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=Io(e);if(n)return n;const r=e.split("-")[0];if(n=Io(r),n)return n;if("en"===r)return bo;throw new Error(`Missing locale data for the locale "${t}".`)}function Oo(t){return Co(t)[So.CurrencyCode]||null}function To(t){return Co(t)[So.PluralCase]}function Io(t){return t in wo||(wo[t]=P.ng&&P.ng.common&&P.ng.common.locales&&P.ng.common.locales[t]),wo[t]}var So=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});const xo="en-US";let No=xo;function jo(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error("ASSERTION ERROR: "+t+` [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(No=t.toLowerCase().replace(/_/g,"-"))}class Ao{}class ko{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${c(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let Do=(()=>{class t{}return t.NULL=new ko,t})();function Po(...t){}function Ro(t,e){return new Lo(Tt(t,e))}const Fo=function(){return Ro(Mt(),Rt())};let Lo=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=Fo,t})();class Mo{}let Vo=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Uo(),t})();const Uo=function(){const t=Rt(),e=St(Mt().index,t);return function(t){return t[11]}(it(e)?e:t)};let Ho=(()=>{class t{}return t.\u0275prov=p({token:t,providedIn:"root",factory:()=>null}),t})();class qo{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Bo=new qo("11.0.5");class zo{constructor(){}supports(t){return Qi(t)}create(t){return new Go(t)}}const Wo=(t,e)=>e;class Go{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Wo}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const o=!n||e&&e.currentIndex<Jo(n,r,i)?e:n,s=Jo(o,r,i),a=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);const t=s-r,e=a-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;e<=o&&o<t&&(i[n]=r+1)}i[o.previousIndex]=e-t}}s!==a&&t(o,s,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Qi(t))throw new Error(`Error trying to diff '${c(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,e)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),o=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Gi()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,t,r,e)),Object.is(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),o=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Qo(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Yo),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Yo),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Qo{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Ko{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class Yo{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Ko,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Jo(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class $o{constructor(){}supports(t){return t instanceof Map||Ki(t)}create(){return new Xo}}class Xo{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Ki(t)))throw new Error(`Error trying to diff '${c(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Zo(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Zo{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let ts=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Je,new Ke]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=p({token:t,providedIn:"root",factory:()=>new t([new zo])}),t})(),es=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Je,new Ke]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=p({token:t,providedIn:"root",factory:()=>new t([new $o])}),t})();function ns(t,e,n,r,i=!1){for(;null!==n;){const o=e[n.index];if(null!==o&&r.push(Ot(o)),ot(o))for(let t=rt;t<o.length;t++){const e=o[t],n=e[1].firstChild;null!==n&&ns(e[1],e,n,r)}const s=n.type;if(8&s)ns(t,e,n.child,r);else if(32&s){const t=er(n,e);let i;for(;i=t();)r.push(i)}else if(16&s){const t=e[16],i=t[6].projection[n.projection];if(Array.isArray(i))r.push(...i);else{const e=nr(t);ns(e[1],e,i,r,!0)}}n=i?n.projectionNext:n.next}return r}class rs{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null}get rootNodes(){const t=this._lView,e=t[1];return ns(e,t,e.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}lr(this._lView[1],this._lView)}onDestroy(t){!function(t,e,n,r){const i=Ci(e);i.push(r)}(0,this._lView,0,t)}markForCheck(){mi(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){_i(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Bt(!0);try{_i(t,e,n)}finally{Bt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,br(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class is extends rs{constructor(t){super(t),this._view=t}detectChanges(){bi(this._view)}checkNoChanges(){!function(t){Bt(!0);try{bi(t)}finally{Bt(!1)}}(this._view)}get context(){return null}}const os=[new $o],ss=new ts([new zo]),as=new es(os),us=function(){return t=Mt(),e=Rt(),4&t.type?new hs(e,t,Ro(t,e)):null;var t,e};let cs=(()=>{class t{}return t.__NG_ELEMENT_ID__=us,t})();const ls=cs,hs=class extends ls{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=Wr(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(e)),Kr(e,n,t),new rs(n)}};class fs{}const ds=function(){return function(t,e){let n;const r=e[t.index];if(ot(r))n=r;else{let i;if(8&t.type)i=Ot(r);else{const n=e[11];i=n.createComment("");const r=Tt(t,e);fr(n,yr(n,r),i,function(t,e){return Et(t)?t.nextSibling(e):e.nextSibling}(n,r),!1)}e[t.index]=n=di(r,e,i,t),gi(e,n)}return new vs(n,t,e)}(Mt(),Rt())};let ps=(()=>{class t{}return t.__NG_ELEMENT_ID__=ds,t})();const ys=ps,vs=class extends ys{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return Ro(this._hostTNode,this._hostLView)}get injector(){return new Fe(this._hostTNode,this._hostLView)}get parentInjector(){const t=Te(this._hostTNode,this._hostLView);if(ve(t)){const e=me(t,this._hostLView),n=ge(t);return new Fe(e[1].data[n+8],e)}return new Fe(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=gs(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-rt}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const o=n||this.parentInjector;if(!i&&null==t.ngModule&&o){const t=o.get(fs,null);t&&(i=t)}const s=t.create(o,r,void 0,i);return this.insert(s.hostView,e),s}insert(t,e){const n=t._lView,r=n[1];if(ot(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new vs(e,e[6],e[3]);r.detach(r.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function(t,e,n,r){const i=rt+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-rt?(e[4]=n[i],qe(n,rt+r,e)):(n.push(e),e[4]=null),e[3]=n;const s=e[17];null!==s&&n!==s&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(s,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(r,n,o,i);const s=mr(i,o),a=n[11],u=yr(a,o[7]);return null!==u&&function(t,e,n,r,i,o){r[0]=i,r[6]=e,br(t,r,n,1,i,o)}(r,o[6],a,n,u,s),t.attachToViewContainerRef(this),qe(ms(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=gs(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=cr(this._lContainer,e);n&&(Be(ms(this._lContainer),e),lr(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=cr(this._lContainer,e);return n&&null!=Be(ms(this._lContainer),e)?new rs(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function gs(t){return t[8]}function ms(t){return t[8]||(t[8]=[])}const _s={};class bs extends Do{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=tt(t);return new Cs(e,this.ngModule)}}function ws(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const Es=new Ue("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Xn});class Cs extends Ao{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(Pr).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return ws(this.componentDef.inputs)}get outputs(){return ws(this.componentDef.outputs)}create(t,e,n,r){const i=(r=r||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const o=t.get(n,_s,i);return o!==_s||r===_s?o:e.get(n,r,i)}}}(t,r.injector):t,o=i.get(Mo,Ct),s=i.get(Ho,null),a=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(Et(t))return t.selectRootElement(e,n===N.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(a,n,this.componentDef.encapsulation):ar(o.createRenderer(null,this.componentDef),u,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(u)),l=this.componentDef.onPush?576:528,h={components:[],scheduler:Xn,clean:Ei,playerHandler:null,flags:0},f=ei(0,null,null,1,0,null,null,null,null,null),d=Wr(null,f,h,l,null,null,o,a,s,i);let p,y;Yt(d);try{const t=function(t,e,n,r,i,o){const s=n[1];n[20]=t;const a=Gr(s,20,2,"#host",null),u=a.mergedAttrs=e.hostAttrs;null!==u&&(Si(a,u,!0),null!==t&&(he(i,t,u),null!==a.classes&&Cr(i,t,a.classes),null!==a.styles&&Er(i,t,a.styles)));const c=r.createRenderer(t,e),l=Wr(n,ti(e),null,e.onPush?64:16,n[20],a,r,c,null,null);return s.firstCreatePass&&(Ie(Ee(a,n),s,e.type),si(s,a),ui(a,n.length,1)),gi(n,l),n[20]=l}(c,this.componentDef,d,o,a);if(c)if(n)he(a,c,["ng-version",Bo.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!jr(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&he(a,c,t),e&&e.length>0&&Cr(a,c,e.join(" "))}if(y=It(f,nt),void 0!==e){const t=y.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=e[n];t.push(null!=r?Array.from(r):null)}}p=function(t,e,n,r,i){const o=n[1],s=function(t,e,n){const r=Mt();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),ci(t,r,e,Qr(t,e,1,null),n));const i=De(e,t,r.directiveStart,r);$n(i,e);const o=Tt(r,e);return o&&$n(o,e),i}(o,n,e);if(r.components.push(s),t[8]=s,i&&i.forEach(t=>t(s,e)),e.contentQueries){const t=Mt();e.contentQueries(1,s,t.directiveStart)}const a=Mt();return!o.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(ne(a.index),ii(n[1],a,0,a.directiveStart,a.directiveEnd,e),oi(e,s)),s}(t,this.componentDef,d,h,[zi]),Kr(f,d,null)}finally{te()}return new Os(this.componentType,p,Ro(y,d),d,y)}}class Os extends class{}{constructor(t,e,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new is(r),this.componentType=t}get injector(){return new Fe(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Ts=new Map;class Is extends fs{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new bs(this);const n=et(t),r=t[H]||null;r&&jo(r),this._bootstrapComponents=Zn(n.bootstrap),this._r3Injector=Fi(t,e,[{provide:fs,useValue:this},{provide:Do,useValue:this.componentFactoryResolver}],c(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Bi.THROW_IF_NOT_FOUND,n=C.Default){return t===Bi||t===fs||t===xi?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Ss extends class{}{constructor(t){super(),this.moduleType=t,null!==et(t)&&function(t){const e=new Set;!function t(n){const r=et(n,!0),i=r.id;null!==i&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${c(e)} vs ${c(e.name)}`)}(i,Ts.get(i),n),Ts.set(i,n));const o=Zn(r.imports);for(const s of o)e.has(s)||(e.add(s),t(s))}(t)}(t)}create(t){return new Is(this.moduleType,t)}}const xs=class extends r.a{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,o=t=>null,s=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(o=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(s=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(o=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(s=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const a=super.subscribe(r,o,s);return t instanceof i.a&&t.add(a),a}};function Ns(t=C.Default){const e=function(t=!1){return function(t,e,n){if(!n&&at(t)){const n=St(t.index,e);return new rs(n,n)}return 47&t.type?new rs(e[16],e):null}(Mt(),Rt(),t)}(!0);if(null!=e||t&C.Optional)return e;dt("ChangeDetectorRef")}const js=new Ue("Application Initializer");let As=(()=>{class t{constructor(t){this.appInits=t,this.resolve=Po,this.reject=Po,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();ro(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(sn(js,8))},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})();const ks=new Ue("AppId"),Ds={provide:ks,useFactory:function(){return`${Ps()}${Ps()}${Ps()}`},deps:[]};function Ps(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Rs=new Ue("Platform Initializer"),Fs=new Ue("Platform ID"),Ls=new Ue("appBootstrapListener");let Ms=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})();const Vs=new Ue("LocaleId"),Us=new Ue("DefaultCurrencyCode");class Hs{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const qs=function(t){return new Ss(t)},Bs=qs,zs=function(t){return Promise.resolve(qs(t))},Ws=function(t){const e=qs(t),n=Zn(et(t).declarations).reduce((t,e)=>{const n=tt(e);return n&&t.push(new Cs(n)),t},[]);return new Hs(e,n)},Gs=Ws,Qs=function(t){return Promise.resolve(Ws(t))};let Ks=(()=>{class t{constructor(){this.compileModuleSync=Bs,this.compileModuleAsync=zs,this.compileModuleAndAllComponentsSync=Gs,this.compileModuleAndAllComponentsAsync=Qs}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})();const Ys=(()=>Promise.resolve(0))();function Js(t){"undefined"==typeof Zone?Ys.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class $s{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new xs(!1),this.onMicrotaskEmpty=new xs(!1),this.onStable=new xs(!1),this.onError=new xs(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const n=this;n._nesting=0,n._outer=n._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(n._inner=n._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(n._inner=n._inner.fork(Zone.longStackTraceZoneSpec)),n.shouldCoalesceEventChangeDetection=e,n.lastRequestAnimationFrameId=-1,n.nativeRequestAnimationFrame=function(){let t=P.requestAnimationFrame,e=P.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(P,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,ta(t),Zs(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),ta(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(n,r,i,o,s,a)=>{try{return ea(t),n.invokeTask(i,o,s,a)}finally{e&&"eventTask"===o.type&&e(),na(t)}},onInvoke:(e,n,r,i,o,s,a)=>{try{return ea(t),e.invoke(r,i,o,s,a)}finally{na(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,ta(t),Zs(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(n)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!$s.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if($s.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,Xs,Po,Po);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const Xs={};function Zs(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function ta(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function ea(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function na(t){t._nesting--,Zs(t)}class ra{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xs,this.onMicrotaskEmpty=new xs,this.onStable=new xs,this.onError=new xs}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let ia=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$s.assertNotInAngularZone(),Js(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Js(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(sn($s))},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})(),oa=(()=>{class t{constructor(){this._applications=new Map,ca.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return ca.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})();class sa{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}function aa(t){ca=t}let ua,ca=new sa,la=!0,ha=!1;function fa(){return ha=!0,la}function da(){if(ha)throw new Error("Cannot enable prod mode after platform setup.");la=!1}const pa=new Ue("AllowMultipleToken");class ya{constructor(t,e){this.name=t,this.token=e}}function va(t,e,n=[]){const r="Platform: "+e,i=new Ue(r);return(e=[])=>{let o=ga();if(!o||o.injector.get(pa,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0},{provide:ji,useValue:"platform"});!function(t){if(ua&&!ua.destroyed&&!ua.injector.get(pa,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");ua=t.get(ma);const e=t.get(Rs,null);e&&e.forEach(t=>t())}(Bi.create({providers:t,name:r}))}return function(t){const e=ga();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function ga(){return ua&&!ua.destroyed?ua:null}let ma=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new ra:("zone.js"===t?void 0:t)||new $s({enableLongStackTrace:fa(),shouldCoalesceEventChangeDetection:e}),n}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),r=[{provide:$s,useValue:n}];return n.run(()=>{const e=Bi.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),o=i.injector.get(Jn,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{o.handleError(t)}});i.onDestroy(()=>{wa(this._modules,i),t.unsubscribe()})}),function(t,e,n){try{const r=n();return ro(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,n,()=>{const t=i.injector.get(As);return t.runInitializers(),t.donePromise.then(()=>(jo(i.injector.get(Vs,xo)||xo),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=_a({},e);return function(t,e,n){const r=new Ss(n);return Promise.resolve(r)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(ba);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${c(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(sn(Bi))},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})();function _a(t,e){return Array.isArray(e)?e.reduce(_a,t):Object.assign(Object.assign({},t),e)}let ba=(()=>{class t{constructor(t,e,n,r,i,u){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=u,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const c=new o.a(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),l=new o.a(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{$s.assertNotInAngularZone(),Js(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{$s.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=Object(s.a)(c,l.pipe(Object(a.a)()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof Ao?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(fs),i=n.create(Bi.NULL,[],e||n.selector,r),o=i.location.nativeElement,s=i.injector.get(ia,null),a=s&&i.injector.get(oa);return s&&a&&a.registerApplication(o,s),i.onDestroy(()=>{this.detachView(i.hostView),wa(this.components,i),a&&a.unregisterApplication(o)}),this._loadComponent(i),fa()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;wa(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Ls,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(sn($s),sn(Ms),sn(Bi),sn(Jn),sn(Do),sn(As))},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})();function wa(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Ea=function(t){return null},Ca=va(null,"core",[{provide:Fs,useValue:"unknown"},{provide:ma,deps:[Bi]},{provide:oa,deps:[]},{provide:Ms,deps:[]}]),Oa=[{provide:ba,useClass:ba,deps:[$s,Ms,Bi,Jn,Do,As]},{provide:Es,deps:[$s],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:As,useClass:As,deps:[[new Ke,js]]},{provide:Ks,useClass:Ks,deps:[]},Ds,{provide:ts,useFactory:function(){return ss},deps:[]},{provide:es,useFactory:function(){return as},deps:[]},{provide:Vs,useFactory:function(t){return jo(t=t||"undefined"!=typeof $localize&&$localize.locale||xo),t},deps:[[new Qe(Vs),new Ke,new Je]]},{provide:Us,useValue:"USD"}];let Ta=(()=>{class t{constructor(t){}}return t.\u0275mod=Y({type:t}),t.\u0275inj=y({factory:function(e){return new(e||t)(sn(ba))},providers:Oa}),t})()},gRHU:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("2fFW"),i=n("NJ4a");const o={closed:!0,next(t){},error(t){if(r.a.useDeprecatedSynchronousErrorHandling)throw t;Object(i.a)(t)},complete(){}}},jZKg:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("HDdC"),i=n("quSY");function o(t,e){return new r.a(n=>{const r=new i.a;let o=0;return r.add(e.schedule(function(){o!==t.length?(n.next(t[o++]),n.closed||r.add(this.schedule())):n.complete()})),r})}},kJWO:function(t,e,n){"use strict";n.d(e,"a",function(){return r});const r=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")()},lJxs:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n("7o/Q");function i(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(t,e))}}class o{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new s(t,this.project,this.thisArg))}}class s extends r.a{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}},mAIw:function(t,e,n){"use strict";n.d(e,"c",function(){return i}),n.d(e,"a",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"d",function(){return a}),n.d(e,"h",function(){return u}),n.d(e,"e",function(){return c}),n.d(e,"f",function(){return l}),n.d(e,"g",function(){return h});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}},n6bG:function(t,e,n){"use strict";function r(t){return"function"==typeof t}n.d(e,"a",function(){return r})},ngJS:function(t,e,n){"use strict";n.d(e,"a",function(){return r});const r=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}},pxpQ:function(t,e,n){"use strict";n.d(e,"b",function(){return u}),n.d(e,"a",function(){return l});var r=n("7o/Q"),i=n("EY2u"),o=n("LRne"),s=n("HDdC");let a=(()=>{class t{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return Object(o.a)(this.value);case"E":return t=this.error,new s.a(e=>e.error(t));case"C":return Object(i.a)()}var t;throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();function u(t,e=0){return function(n){return n.lift(new c(t,e))}}class c{constructor(t,e=0){this.scheduler=t,this.delay=e}call(t,e){return e.subscribe(new l(t,this.scheduler,this.delay))}}class l extends r.a{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(l.dispatch,this.delay,new h(t,this.destination)))}_next(t){this.scheduleMessage(a.createNext(t))}_error(t){this.scheduleMessage(a.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(a.createComplete()),this.unsubscribe()}}class h{constructor(t,e){this.notification=t,this.destination=e}}},"q/0M":function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var i;n.d(e,"a",function(){return s}),n.d(e,"b",function(){return h}),n.d(e,"c",function(){return f}),n.d(e,"d",function(){return d});var o=[],s=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},u=s.INFO,c=((i={})[s.DEBUG]="log",i[s.VERBOSE]="log",i[s.INFO]="info",i[s.WARN]="warn",i[s.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=c[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in s))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.DEBUG],t)),this._logHandler.apply(this,r([this,s.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.VERBOSE],t)),this._logHandler.apply(this,r([this,s.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.INFO],t)),this._logHandler.apply(this,r([this,s.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.WARN],t)),this._logHandler.apply(this,r([this,s.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.ERROR],t)),this._logHandler.apply(this,r([this,s.ERROR],t))},t}();function f(t){o.forEach(function(e){e.setLogLevel(t)})}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map(function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}}).filter(function(t){return t}).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:s[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=o;r<i.length;r++)n(i[r])}},qOnz:function(t,e,n){"use strict";n.d(e,"a",function(){return f}),n.d(e,"b",function(){return O}),n.d(e,"c",function(){return L}),n.d(e,"d",function(){return i}),n.d(e,"e",function(){return o}),n.d(e,"f",function(){return a}),n.d(e,"g",function(){return u}),n.d(e,"h",function(){return k}),n.d(e,"i",function(){return M}),n.d(e,"j",function(){return l}),n.d(e,"k",function(){return h}),n.d(e,"l",function(){return q}),n.d(e,"m",function(){return d}),n.d(e,"n",function(){return A}),n.d(e,"o",function(){return v}),n.d(e,"p",function(){return g}),n.d(e,"q",function(){return _}),n.d(e,"r",function(){return P}),n.d(e,"s",function(){return b}),n.d(e,"t",function(){return p}),n.d(e,"u",function(){return y}),n.d(e,"v",function(){return E}),n.d(e,"w",function(){return m}),n.d(e,"x",function(){return w}),n.d(e,"y",function(){return j}),n.d(e,"z",function(){return S}),n.d(e,"A",function(){return R}),n.d(e,"B",function(){return F}),n.d(e,"C",function(){return D}),n.d(e,"D",function(){return G}),n.d(e,"E",function(){return W}),n.d(e,"F",function(){return x}),n.d(e,"G",function(){return H}),n.d(e,"H",function(){return B}),n.d(e,"I",function(){return z});var r=n("mAIw"),i=function(t,e){if(!t)throw o(e)},o=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=(15&a)<<2|c>>6,h=63&c;u||(h=64,s||(l=64)),r.push(n[o>>2],n[(3&o)<<4|a>>4],n[l],n[h])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();r.push(o<<2|s>>4),64!==a&&(r.push(s<<4&240|a>>2),64!==u&&r.push(a<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},u=function(t){var e=s(t);return a.encodeByteArray(e,!0)},c=function(t){try{return a.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(t){return h(void 0,t)}function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=h(t[n],e[n]));return t}var f=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())}function y(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}function v(){return"object"==typeof self&&self.self===self}function g(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function m(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function _(){return d().indexOf("Electron/")>=0}function b(){var t=d();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function w(){return d().indexOf("MSAppHost/")>=0}function E(){return!1}var C=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,O.prototype.create),o}return Object(r.c)(e,t),e}(Error),O=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?T(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new C(i,a,r);return u},t}();function T(t,e){return t.replace(I,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}var I=/\{\$([^}]+)}/g;function S(t){return JSON.parse(t)}function x(t){return JSON.stringify(t)}var N=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=S(c(o[0])||""),n=S(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(s){}return{header:e,claims:n,data:r,signature:i}},j=function(t){var e=N(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},A=function(t){var e=N(t).claims;return"object"==typeof e&&!0===e.admin};function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function P(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function R(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function F(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}var L=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,s=this.chain_[0],a=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=c^a&(u^c),o=1518500249):(i=a^u^c,o=1859775393):r<60?(i=a&u|c&(a|u),o=2400959708):(i=a^u^c,o=3395469782);var h=(s<<5|s>>>27)+i+l+o+n[r]&4294967295;l=c,c=u,u=4294967295&(a<<30|a>>>2),a=s,s=h}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function M(t,e){var n=new V(t,e);return n.subscribe.bind(n)}var V=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=U),void 0===r.error&&(r.error=U),void 0===r.complete&&(r.complete=U);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function U(){}var H=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function q(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+r+" argument "}function B(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(q(t,e,r)+"must be a valid function.")}function z(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(q(t,e,r)+"must be a valid context object.")}var W=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=55296&&o<=56319){var s=o-55296;r++,i(r<t.length,"Surrogate pair missing trail surrogate."),o=65536+(s<<10)+(t.charCodeAt(r)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},G=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e}},qgXg:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return u});var r=n("3N8a");class i extends r.a{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}var o=n("IjjT");class s extends o.a{}const a=new s(i),u=a},quSY:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("DH7j"),i=n("XoHu"),o=n("n6bG");const s=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let a=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:a,_unsubscribe:c,_subscriptions:l}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(Object(o.a)(c)){a&&(this._unsubscribe=void 0);try{c.call(this)}catch(h){e=h instanceof s?u(h.errors):[h]}}if(Object(r.a)(l)){let t=-1,n=l.length;for(;++t<n;){const n=l[t];if(Object(i.a)(n))try{n.unsubscribe()}catch(h){e=e||[],h instanceof s?e=e.concat(u(h.errors)):e.push(h)}}}if(e)throw new s(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof t){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}var e;return t.EMPTY=((e=new t).closed=!0,e),t})();function u(t){return t.reduce((t,e)=>t.concat(e instanceof s?e.errors:e),[])}},spgP:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return I}),n.d(e,"b",function(){return _}),n.d(e,"c",function(){return m}),n.d(e,"d",function(){return d}),n.d(e,"e",function(){return g}),n.d(e,"f",function(){return O}),n.d(e,"g",function(){return w}),n.d(e,"h",function(){return p}),n.d(e,"i",function(){return v}),n.d(e,"j",function(){return E});var r=n("qgXg"),i=n("D0XW"),o=n("vkgz"),s=n("tf+s"),a=n("pxpQ"),u=n("fXoL"),c=n("Jgta");function l(){}class h{constructor(t,e=r.b){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,n){const r=this.zone;return this.delegate.schedule(function(e){r.runGuarded(()=>{t.apply(this,[e])})},e,n)}}class f{constructor(t){this.zone=t,this.task=null}call(t,e){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",l,{},l,l)),e.pipe(Object(o.a)({next:n,complete:n,error:n})).subscribe(t).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}class d{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new h(Zone.current)),this.insideAngular=t.run(()=>new h(Zone.current,i.a))}}function p(t){return function(e){return(e=e.lift(new f(t.ngZone))).pipe(Object(s.a)(t.outsideAngular),Object(a.b)(t.insideAngular))}}const y=["ngOnDestroy"],v=(t,e,n,r={})=>new Proxy(t,{get:(i,o)=>n.runOutsideAngular(()=>{var i;if(t[o])return(null===(i=null==r?void 0:r.spy)||void 0===i?void 0:i.get)&&r.spy.get(o,t[o]),t[o];if(y.indexOf(o)>-1)return()=>{};const s=e.toPromise().then(t=>{const e=t&&t[o];return"function"==typeof e?e.bind(t):e&&e.then?e.then(t=>n.run(()=>t)):n.run(()=>e)});return new Proxy(()=>{},{get:(t,e)=>s[e],apply:(t,e,n)=>s.then(t=>{var e;const i=t&&t(...n);return(null===(e=null==r?void 0:r.spy)||void 0===e?void 0:e.apply)&&r.spy.apply(o,n,i),i})})})}),g=(t,e)=>{e.forEach(e=>{Object.getOwnPropertyNames(e.prototype||e).forEach(n=>{Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e.prototype||e,n))})})},m=new u.l("angularfire2.app.options"),_=new u.l("angularfire2.app.nameOrConfig"),b=new u.E("6.1.4");function w(e,n,r){const i="object"==typeof r&&r||{};i.name=i.name||"string"==typeof r&&r||"[DEFAULT]";const o=c.a.apps.filter(t=>t&&t.name===i.name)[0]||n.runOutsideAngular(()=>c.a.initializeApp(e,i));try{JSON.stringify(e)!==JSON.stringify(o.options)&&C("error",`${o.name} Firebase App already initialized with different options${t.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(s){}return o}const E=()=>{C("warn","You may need to import 'firebase/auth' manually in your component rather than rely on AngularFireAuth's dynamic import, when using the emulator suite https://github.com/angular/angularfire/issues/2656")},C=(t,...e)=>{Object(u.J)()&&"undefined"!=typeof console&&console[t](...e)};function O(e,n,r,i,o){const[s,...a]=globalThis.\u0275AngularfireInstanceCache.get(e)||[];if(s){try{o.some((t,e)=>{const n=a[e];return t&&"object"==typeof t?JSON.stringify(t)!==JSON.stringify(n):t!==n})&&C("error",`${n} was already initialized on the ${r.name} Firebase App instance with different settings.${t.hot?" You may need to reload as Firebase is not HMR aware.":""}`)}catch(u){}return s}{const t=i();return globalThis.\u0275AngularfireInstanceCache.set(e,[t,...o]),t}}globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=new Map);const T={provide:class{},useFactory:w,deps:[m,u.s,[new u.t,_]]};let I=(()=>{class t{constructor(t){c.a.registerVersion("angularfire",b.full,t.toString()),c.a.registerVersion("angular",u.D.full)}static initializeApp(e,n){return{ngModule:t,providers:[{provide:m,useValue:e},{provide:_,useValue:n}]}}}return t.\u0275mod=u.qb({type:t}),t.\u0275inj=u.pb({factory:function(e){return new(e||t)(u.wb(u.u))},providers:[T]}),t})()}).call(this,n("3UD+")(t))},"tf+s":function(t,e,n){"use strict";n.d(e,"a",function(){return v});var r=n("HDdC");let i=1;const o=(()=>Promise.resolve())(),s={};function a(t){return t in s&&(delete s[t],!0)}const u={setImmediate(t){const e=i++;return s[e]=!0,o.then(()=>a(e)&&t()),e},clearImmediate(t){a(t)}};var c=n("3N8a");class l extends c.a{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=u.setImmediate(t.flush.bind(t,null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(u.clearImmediate(e),t.scheduled=void 0)}}var h=n("IjjT");class f extends h.a{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,r=-1,i=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++r<i&&(t=e.shift()));if(this.active=!1,n){for(;++r<i&&(t=e.shift());)t.unsubscribe();throw n}}}const d=new f(l);var p=n("DH7j");class y extends r.a{constructor(t,e=0,n=d){var r;super(),this.source=t,this.delayTime=e,this.scheduler=n,r=e,(Object(p.a)(r)||!(r-parseFloat(r)+1>=0)||e<0)&&(this.delayTime=0),n&&"function"==typeof n.schedule||(this.scheduler=d)}static create(t,e=0,n=d){return new y(t,e,n)}static dispatch(t){const{source:e,subscriber:n}=t;return this.add(e.subscribe(n))}_subscribe(t){return this.scheduler.schedule(y.dispatch,this.delayTime,{source:this.source,subscriber:t})}}function v(t,e=0){return function(n){return n.lift(new g(t,e))}}class g{constructor(t,e){this.scheduler=t,this.delay=e}call(t,e){return new y(e,this.delay,this.scheduler).subscribe(t)}}},vkgz:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n("7o/Q");function i(){}var o=n("n6bG");function s(t,e,n){return function(r){return r.lift(new a(t,e,n))}}class a{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new u(t,this.nextOrObserver,this.error,this.complete))}}class u extends r.a{constructor(t,e,n,r){super(t),this._tapNext=i,this._tapError=i,this._tapComplete=i,this._tapError=n||i,this._tapComplete=r||i,Object(o.a)(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||i,this._tapError=e.error||i,this._tapComplete=e.complete||i)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}},w1tV:function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r=n("XNiG"),i=n("HDdC"),o=n("7o/Q"),s=n("quSY");function a(){return function(t){return t.lift(new u(t))}}class u{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new c(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class c extends o.a{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class l extends i.a{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new s.a,t.add(this.source.subscribe(new f(this.getSubject(),this))),t.closed&&(this._connection=null,t=s.a.EMPTY)),t}refCount(){return a()(this)}}const h=(()=>{const t=l.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class f extends r.b{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function d(){return new r.a}function p(){return t=>{return a()((e=d,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,h);return r.source=t,r.subjectFactory=n,r})(t));var e}}},yCtX:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n("HDdC"),i=n("ngJS"),o=n("jZKg");function s(t,e){return e?Object(o.a)(t,e):new r.a(Object(i.a)(t))}},"z+Ro":function(t,e,n){"use strict";function r(t){return t&&"function"==typeof t.schedule}n.d(e,"a",function(){return r})},zIRd:function(t,e,n){"use strict";var r,i,o=n("mAIw"),s=n("qOnz"),a=n("/6Yf"),u=n("q/0M"),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new s.b("app","Firebase",c),h="@firebase/app",f="[DEFAULT]",d=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),p=new u.b("@firebase/app"),y=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Object(s.j)(t),this.container=new a.b(e.name),this._addComponent(new a.a("app",function(){return u},"PUBLIC"));try{for(var c=Object(o.h)(this.firebase_.INTERNAL.components.values()),l=c.next();!l.done;l=c.next())this._addComponent(l.value)}catch(h){r={error:h}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(t){return t.delete()}))}).then(function(){t.isDeleted_=!0})},t.prototype._getService=function(t,e){return void 0===e&&(e=f),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){p.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();y.prototype.name&&y.prototype.options||y.prototype.delete||console.log("dc");var v=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var a=o.name;if("string"!=typeof a||!a)throw l.create("bad-app-name",{appName:String(a)});if(Object(s.h)(e,a))throw l.create("duplicate-app",{appName:a});var u=new t(n,o,r);return e[a]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=d[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void p.warn(u.join(" "))}c(new a.a(i+"-version",function(){return{library:i,version:e}},"VERSION"))},setLogLevel:u.c,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument",{appName:name});Object(u.d)(t,e)},apps:null,SDK_VERSION:"8.0.1",INTERNAL:{registerComponent:c,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!Object(s.h)(e,t))throw l.create("no-app",{appName:t});return e[t]}function c(a){var u,c,h=a.name;if(n.has(h))return p.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===a.type?r[h]:null;if(n.set(h,a),"PUBLIC"===a.type){var f=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[h])throw l.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==a.serviceProps&&Object(s.k)(f,a.serviceProps),r[h]=f,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,h).apply(this,a.multipleInstances?t:[])}}try{for(var d=Object(o.h)(Object.keys(e)),y=d.next();!y.done;y=d.next())e[y.value]._addComponent(a)}catch(v){u={error:v}}finally{try{y&&!y.done&&(c=d.return)&&c.call(d)}finally{if(u)throw u.error}}return"PUBLIC"===a.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map(function(t){return e[t]})}}),i.App=t,r}(y);return e.INTERNAL=Object(o.a)(Object(o.a)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Object(s.k)(e,t)},createSubscribe:s.i,ErrorFactory:s.b,deepExtend:s.k}),e}(),g=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null}).filter(function(t){return t}).join(" ")},t}();if(Object(s.o)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=v.initializeApp;v.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(s.u)()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),_.apply(void 0,t)};var b=v;!function(t,e){t.INTERNAL.registerComponent(new a.a("platform-logger",function(t){return new g(t)},"PRIVATE")),t.registerVersion(h,"0.6.13",void 0),t.registerVersion("fire-js","")}(b),e.a=b},zUnb:function(t,e,n){"use strict";n.r(e);var r=n("fXoL");const i={apiKey:"AIzaSyDfReJOH0QTWsZdkriCr-hEZqDQibewxa0",authDomain:"squares-game-c37f9.firebaseapp.com",projectId:"squares-game-c37f9",storageBucket:"squares-game-c37f9.appspot.com",messagingSenderId:"14243231302",appId:"1:14243231302:web:b9fb316d2cf371ab717c47"};let o=null;function s(){return o}const a=new r.l("DocumentToken");var u=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({});const c=r.ab;class l{}let h=(()=>{class t extends l{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(c(e||this.locale)(t)){case u.Zero:return"zero";case u.One:return"one";case u.Two:return"two";case u.Few:return"few";case u.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(r.wb(r.p))},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac}),t})();class f{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let d=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(Ed){throw new Error(`Cannot find a differ supporting object '${e}' of type '${t=e,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new f(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new p(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const o=new p(t,i);e.push(o)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(r.sb(r.F),r.sb(r.B),r.sb(r.n))},t.\u0275dir=r.nb({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class p{constructor(t,e){this.record=t,this.view=e}}let y=(()=>{class t{}return t.\u0275mod=r.qb({type:t}),t.\u0275inj=r.pb({factory:function(e){return new(e||t)},providers:[{provide:l,useClass:h}]}),t})();function v(t){return"server"===t}class g extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new g,o||(o=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=_||(_=document.querySelector("base"),_)?_.getAttribute("href"):null;return null==e?null:(n=e,m||(m=document.createElement("a")),m.setAttribute("href",n),"/"===m.pathname.charAt(0)?m.pathname:"/"+m.pathname);var n}resetBaseElement(){_=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}(document.cookie,t)}}let m,_=null;const b=new r.l("TRANSITION_ID"),w=[{provide:r.b,useFactory:function(t,e,n){return()=>{n.get(r.c).donePromise.then(()=>{const n=s();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[b,a,r.m],multi:!0}];class E{static init(){Object(r.L)(new E)}addToWindow(t){r.cb.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},r.cb.getAllAngularTestabilities=()=>t.getAllTestabilities(),r.cb.getAllAngularRootElements=()=>t.getAllRootElements(),r.cb.frameworkStabilizers||(r.cb.frameworkStabilizers=[]),r.cb.frameworkStabilizers.push(t=>{const e=r.cb.getAllAngularTestabilities();let n=e.length,i=!1;const o=function(e){i=i||e,n--,0==n&&t(i)};e.forEach(function(t){t.whenStable(o)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?s().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const C=new r.l("EventManagerPlugins");let O=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(r.wb(C),r.wb(r.s))},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac}),t})();class T{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=s().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let I=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac}),t})(),S=(()=>{class t extends I{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>s().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(r.wb(a))},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac}),t})();const x={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},N=/%COMP%/g;function j(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?j(t,i,n):(i=i.replace(N,t),n.push(i))}return n}function A(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let k=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new D(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case r.G.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new P(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case r.G.ShadowDom:return new R(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=j(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(r.wb(O),r.wb(S),r.wb(r.a))},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac}),t})();class D{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(x[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=x[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=x[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,i){i&(r.y.DashCase|r.y.Important)?t.style.setProperty(e,n,i&r.y.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&r.y.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,A(n)):this.eventManager.addEventListener(t,e,A(n))}}class P extends D{constructor(t,e,n,r){super(t),this.component=n;const i=j(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(N,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(N,r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class R extends D{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=j(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const t=document.createElement("style");t.textContent=i[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let F=(()=>{class t extends T{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(r.wb(a))},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac}),t})();const L=["alt","control","meta","shift"],M={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},V={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},U={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let H=(()=>{class t extends T{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>s().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let o="";if(L.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),o+=t+".")}),o+=i,0!=n.length||0===i.length)return null;const s={};return s.domEventName=r,s.fullKey=o,s}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&V.hasOwnProperty(e)&&(e=V[e]))}return M[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),L.forEach(r=>{r!=n&&(0,U[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(r.wb(a))},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac}),t})();const q=[{provide:r.u,useValue:"browser"},{provide:r.v,useValue:function(){g.makeCurrent(),E.init()},multi:!0},{provide:a,useFactory:function(){return Object(r.hb)(document),document},deps:[]}],B=Object(r.H)(r.K,"browser",q),z=[[],{provide:r.N,useValue:"root"},{provide:r.i,useFactory:function(){return new r.i},deps:[]},{provide:C,useClass:F,multi:!0,deps:[a,r.s,r.u]},{provide:C,useClass:H,multi:!0,deps:[a]},[],{provide:k,useClass:k,deps:[O,S,r.a]},{provide:r.x,useExisting:k},{provide:I,useExisting:S},{provide:S,useClass:S,deps:[a]},{provide:r.C,useClass:r.C,deps:[r.s]},{provide:O,useClass:O,deps:[C,r.s]},[]];let W=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:r.a,useValue:e.appId},{provide:b,useExisting:r.a},w]}}}return t.\u0275mod=r.qb({type:t}),t.\u0275inj=r.pb({factory:function(e){return new(e||t)(r.wb(t,12))},providers:z,imports:[y,r.d]}),t})();function G(t,e){return{type:7,name:t,definitions:e,options:{}}}function Q(t,e=null){return{type:4,styles:e,timings:t}}function K(t,e,n=null){return{type:1,expr:t,animation:e,options:n}}"undefined"!=typeof window&&window;var Y=n("D0XW"),J=n("HDdC"),$=n("Cfvw"),X=n("LRne"),Z=n("bHdf");function tt(...t){return Object(Z.a)(1)(Object(X.a)(...t))}var et=n("z+Ro");function nt(...t){const e=t[t.length-1];return Object(et.a)(e)?(t.pop(),n=>tt(t,n,e)):e=>tt(t,e)}var rt=n("7o/Q");function it(){return t=>t.lift(new ot)}class ot{call(t,e){return e.subscribe(new st(t))}}class st extends rt.a{constructor(t){super(t),this.hasPrev=!1}_next(t){let e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}var at=n("lJxs");function ut(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new ct(t,e,n))}}class ct{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new lt(t,this.accumulator,this.seed,this.hasSeed))}}class lt extends rt.a{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function ht(t,e){return n=>n.lift(new ft(t,e))}class ft{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new dt(t,this.compare,this.keySelector))}}class dt extends rt.a{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(r){return this.destination.error(r)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(r){return this.destination.error(r)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}function pt(t,e){return function(n){return n.lift(new yt(t,e))}}class yt{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new vt(t,this.predicate,this.thisArg))}}class vt extends rt.a{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}var gt=n("pxpQ"),mt=n("spgP"),_t=n("Jgta"),bt=n("zIRd"),wt=n("q/0M"),Et=n("qOnz"),Ct=function(t,e){return(Ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Ot(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Tt,It="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},St=St||{},xt=It||self;function Nt(){}function jt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function At(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var kt="closure_uid_"+(1e9*Math.random()>>>0),Dt=0;function Pt(t,e,n){return t.call.apply(t.bind,arguments)}function Rt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ft(t,e,n){return(Ft=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Pt:Rt).apply(null,arguments)}function Lt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Mt(){return Date.now()}function Vt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Ut(){this.j=this.j,this.i=this.i}Ut.prototype.j=!1,Ut.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,kt)&&t[kt]||(t[kt]=++Dt)}(this)},Ut.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var Ht=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},qt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Bt(t){return Array.prototype.concat.apply([],arguments)}function zt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Wt(t){return/^[\s\xa0]*$/.test(t)}var Gt,Qt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Kt(t,e){return-1!=t.indexOf(e)}function Yt(t,e){return t<e?-1:t>e?1:0}t:{var Jt=xt.navigator;if(Jt){var $t=Jt.userAgent;if($t){Gt=$t;break t}}Gt=""}function Xt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Zt(t){var e={};for(var n in t)e[n]=t[n];return e}var te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ee(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<te.length;o++)n=te[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ne(t){return ne[" "](t),t}ne[" "]=Nt;var re,ie,oe=Kt(Gt,"Opera"),se=Kt(Gt,"Trident")||Kt(Gt,"MSIE"),ae=Kt(Gt,"Edge"),ue=ae||se,ce=Kt(Gt,"Gecko")&&!(Kt(Gt.toLowerCase(),"webkit")&&!Kt(Gt,"Edge"))&&!(Kt(Gt,"Trident")||Kt(Gt,"MSIE"))&&!Kt(Gt,"Edge"),le=Kt(Gt.toLowerCase(),"webkit")&&!Kt(Gt,"Edge");function he(){var t=xt.document;return t?t.documentMode:void 0}t:{var fe="",de=(ie=Gt,ce?/rv:([^\);]+)(\)|;)/.exec(ie):ae?/Edge\/([\d\.]+)/.exec(ie):se?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ie):le?/WebKit\/(\S+)/.exec(ie):oe?/(?:Version)[ \/]?(\S+)/.exec(ie):void 0);if(de&&(fe=de?de[1]:""),se){var pe=he();if(null!=pe&&pe>parseFloat(fe)){re=String(pe);break t}}re=fe}var ye={};function ve(t){return function(t,e){var n=ye;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=Qt(String(re)).split("."),r=Qt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=Yt(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||Yt(0==s[2].length,0==a[2].length)||Yt(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var ge=xt.document&&se&&(he()||parseInt(re,10))||void 0,me=!se||9<=Number(ge),_e=se&&!ve("9"),be=function(){if(!xt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{xt.addEventListener("test",Nt,e),xt.removeEventListener("test",Nt,e)}catch(n){}return t}();function we(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Ee(t,e){if(we.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ce){t:{try{ne(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ce[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}we.prototype.b=function(){this.defaultPrevented=!0},Vt(Ee,we);var Ce={2:"touch",3:"pen",4:"mouse"};Ee.prototype.b=function(){Ee.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,_e)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Oe="closure_listenable_"+(1e6*Math.random()|0),Te=0;function Ie(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Te,this.Y=this.Z=!1}function Se(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function xe(t){this.src=t,this.a={},this.b=0}function Ne(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=Ht(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Se(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function je(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}xe.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=je(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ie(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ae="closure_lm_"+(1e6*Math.random()|0),ke={};function De(t,e,n,r,i){if(r&&r.once)return Re(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)De(t,e[o],n,r,i);return null}return n=Be(n),t&&t[Oe]?t.va(e,n,At(r)?!!r.capture:!!r,i):Pe(t,e,n,!1,r,i)}function Pe(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=At(i)?!!i.capture:!!i;if(s&&!me)return null;var a=He(t);if(a||(t[Ae]=a=new xe(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Ue,e=me?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)be||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Me(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Re(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Re(t,e[o],n,r,i);return null}return n=Be(n),t&&t[Oe]?t.wa(e,n,At(r)?!!r.capture:!!r,i):Pe(t,e,n,!0,r,i)}function Fe(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Fe(t,e[o],n,r,i);else r=At(r)?!!r.capture:!!r,n=Be(n),t&&t[Oe]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=je(o=t.a[e],n,r,i))&&(Se(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=He(t))&&(e=t.a[e.toString()],t=-1,e&&(t=je(e,n,r,i)),(n=-1<t?e[t]:null)&&Le(n))}function Le(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Oe])Ne(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Me(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=He(e))?(Ne(n,t),0==n.b&&(n.src=null,e[Ae]=null)):Se(t)}}}function Me(t){return t in ke?ke[t]:ke[t]="on"+t}function Ve(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Le(t),n.call(r,e)}function Ue(t,e){if(t.Y)return!0;if(!me){if(!e)t:{e=["window","event"];for(var n=xt,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ve(t,e=new Ee(e,this))}return Ve(t,new Ee(e,this))}function He(t){return(t=t[Ae])instanceof xe?t:null}var qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Be(t){return"function"==typeof t?t:(t[qe]||(t[qe]=function(e){return t.handleEvent(e)}),t[qe])}function ze(){Ut.call(this),this.c=new xe(this),this.J=this,this.C=null}function We(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new we(e,t);else if(e instanceof we)e.target=e.target||t;else{var i=e;ee(e=new we(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Ge(s,r,!0,e)&&i}if(i=Ge(s=e.a=t,r,!0,e)&&i,i=Ge(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ge(s=e.a=n[o],r,!1,e)&&i}function Ge(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&Ne(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Vt(ze,Ut),ze.prototype[Oe]=!0,(Tt=ze.prototype).addEventListener=function(t,e,n,r){De(this,t,e,n,r)},Tt.removeEventListener=function(t,e,n,r){Fe(this,t,e,n,r)},Tt.G=function(){if(ze.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Se(n[r]);delete e.a[t],e.b--}}this.C=null},Tt.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},Tt.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Qe=xt.JSON.stringify;function Ke(){this.b=this.a=null}var Ye,Je=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new Xe},function(t){t.reset()});function $e(){var t=nn,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Xe(){this.next=this.b=this.a=null}function Ze(t){xt.setTimeout(function(){throw t},0)}function tn(t,e){Ye||function(){var t=xt.Promise.resolve(void 0);Ye=function(){t.then(rn)}}(),en||(Ye(),en=!0),nn.add(t,e)}Ke.prototype.add=function(t,e){var n=Je.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xe.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Xe.prototype.reset=function(){this.next=this.b=this.a=null};var en=!1,nn=new Ke;function rn(){for(var t;t=$e();){try{t.a.call(t.b)}catch(n){Ze(n)}var e=Je;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}en=!1}function on(t,e){ze.call(this),this.b=t||1,this.a=e||xt,this.f=Ft(this.Za,this),this.g=Mt()}function sn(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function an(t,e,n){if("function"==typeof t)n&&(t=Ft(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ft(t.handleEvent,t)}return 2147483647<Number(e)?-1:xt.setTimeout(t,e||0)}function un(t){t.a=an(function(){t.a=null,t.c&&(t.c=!1,un(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}Vt(on,ze),(Tt=on.prototype).aa=!1,Tt.M=null,Tt.Za=function(){if(this.aa){var t=Mt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),We(this,"tick"),this.aa&&(sn(this),this.start()))}},Tt.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Mt())},Tt.G=function(){on.X.G.call(this),sn(this),delete this.a};var cn=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}Ct(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:un(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(xt.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(Ut);function ln(t){Ut.call(this),this.b=t,this.a={}}Vt(ln,Ut);var hn=[];function fn(t,e,n,r){Array.isArray(n)||(n&&(hn[0]=n.toString()),n=hn);for(var i=0;i<n.length;i++){var o=De(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function dn(t){Xt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Le(t)},t),t.a={}}function pn(){this.a=!0}function yn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Qe(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}ln.prototype.G=function(){ln.X.G.call(this),dn(this)},ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pn.prototype.info=function(){};var vn={},gn=null;function mn(){return gn=gn||new ze}function _n(t){we.call(this,vn.Fa,t)}function bn(t){var e=mn();We(e,new _n(e,t))}function wn(t,e){we.call(this,vn.STAT_EVENT,t),this.stat=e}function En(t){var e=mn();We(e,new wn(e,t))}function Cn(t){we.call(this,vn.Ga,t)}function On(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return xt.setTimeout(function(){t()},e)}vn.Fa="serverreachability",Vt(_n,we),vn.STAT_EVENT="statevent",Vt(wn,we),vn.Ga="timingevent",Vt(Cn,we);var Tn={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},In={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Sn(){}function xn(){}Sn.prototype.a=null;var Nn,jn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function An(){we.call(this,"d")}function kn(){we.call(this,"c")}function Dn(){}function Pn(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ln(this),this.P=Rn,this.R=new on(t=ue?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}Vt(An,we),Vt(kn,we),Vt(Dn,Sn),Nn=new Dn;var Rn=45e3,Fn={},Ln={};function Mn(t,e,n){t.H=1,t.i=sr(tr(e)),t.j=n,t.I=!0,Vn(t,null)}function Vn(t,e){t.u=Mt(),qn(t),t.l=tr(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),_r(n.b,"t",r),t.D=0,t.a=di(t.g,t.g.C?e:null),0<t.O&&(t.F=new cn(Ft(t.Ca,t,t.a),t.O)),fn(t.J,t.a,"readystatechange",t.Xa),e=t.B?Zt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),bn(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Un(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Hn(t,n);if(i==Ln){4==e&&(t.h=4,En(14),r=!1),yn(t.c,t.f,null,"[Incomplete Response]");break}if(i==Fn){t.h=4,En(15),yn(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}yn(t.c,t.f,i,null),Qn(t,i)}4==e&&0==n.length&&(t.h=1,En(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),oi(e),e.F=!0,En(11))):(yn(t.c,t.f,n,"[Invalid Chunked Response]"),Gn(t),Wn(t))}function Hn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ln:(n=Number(e.substring(n,r)),isNaN(n)?Fn:(r+=1)+n>e.length?Ln:(e=e.substr(r,n),t.D=r+n,e))}function qn(t){t.T=Mt()+t.P,Bn(t,t.P)}function Bn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=On(Ft(t.Va,t),e)}function zn(t){t.o&&(xt.clearTimeout(t.o),t.o=null)}function Wn(t){0==t.g.v||t.A||ui(t.g,t)}function Gn(t){zn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,sn(t.R),dn(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Qn(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Ir(n.b,t)))if(n.I=t.N,!t.C&&Ir(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Zd){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;ai(n),Jr(n)}ii(n),En(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=On(Ft(n.Sa,n),6e3));if(1>=Tr(n.b)&&n.ea){try{n.ea()}catch(Zd){}n.ea=void 0}}else li(n,11)}else if((t.C||n.a==t)&&ai(n),!Wt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(Kt(l,"spdy")||Kt(l,"quic")||Kt(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(Sr(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,or(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=Mt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).la=fi(u,u.C?u.ga:null,u.fa),d.C){xr(u.b,d);var p=d,y=u.D;y&&p.setTimeout(y),p.o&&(zn(p),qn(p)),u.a=d}else ri(u);0<n.g.length&&Zr(n)}else"stop"!=i[0]&&"close"!=i[0]||li(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?li(n,7):Yr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);bn(4)}catch(Zd){}}function Kn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(jt(t)||"string"==typeof t)qt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(jt(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(jt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Yn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Yn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Jn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];$n(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)$n(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function $n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Tt=Pn.prototype).setTimeout=function(t){this.P=t},Tt.Xa=function(t){t=t.target;var e=this.F;e&&3==Wr(t)?e.f():this.Ca(t)},Tt.Ca=function(t){try{if(t==this.a)t:{var e=Wr(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!ue&&!this.a.$())){this.A||4!=e||7==n||bn(8==n||0>=r?3:2),zn(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Wt(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,En(12),Gn(this),Wn(this);break t}yn(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Qn(this,u)}this.I?(Un(this,e,o),ue&&this.b&&3==e&&(fn(this.J,this.R,"tick",this.Wa),this.R.start())):(yn(this.c,this.f,o,null),Qn(this,o)),4==e&&Gn(this),this.b&&!this.A&&(4==e?ui(this.g,this):(this.b=!1,qn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,En(12)):(this.h=0,En(13)),Gn(this),Wn(this)}}}catch(c){}},Tt.Wa=function(){if(this.a){var t=Wr(this.a),e=this.a.$();this.D<e.length&&(zn(this),Un(this,t,e),this.b&&4!=t&&qn(this))}},Tt.cancel=function(){this.A=!0,Gn(this)},Tt.Va=function(){this.o=null;var t=Mt();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(bn(3),En(17)),Gn(this),this.h=2,Wn(this)):Bn(this,this.T-t)},(Tt=Yn.prototype).K=function(){Jn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},Tt.L=function(){return Jn(this),this.a.concat()},Tt.get=function(t,e){return $n(this.b,t)?this.b[t]:e},Tt.set=function(t,e){$n(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},Tt.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Zn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Zn){this.a=void 0!==e?e:t.a,er(this,t.f),this.j=t.j,nr(this,t.c),rr(this,t.h),this.g=t.g,e=t.b;var n=new yr;n.c=e.c,e.a&&(n.a=new Yn(e.a),n.b=e.b),ir(this,n),this.i=t.i}else t&&(n=String(t).match(Xn))?(this.a=!!e,er(this,n[1]||"",!0),this.j=ar(n[2]||""),nr(this,n[3]||"",!0),rr(this,n[4]),this.g=ar(n[5]||"",!0),ir(this,n[6]||"",!0),this.i=ar(n[7]||"")):(this.a=!!e,this.b=new yr(null,this.a))}function tr(t){return new Zn(t)}function er(t,e,n){t.f=n?ar(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nr(t,e,n){t.c=n?ar(e,!0):e}function rr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function ir(t,e,n){e instanceof yr?(t.b=e,function(t,e){e&&!t.f&&(vr(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gr(this,e),_r(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=ur(e,dr)),t.b=new yr(e,t.a))}function or(t,e,n){t.b.set(e,n)}function sr(t){return or(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Mt()).toString(36)),t}function ar(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ur(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Zn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(ur(e,lr,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(ur(e,lr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(ur(n,"/"==n.charAt(0)?fr:hr,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",ur(n,pr)),t.join("")};var lr=/[#\/\?@]/g,hr=/[#\?:]/g,fr=/[#\?]/g,dr=/[#\?@]/g,pr=/#/g;function yr(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vr(t){t.a||(t.a=new Yn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function gr(t,e){vr(t),e=br(t,e),$n(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,$n((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Jn(t)))}function mr(t,e){return vr(t),e=br(t,e),$n(t.a.b,e)}function _r(t,e,n){gr(t,e),0<n.length&&(t.c=null,t.a.set(br(t,e),zt(n)),t.b+=n.length)}function br(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(Tt=yr.prototype).add=function(t,e){vr(this),this.c=null,t=br(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},Tt.forEach=function(t,e){vr(this),this.a.forEach(function(n,r){qt(n,function(n){t.call(e,n,r,this)},this)},this)},Tt.L=function(){vr(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Tt.K=function(t){vr(this);var e=[];if("string"==typeof t)mr(this,t)&&(e=Bt(e,this.a.get(br(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Bt(e,t[n])}return e},Tt.set=function(t,e){return vr(this),this.c=null,mr(this,t=br(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},Tt.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},Tt.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var wr=function(){return function(t,e){this.b=t,this.a=e}}();function Er(t){this.g=t||Cr,t=xt.PerformanceNavigationTiming?0<(t=xt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(xt.ia&&xt.ia.ya&&xt.ia.ya()&&xt.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Cr=10;function Or(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Tr(t){return t.b?1:t.a?t.a.size:0}function Ir(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Sr(t,e){t.a?t.a.add(e):t.b=e}function xr(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nr(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=Ot(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return zt(t.c)}function jr(){}function Ar(){this.a=new jr}function kr(t,e,n){var r=n||"";try{Kn(t,function(t,n){var i=t;At(t)&&(i=Qe(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Up){throw e.push(r+"type="+encodeURIComponent("_badmap")),Up}}function Dr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Er.prototype.cancel=function(){var t,e;if(this.c=Nr(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=Ot(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},jr.prototype.stringify=function(t){return xt.JSON.stringify(t,void 0)},jr.prototype.parse=function(t){return xt.JSON.parse(t,void 0)};var Pr=xt.JSON.parse;function Rr(t){ze.call(this),this.headers=new Yn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Fr,this.D=this.F=!1}Vt(Rr,ze);var Fr="",Lr=/^https?$/i,Mr=["POST","PUT"];function Vr(t){return"content-type"==t.toLowerCase()}function Ur(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Hr(t),Br(t)}function Hr(t){t.u||(t.u=!0,We(t,"complete"),We(t,"error"))}function qr(t){if(t.b&&void 0!==St&&(!t.s[1]||4!=Wr(t)||2!=t.W()))if(t.l&&4==Wr(t))an(t.za,0,t);else if(We(t,"readystatechange"),4==Wr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Xn)[1]||null;if(!o&&xt.self&&xt.self.location){var s=xt.self.location.protocol;o=s.substr(0,s.length-1)}i=!Lr.test(o?o.toLowerCase():"")}e=i}if(e)We(t,"complete"),We(t,"success");else{t.h=6;try{var a=2<Wr(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",Hr(t)}}finally{Br(t)}}}function Br(t,e){if(t.a){zr(t);var n=t.a,r=t.s[0]?Nt:null;t.a=null,t.s=null,e||We(t,"ready");try{n.onreadystatechange=r}catch(Up){}}}function zr(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(xt.clearTimeout(t.m),t.m=null)}function Wr(t){return t.a?t.a.readyState:0}function Gr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Xt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):or(t,e,n))}function Qr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Kr(t){this.pa=0,this.g=[],this.c=new pn,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Qr("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Qr("baseRetryDelayMs",5e3,t),this.Ra=Qr("retryDelaySeedMs",1e4,t),this.Ma=Qr("forwardChannelMaxRetries",2,t),this.ma=Qr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Er(t&&t.concurrentRequestLimit),this.ka=new Ar,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Yr(t){if($r(t),3==t.v){var e=t.R++,n=tr(t.B);or(n,"SID",t.J),or(n,"RID",e),or(n,"TYPE","terminate"),ei(t,n),(e=new Pn(t,t.c,e,void 0)).H=2,e.i=sr(tr(n)),n=!1,xt.navigator&&xt.navigator.sendBeacon&&(n=xt.navigator.sendBeacon(e.i.toString(),"")),!n&&xt.Image&&((new Image).src=e.i,n=!0),n||(e.a=di(e.g,null),e.a.ba(e.i)),e.u=Mt(),qn(e)}hi(t)}function Jr(t){t.a&&(oi(t),t.a.cancel(),t.a=null)}function $r(t){Jr(t),t.j&&(xt.clearTimeout(t.j),t.j=null),ai(t),t.b.cancel(),t.h&&("number"==typeof t.h&&xt.clearTimeout(t.h),t.h=null)}function Xr(t,e){t.g.push(new wr(t.Oa++,e)),3==t.v&&Zr(t)}function Zr(t){Or(t.b)||t.h||(t.h=!0,tn(t.Ba,t),t.u=0)}function ti(t,e){var n;n=e?e.f:t.R++;var r=tr(t.B);or(r,"SID",t.J),or(r,"RID",n),or(r,"AID",t.P),ei(t,r),t.i&&t.l&&Gr(r,t.i,t.l),n=new Pn(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ni(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Sr(t.b,n),Mn(n,r,e)}function ei(t,e){t.f&&Kn({},function(t,n){or(e,n,t)})}function ni(t,e,n){n=Math.min(t.g.length,n);var r=t.f?Ft(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{kr(l,s,"req"+c+"_")}catch(Yi){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ri(t){t.a||t.j||(t.T=1,tn(t.Aa,t),t.o=0)}function ii(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=On(Ft(t.Aa,t),ci(t,t.o)),t.o++,0))}function oi(t){null!=t.s&&(xt.clearTimeout(t.s),t.s=null)}function si(t){t.a=new Pn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tr(t.la);or(e,"RID","rpc"),or(e,"SID",t.J),or(e,"CI",t.H?"0":"1"),or(e,"AID",t.P),ei(t,e),or(e,"TYPE","xmlhttp"),t.i&&t.l&&Gr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sr(tr(e)),n.j=null,n.I=!0,Vn(n,t)}function ai(t){null!=t.m&&(xt.clearTimeout(t.m),t.m=null)}function ui(t,e){var n=null;if(t.a==e){ai(t),oi(t),t.a=null;var r=2}else{if(!Ir(t.b,e))return;n=e.s,xr(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=Mt()-e.u;var i=t.u;We(r=mn(),new Cn(r,n,e,i)),Zr(t)}else ri(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Tr(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=On(Ft(t.Ba,t,e),ci(t,t.u)),t.u++,0)))}(t,e)||2==r&&ii(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:li(t,5);break;case 4:li(t,10);break;case 3:li(t,6);break;default:li(t,2)}}function ci(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function li(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=Ft(t.Ya,t);n||(n=new Zn("//www.google.com/images/cleardot.gif"),xt.location&&"http"==xt.location.protocol||er(n,"https"),sr(n)),function(t,e){var n=new pn;if(xt.Image){var r=new Image;r.onload=Lt(Dr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Lt(Dr,n,r,"TestLoadImage: error",!1,e),r.onabort=Lt(Dr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Lt(Dr,n,r,"TestLoadImage: timeout",!1,e),xt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else En(2);t.v=0,t.f&&t.f.ra(e),hi(t),$r(t)}function hi(t){t.v=0,t.I=-1,t.f&&(0==Nr(t.b).length&&0==t.g.length||(t.b.c.length=0,zt(t.g),t.g.length=0),t.f.qa())}function fi(t,e,n){var r=function(t){return t instanceof Zn?tr(t):new Zn(t,void 0)}(n);if(""!=r.c)e&&nr(r,e+"."+r.c),rr(r,r.h);else{var i=xt.location;r=function(t,e,n,r){var i=new Zn(null,void 0);return t&&er(i,t),e&&nr(i,e),n&&rr(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Xt(t.V,function(t,e){or(r,e,t)}),n=t.na,(e=t.A)&&n&&or(r,e,n),or(r,"VER",t.ha),ei(t,r),r}function di(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rr(t.Na)).F=t.C,e}function pi(){}function yi(){if(se&&!(10<=Number(ge)))throw Error("Environmental error: no available transport.")}function vi(t,e){ze.call(this),this.a=new Kr(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Wt(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Wt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new _i(this)}function gi(t){An.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mi(){kn.call(this),this.status=1}function _i(t){this.a=t}(Tt=Rr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:Nn),this.a.onreadystatechange=Ft(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Ur(this,o)}t=n||"";var i=new Yn(this.headers);r&&Kn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Vr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=xt.FormData&&t instanceof xt.FormData,!(0<=Ht(Mr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{zr(this),0<this.o&&((this.D=function(t){return se&&ve(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=Ft(this.xa,this)):this.m=an(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Ur(this,o)}},Tt.xa=function(){void 0!==St&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,We(this,"timeout"),this.abort(8))},Tt.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,We(this,"complete"),We(this,"abort"),Br(this))},Tt.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Br(this,!0)),Rr.X.G.call(this)},Tt.za=function(){this.j||(this.A||this.l||this.g?qr(this):this.Ua())},Tt.Ua=function(){qr(this)},Tt.W=function(){try{return 2<Wr(this)?this.a.status:-1}catch(ie){return-1}},Tt.$=function(){try{return this.a?this.a.responseText:""}catch(ie){return""}},Tt.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pr(e)}},Tt.ua=function(){return this.h},Tt.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(Tt=Kr.prototype).ha=8,Tt.v=1,Tt.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Pn(this,this.c,t,void 0),r=this.l;if(this.O&&(r?ee(r=Zt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=ni(this,n,e),or(i=tr(this.B),"RID",t),or(i,"CVER",22),this.A&&or(i,"X-HTTP-Session-Id",this.A),ei(this,i),this.i&&r&&Gr(i,this.i,r),Sr(this.b,n),this.Ia&&or(i,"TYPE","init"),this.da?(or(i,"$req",e),or(i,"SID","null"),n.U=!0,Mn(n,i,null)):Mn(n,i,e),this.v=2}}else 3==this.v&&(t?ti(this,t):0==this.g.length||Or(this.b)||ti(this))},Tt.Aa=function(){if(this.j=null,si(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=On(Ft(this.Ta,this),t)}},Tt.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,En(10),Jr(this),si(this))},Tt.Sa=function(){null!=this.m&&(this.m=null,Jr(this),ii(this),En(19))},Tt.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),En(2)):(this.c.info("Failed to ping google.com"),En(1))},(Tt=pi.prototype).ta=function(){},Tt.sa=function(){},Tt.ra=function(){},Tt.qa=function(){},Tt.Ja=function(){},yi.prototype.a=function(t,e){return new vi(t,e)},Vt(vi,ze),vi.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;En(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=fi(t,null,t.fa),Zr(t)},vi.prototype.close=function(){Yr(this.a)},vi.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Xr(this.a,e)}else this.l?((e={}).__data__=Qe(t),Xr(this.a,e)):Xr(this.a,t)},vi.prototype.G=function(){this.a.f=null,delete this.f,Yr(this.a),delete this.a,vi.X.G.call(this)},Vt(gi,An),Vt(mi,kn),Vt(_i,pi),_i.prototype.ta=function(){We(this.a,"a")},_i.prototype.sa=function(t){We(this.a,new gi(t))},_i.prototype.ra=function(t){We(this.a,new mi(t))},_i.prototype.qa=function(){We(this.a,"b")},yi.prototype.createWebChannel=yi.prototype.a,vi.prototype.send=vi.prototype.h,vi.prototype.open=vi.prototype.g,vi.prototype.close=vi.prototype.close,Tn.NO_ERROR=0,Tn.TIMEOUT=8,Tn.HTTP_ERROR=6,In.COMPLETE="complete",xn.EventType=jn,jn.OPEN="a",jn.CLOSE="b",jn.ERROR="c",jn.MESSAGE="d",ze.prototype.listen=ze.prototype.va,Rr.prototype.listenOnce=Rr.prototype.wa,Rr.prototype.getLastError=Rr.prototype.Qa,Rr.prototype.getLastErrorCode=Rr.prototype.ua,Rr.prototype.getStatus=Rr.prototype.W,Rr.prototype.getResponseJson=Rr.prototype.Pa,Rr.prototype.getResponseText=Rr.prototype.$,Rr.prototype.send=Rr.prototype.ba;var bi=Tn,wi=In,Ei=vn,Ci=xn,Oi=Rr,Ti=n("mAIw"),Ii=new wt.b("@firebase/firestore");function Si(){return Ii.logLevel}function xi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ii.logLevel<=wt.a.DEBUG){var r=e.map(Ai);Ii.debug.apply(Ii,Object(Ti.g)(["Firestore (8.2.1): "+t],r))}}function Ni(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ii.logLevel<=wt.a.ERROR){var r=e.map(Ai);Ii.error.apply(Ii,Object(Ti.g)(["Firestore (8.2.1): "+t],r))}}function ji(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ii.logLevel<=wt.a.WARN){var r=e.map(Ai);Ii.warn.apply(Ii,Object(Ti.g)(["Firestore (8.2.1): "+t],r))}}function Ai(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Up){return t}}function ki(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.1) INTERNAL ASSERTION FAILED: "+t;throw Ni(e),new Error(e)}function Di(t,e){t||ki()}function Pi(t,e){return t}function Ri(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Fi=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Ri(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Li(t,e){return t<e?-1:t>e?1:0}function Mi(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Vi(t){return t+"\0"}var Ui=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return Li(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();Ui.h=new Ui("");var Hi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qi=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Ti.c)(e,t),e}(Error),Bi=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(Ui.fromBase64String(e))}catch(e){throw new qi(Hi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ui.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),zi=function(t){this._=t};function Wi(){if("undefined"==typeof Uint8Array)throw new qi(Hi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Gi(){if("undefined"==typeof atob)throw new qi(Hi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.fromBase64String=function(t){return Gi(),new e(Bi.fromBase64String(t))},e.fromUint8Array=function(t){return Wi(),new e(Bi.fromUint8Array(t))},e.prototype.toBase64=function(){return Gi(),this._.toBase64()},e.prototype.toUint8Array=function(){return Wi(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(zi),Ki=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Yi=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Ji=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Ji.UNAUTHENTICATED=new Ji(null),Ji.P=new Ji("google-credentials-uid"),Ji.g=new Ji("first-party-uid");var $i=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},Xi=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(Ji.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),Zi=function(){function t(t){var e=this;this.C=null,this.currentUser=Ji.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.F,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.F!==e?(xi("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Di("string"==typeof n.accessToken),new $i(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Di(null===t||"string"==typeof t),new Ji(t)},t}(),to=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Ji.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),eo=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new to(this.k,this.M))},t.prototype.S=function(t){t(Ji.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),no=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();no.U=-1;var ro=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new qi(Hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new qi(Hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qi(Hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qi(Hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?Li(this.nanoseconds,t.nanoseconds):Li(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),io=function(){function t(t){this.timestamp=t}return t.W=function(e){return new t(e)},t.min=function(){return new t(new ro(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),oo=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ki(),void 0===n?n=t.length-e:n>t.length-e&&ki(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),so=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new qi(Hi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(oo),ao=/^[_a-zA-Z][_a-zA-Z0-9]*$/,uo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return ao.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new qi(Hi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new qi(Hi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qi(Hi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new qi(Hi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(oo),co=function(){function t(t){this.path=t}return t.ft=function(e){return new t(so.ct(e))},t.dt=function(e){return new t(so.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===so.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return so.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new so(e.slice()))},t}();function lo(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ho(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var po=function(){function t(t){this.fields=t,t.sort(uo.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return Mi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(t){if(Di(!!t),"string"==typeof t){var e=0,n=yo.exec(t);if(Di(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:go(t.seconds),nanos:go(t.nanos)}}function go(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function mo(t){return"string"==typeof t?Ui.fromBase64String(t):Ui.fromUint8Array(t)}function _o(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bo(t){var e=t.mapValue.fields.__previous_value__;return _o(e)?bo(e):e}function wo(t){var e=vo(t.mapValue.fields.__local_write_time__.timestampValue);return new ro(e.seconds,e.nanos)}function Eo(t){return null==t}function Co(t){return 0===t&&1/t==-1/0}function Oo(t){return"number"==typeof t&&Number.isInteger(t)&&!Co(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function To(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_o(t)?4:10:ki()}function Io(t,e){var n=To(t);if(n!==To(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return wo(t).isEqual(wo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=vo(t.timestampValue),r=vo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return mo(t.bytesValue).isEqual(mo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return go(t.geoPointValue.latitude)===go(e.geoPointValue.latitude)&&go(t.geoPointValue.longitude)===go(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return go(t.integerValue)===go(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=go(t.doubleValue),r=go(e.doubleValue);return n===r?Co(n)===Co(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Mi(t.arrayValue.values||[],e.arrayValue.values||[],Io);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(lo(n)!==lo(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Io(n[i],r[i])))return!1;return!0}(t,e);default:return ki()}}function So(t,e){return void 0!==(t.values||[]).find(function(t){return Io(t,e)})}function xo(t,e){var n=To(t),r=To(e);if(n!==r)return Li(n,r);switch(n){case 0:return 0;case 1:return Li(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=go(t.integerValue||t.doubleValue),r=go(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return No(t.timestampValue,e.timestampValue);case 4:return No(wo(t),wo(e));case 5:return Li(t.stringValue,e.stringValue);case 6:return function(t,e){var n=mo(t),r=mo(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Li(n[i],r[i]);if(0!==o)return o}return Li(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Li(go(t.latitude),go(e.latitude));return 0!==n?n:Li(go(t.longitude),go(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=xo(n[i],r[i]);if(o)return o}return Li(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Li(r[s],o[s]);if(0!==a)return a;var u=xo(n[r[s]],i[o[s]]);if(0!==u)return u}return Li(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ki()}}function No(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Li(t,e);var n=vo(t),r=vo(e),i=Li(n.seconds,r.seconds);return 0!==i?i:Li(n.nanos,r.nanos)}function jo(t){return Ao(t)}function Ao(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=vo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?mo(t.bytesValue).toBase64():"referenceValue"in t?co.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ao(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ao(t.fields[o])}return e+"}"}(t.mapValue):ki();var e}function ko(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Do(t){return!!t&&"integerValue"in t}function Po(t){return!!t&&"arrayValue"in t}function Ro(t){return!!t&&"nullValue"in t}function Fo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lo(t){return!!t&&"mapValue"in t}var Mo=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Lo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return Io(this.proto,t.proto)},t}(),Vo=function(){function t(t){void 0===t&&(t=Mo.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===To(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(uo.at(),this.Rt);return null!=t?new Mo(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=Lo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Uo(t){var e=[];return ho(t.fields||{},function(t,n){var r=new uo([t]);if(Lo(n)){var i=Uo(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new po(e)}var Ho=function(t,e){this.key=t,this.version=e},qo=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(Ti.c)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Ho),Bo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(Ti.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ho),zo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ho),Wo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Go(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Wo(t,e,n,r,i,o,s)}function Qo(t){var e=Pi(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+jo(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),Eo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ss(e.startAt)),e.endAt&&(n+="|ub:",n+=ss(e.endAt)),e.St=n}return e.St}function Ko(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!us(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Io(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ls(t.startAt,e.startAt)&&ls(t.endAt,e.endAt)}function Yo(t){return co.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Jo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(Ti.c)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new $o(t,n,r):"array-contains"===n?new es(t,r):"in"===n?new ns(t,r):"not-in"===n?new rs(t,r):"array-contains-any"===n?new is(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new Xo(t,n):new Zo(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(xo(e,this.value)):null!==e&&To(this.value)===To(e)&&this.Ct(xo(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ki()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),$o=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=co.dt(r.referenceValue),i}return Object(Ti.c)(e,t),e.prototype.matches=function(t){var e=co.J(t.key,this.key);return this.Ct(e)},e}(Jo),Xo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ts(0,n),r}return Object(Ti.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Jo),Zo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ts(0,n),r}return Object(Ti.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Jo);function ts(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return co.dt(t.referenceValue)})}var es=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(Ti.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Po(e)&&So(e.arrayValue,this.value)},e}(Jo),ns=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(Ti.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&So(this.value.arrayValue,e)},e}(Jo),rs=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(Ti.c)(e,t),e.prototype.matches=function(t){if(So(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!So(this.value.arrayValue,e)},e}(Jo),is=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(Ti.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Po(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return So(e.value.arrayValue,t)})},e}(Jo),os=function(t,e){this.position=t,this.before=e};function ss(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return jo(t)}).join(",")}var as=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function us(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function cs(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?co.J(co.dt(s.referenceValue),n.key):xo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ls(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Io(t.position[n],e.position[n]))return!1;return!0}var hs=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.Ft=null,this.Ot=null};function fs(t,e,n,r,i,o,s,a){return new hs(t,e,n,r,i,o,s,a)}function ds(t){return new hs(t)}function ps(t){return!Eo(t.limit)&&"F"===t.limitType}function ys(t){return!Eo(t.limit)&&"L"===t.limitType}function vs(t){return t.Nt.length>0?t.Nt[0].field:null}function gs(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function ms(t){return null!==t.collectionGroup}function _s(t){var e=Pi(t);if(null===e.Ft){e.Ft=[];var n=gs(e),r=vs(e);if(null!==n&&null===r)n.ht()||e.Ft.push(new as(n)),e.Ft.push(new as(uo.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var a=s[o];e.Ft.push(a),a.field.ht()&&(i=!0)}if(!i){var u=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ft.push(new as(uo.lt(),u))}}}return e.Ft}function bs(t){var e=Pi(t);if(!e.Ot)if("F"===e.limitType)e.Ot=Go(e.path,e.collectionGroup,_s(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=_s(e);r<i.length;r++){var o=i[r];n.push(new as(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new os(e.endAt.position,!e.endAt.before):null,a=e.startAt?new os(e.startAt.position,!e.startAt.before):null;e.Ot=Go(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.Ot}function ws(t,e,n){return new hs(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Es(t,e){return Ko(bs(t),bs(e))&&t.limitType===e.limitType}function Cs(t){return Qo(bs(t))+"|lt:"+t.limitType}function Os(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+jo(e.value);var e}).join(", ")+"]"),Eo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ss(t.startAt)),t.endAt&&(e+=", endAt: "+ss(t.endAt)),"Target("+e+")"}(bs(t))+"; limitType="+t.limitType+")"}function Ts(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):co.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!cs(t.startAt,_s(t),e)||t.endAt&&cs(t.endAt,_s(t),e))}(t,e)}function Is(t){return function(e,n){for(var r=!1,i=0,o=_s(t);i<o.length;i++){var s=o[i],a=Ss(s,e,n);if(0!==a)return a;r=r||s.field.ht()}return 0}}function Ss(t,e,n){var r=t.field.ht()?co.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?xo(r,i):ki()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ki()}}var xs=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=io.min()),void 0===o&&(o=io.min()),void 0===s&&(s=Ui.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function Ns(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Co(e)?"-0":e}}function js(t){return{integerValue:""+t}}function As(t,e){return Oo(e)?js(e):Ns(t,e)}var ks=function(){this.Ut=void 0};function Ds(t,e,n){return t instanceof Fs?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ls?Ms(t,e):t instanceof Vs?Us(t,e):function(t,e){var n=Rs(t,e),r=qs(n)+qs(t.Qt);return Do(n)&&Do(t.Qt)?js(r):Ns(t.Kt,r)}(t,e)}function Ps(t,e,n){return t instanceof Ls?Ms(t,e):t instanceof Vs?Us(t,e):n}function Rs(t,e){return t instanceof Hs?Do(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Fs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e}(ks),Ls=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Ti.c)(e,t),e}(ks);function Ms(t,e){for(var n=Bs(e),r=function(t){n.some(function(e){return Io(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Vs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Ti.c)(e,t),e}(ks);function Us(t,e){for(var n=Bs(e),r=function(t){n=n.filter(function(e){return!Io(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Hs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object(Ti.c)(e,t),e}(ks);function qs(t){return go(t.integerValue||t.doubleValue)}function Bs(t){return Po(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var zs=function(t,e){this.field=t,this.transform=e},Ws=function(t,e){this.version=t,this.transformResults=e},Gs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Wt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Qs(t,e){return void 0!==t.updateTime?e instanceof qo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof qo}var Ks=function(){};function Ys(t,e,n){return t instanceof ta?function(t,e,n){var r=t.value;if(n.transformResults){var i=ra(t.fieldTransforms,e,n.transformResults);r=oa(t.fieldTransforms,r,i)}return new qo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof ea?function(t,e,n){if(!Qs(t.Gt,e))return new zo(t.key,n.version);var r=na(t,e,n.transformResults?ra(t.fieldTransforms,e,n.transformResults):[]);return new qo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Bo(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Js(t,e,n,r){return t instanceof ta?function(t,e,n,r){if(!Qs(t.Gt,e))return e;var i=t.value;if(t.fieldTransforms){var o=ia(t.fieldTransforms,n,e,r);i=oa(t.fieldTransforms,i,o)}var s=Zs(e);return new qo(t.key,s,i,{bt:!0})}(t,e,r,n):t instanceof ea?function(t,e,n,r){if(!Qs(t.Gt,e))return e;var i=Zs(e),o=na(t,e,ia(t.fieldTransforms,n,e,r));return new qo(t.key,i,o,{bt:!0})}(t,e,r,n):function(t,e){return Qs(t.Gt,e)?new Bo(t.key,io.min()):e}(t,e)}function $s(t,e){return void 0!==t.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof qo?e.field(o.field):void 0,a=Rs(o.transform,s||null);null!=a&&(n=null==n?(new Vo).set(o.field,a):n.set(o.field,a))}return n?n.yt():null}(t.fieldTransforms,e):null}function Xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Mi(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ls&&e instanceof Ls||t instanceof Vs&&e instanceof Vs?Mi(t.elements,e.elements,Io):t instanceof Hs&&e instanceof Hs?Io(t.Qt,e.Qt):t instanceof Fs&&e instanceof Fs}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Zs(t){return t instanceof qo?t.version:io.min()}var ta=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object(Ti.c)(e,t),e}(Ks),ea=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object(Ti.c)(e,t),e}(Ks);function na(t,e,n){var r;return r=function(t,e){var n=new Vo(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof qo?e.data():Mo.empty()),oa(t.fieldTransforms,r,n)}function ra(t,e,n){var r=[];Di(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof qo&&(a=e.field(o.field)),r.push(Ps(s,a,n[i]))}return r}function ia(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=null;n instanceof qo&&(c=n.field(a.field)),null===c&&r instanceof qo&&(c=r.field(a.field)),i.push(Ds(u,c,e))}return i}function oa(t,e,n){for(var r=new Vo(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var sa,aa,ua=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object(Ti.c)(e,t),e}(Ks),ca=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object(Ti.c)(e,t),e}(Ks),la=function(t){this.count=t};function ha(t){switch(t){case Hi.OK:return ki();case Hi.CANCELLED:case Hi.UNKNOWN:case Hi.DEADLINE_EXCEEDED:case Hi.RESOURCE_EXHAUSTED:case Hi.INTERNAL:case Hi.UNAVAILABLE:case Hi.UNAUTHENTICATED:return!1;case Hi.INVALID_ARGUMENT:case Hi.NOT_FOUND:case Hi.ALREADY_EXISTS:case Hi.PERMISSION_DENIED:case Hi.FAILED_PRECONDITION:case Hi.ABORTED:case Hi.OUT_OF_RANGE:case Hi.UNIMPLEMENTED:case Hi.DATA_LOSS:return!0;default:return ki()}}function fa(t){if(void 0===t)return Ni("GRPC error has no .code"),Hi.UNKNOWN;switch(t){case sa.OK:return Hi.OK;case sa.CANCELLED:return Hi.CANCELLED;case sa.UNKNOWN:return Hi.UNKNOWN;case sa.DEADLINE_EXCEEDED:return Hi.DEADLINE_EXCEEDED;case sa.RESOURCE_EXHAUSTED:return Hi.RESOURCE_EXHAUSTED;case sa.INTERNAL:return Hi.INTERNAL;case sa.UNAVAILABLE:return Hi.UNAVAILABLE;case sa.UNAUTHENTICATED:return Hi.UNAUTHENTICATED;case sa.INVALID_ARGUMENT:return Hi.INVALID_ARGUMENT;case sa.NOT_FOUND:return Hi.NOT_FOUND;case sa.ALREADY_EXISTS:return Hi.ALREADY_EXISTS;case sa.PERMISSION_DENIED:return Hi.PERMISSION_DENIED;case sa.FAILED_PRECONDITION:return Hi.FAILED_PRECONDITION;case sa.ABORTED:return Hi.ABORTED;case sa.OUT_OF_RANGE:return Hi.OUT_OF_RANGE;case sa.UNIMPLEMENTED:return Hi.UNIMPLEMENTED;case sa.DATA_LOSS:return Hi.DATA_LOSS;default:return ki()}}(aa=sa||(sa={}))[aa.OK=0]="OK",aa[aa.CANCELLED=1]="CANCELLED",aa[aa.UNKNOWN=2]="UNKNOWN",aa[aa.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",aa[aa.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",aa[aa.NOT_FOUND=5]="NOT_FOUND",aa[aa.ALREADY_EXISTS=6]="ALREADY_EXISTS",aa[aa.PERMISSION_DENIED=7]="PERMISSION_DENIED",aa[aa.UNAUTHENTICATED=16]="UNAUTHENTICATED",aa[aa.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",aa[aa.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",aa[aa.ABORTED=10]="ABORTED",aa[aa.OUT_OF_RANGE=11]="OUT_OF_RANGE",aa[aa.UNIMPLEMENTED=12]="UNIMPLEMENTED",aa[aa.INTERNAL=13]="INTERNAL",aa[aa.UNAVAILABLE=14]="UNAVAILABLE",aa[aa.DATA_LOSS=15]="DATA_LOSS";var da=function(){function t(t,e){this.J=t,this.root=e||ya.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,ya.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,ya.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new pa(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new pa(this.root,t,this.J,!1)},t.prototype.se=function(){return new pa(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new pa(this.root,t,this.J,!0)},t}(),pa=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),ya=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw ki();if(this.right._e())throw ki();var t=this.left.me();if(t!==this.right.me())throw ki();return t+(this._e()?0:1)},t}();ya.EMPTY=null,ya.RED=!0,ya.Jt=!1,ya.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ki()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ki()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ki()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ki()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ki()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new ya(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var va=function(){function t(t){this.J=t,this.data=new da(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new ga(this.data.ee())},t.prototype.ne=function(t){return new ga(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),ga=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),ma=new da(co.J);function _a(){return ma}function ba(){return _a()}var wa=new da(co.J);function Ea(){return wa}var Ca=new da(co.J);function Oa(){return Ca}var Ta=new va(co.J);function Ia(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ta,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Sa=new va(Li);function xa(){return Sa}var Na=function(){function t(t){this.J=t?function(e,n){return t(e,n)||co.J(e.key,n.key)}:function(t,e){return co.J(t.key,e.key)},this.Ve=Ea(),this.pe=new da(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),ja=function(){function t(){this.ve=new da(co.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):ki():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),Aa=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=a}return t.Fe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Na.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&Es(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ka=function(){function t(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,Da.Be(e,n)),new t(io.min(),r,xa(),_a(),Ia())},t}(),Da=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(Ui.h,n,Ia(),Ia(),Ia())},t}(),Pa=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},Ra=function(t,e){this.targetId=t,this.Ge=e},Fa=function(t,e,n,r){void 0===n&&(n=Ui.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},La=function(){function t(){this.ze=0,this.He=Ua(),this.Je=Ui.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=Ia(),e=Ia(),n=Ia();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ki()}}),new Da(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=Ua()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),Ma=function(){function t(t){this.hn=t,this.ln=new Map,this._n=_a(),this.fn=Va(),this.dn=new va(Li)}return t.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof qo?this.En(r,t.je):t.je instanceof Bo&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.je)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:ki()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(Yo(i))if(0===n){var o=new co(i.path);this.Tn(e,o,new Bo(o,io.min()))}else Di(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&Yo(o.target)){var s=new co(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new Bo(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=Ia();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new ka(t,n,this.dn,this._n,r);return this._n=_a(),this.fn=Va(),this.dn=new va(Li),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new La,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new va(Li),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||xi("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new La),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function Va(){return new da(co.J)}function Ua(){return new da(co.J)}var Ha={asc:"ASCENDING",desc:"DESCENDING"},qa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ba=function(t,e){this.T=t,this.qt=e};function za(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Wa(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Ga(t,e){return za(t,e.G())}function Qa(t){return Di(!!t),io.W(function(t){var e=vo(t);return new ro(e.seconds,e.nanos)}(t))}function Ka(t,e){return function(t){return new so(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function Ya(t){var e=so.ct(t);return Di(_u(e)),e}function Ja(t,e){return Ka(t.T,e.path)}function $a(t,e){var n=Ya(e);if(n.get(1)!==t.T.projectId)throw new qi(Hi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new qi(Hi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new co(eu(n))}function Xa(t,e){return Ka(t.T,e)}function Za(t){var e=Ya(t);return 4===e.length?so.at():eu(e)}function tu(t){return new so(["projects",t.T.projectId,"databases",t.T.database]).ot()}function eu(t){return Di(t.length>4&&"documents"===t.get(4)),t.X(5)}function nu(t,e,n){return{name:Ja(t,e),fields:n.proto.mapValue.fields}}function ru(t,e,n){var r=$a(t,e.name),i=Qa(e.updateTime),o=new Mo({mapValue:{fields:e.fields}});return new qo(r,i,o,{hasCommittedMutations:!!n})}function iu(t,e){var n;if(e instanceof ta)n={update:nu(t,e.key,e.value)};else if(e instanceof ua)n={delete:Ja(t,e.key)};else if(e instanceof ea)n={update:nu(t,e.key,e.data),updateMask:mu(e.zt)};else{if(!(e instanceof ca))return ki();n={verify:Ja(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Fs)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ls)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof Vs)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof Hs)return{fieldPath:e.field.ot(),increment:n.Qt};throw ki()}(0,t)})),e.Gt.jt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ga(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ki()}(t,e.Gt)),n}function ou(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Gs.updateTime(Qa(t.updateTime)):void 0!==t.exists?Gs.exists(t.exists):Gs.Wt()}(e.currentDocument):Gs.Wt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Di("REQUEST_TIME"===e.setToServerValue),n=new Fs):"appendMissingElements"in e?n=new Ls(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Vs(e.removeAllFromArray.values||[]):"increment"in e?n=new Hs(t,e.increment):ki();var r=uo._t(e.fieldPath);return new zs(r,n)}(t,e)}):[];if(e.update){var i=$a(t,e.update.name),o=new Mo({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new po((t.fieldPaths||[]).map(function(t){return uo._t(t)}))}(e.updateMask);return new ea(i,o,s,n,r)}return new ta(i,o,n,r)}if(e.delete){var a=$a(t,e.delete);return new ua(a,n)}if(e.verify){var u=$a(t,e.verify);return new ca(u,n)}return ki()}function su(t,e){return{documents:[Xa(t,e.path)]}}function au(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xa(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xa(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Fo(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NAN"}};if(Ro(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Fo(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NOT_NAN"}};if(Ro(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pu(t.field),op:du(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:pu(t.field),direction:fu(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||Eo(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=lu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=lu(e.endAt)),n}function uu(t){var e=Za(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Di(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=cu(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new as(yu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return Eo(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=hu(n.startAt));var l=null;return n.endAt&&(l=hu(n.endAt)),fs(e,i,a,s,u,"F",c,l)}function cu(t){return t?void 0!==t.unaryFilter?[gu(t)]:void 0!==t.fieldFilter?[vu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return cu(t)}).reduce(function(t,e){return t.concat(e)}):ki():[]}function lu(t){return{before:t.before,values:t.position}}function hu(t){return new os(t.values||[],!!t.before)}function fu(t){return Ha[t]}function du(t){return qa[t]}function pu(t){return{fieldPath:t.ot()}}function yu(t){return uo._t(t.fieldPath)}function vu(t){return Jo.create(yu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ki()}}(t.fieldFilter.op),t.fieldFilter.value)}function gu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=yu(t.unaryFilter.field);return Jo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=yu(t.unaryFilter.field);return Jo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=yu(t.unaryFilter.field);return Jo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=yu(t.unaryFilter.field);return Jo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ki()}}function mu(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function _u(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var bu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},wu=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Fn&&ki(),this.Fn=!0,this.Nn?this.error?this.On(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.On(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.On=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),Eu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new bu,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new Tu(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=ju(e.target.error);n.qn.reject(new Tu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Tu(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(xi("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Su(e)},t}(),Cu=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(Et.m)())&&Ni("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return xi("SimpleDb","Removing database:",t),xu(window.indexedDB.deleteDatabase(t)).Mn()},t.Wn=function(){if("undefined"==typeof indexedDB)return!1;if(t.jn())return!0;var e=Object(Et.m)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.jn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object(Ti.b)(this,void 0,void 0,function(){var e,n=this;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(xi("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Tu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new qi(Hi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Tu(t,n))},i.onupgradeneeded=function(t){xi("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){xi("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(Ti.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(Ti.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,l;return Object(Ti.d)(this,function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.Jn(t)];case 2:return a.db=h.sent(),e=Eu.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),wu.reject(t)}).Mn(),u={},s.catch(function(){}),[4,e.Un];case 3:return[2,(u.value=(h.sent(),s),u)];case 4:return xi("SimpleDb","Transaction failed with error:",(c=h.sent()).message,"Retrying:",l="FirebaseError"!==c.name&&o<3),a.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Ou=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return xu(this.ts.delete())},t}(),Tu=function(t){function e(e,n){var r=this;return(r=t.call(this,Hi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Ti.c)(e,t),e}(qi);function Iu(t){return"IndexedDbTransactionError"===t.name}var Su=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(xi("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(xi("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),xu(n)},t.prototype.add=function(t){return xi("SimpleDb","ADD",this.store.name,t,t),xu(this.store.add(t))},t.prototype.get=function(t){var e=this;return xu(this.store.get(t)).next(function(n){return void 0===n&&(n=null),xi("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return xi("SimpleDb","DELETE",this.store.name,t),xu(this.store.delete(t))},t.prototype.count=function(){return xi("SimpleDb","COUNT",this.store.name),xu(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){xi("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new wu(function(n,r){e.onerror=function(t){var e=ju(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new wu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ou(i),s=e(i.primaryKey,i.value,o);if(s instanceof wu){var a=s.catch(function(t){return o.done(),wu.reject(t)});n.push(a)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return wu.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function xu(t){return new wu(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=ju(t.target.error);n(e)}})}var Nu=!1;function ju(t){var e=Cu.Kn(Object(Et.m)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new qi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Nu||(Nu=!0,setTimeout(function(){throw r},0)),r}}return t}var Au=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new bu,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new qi(Hi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function ku(t,e){if(Ni("AsyncQueue",e+": "+t),Iu(t))return new qi(Hi.UNAVAILABLE,e+": "+t);throw t}var Du=function(t,e){this.progress=t,this.gs=e},Pu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ru=function(){function t(){this.Vs=[]}return t.prototype.ps=function(t){this.Vs.push(t)},t.prototype.bs=function(){this.Vs.forEach(function(t){return t()})},t}();function Fu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Mu(e)),e=Lu(t.get(n),e);return Mu(e)}function Lu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Mu(t){return t+"\x01\x01"}function Vu(t){var e=t.length;if(Di(e>=2),2===e)return Di("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),so.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&ki(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:ki()}o=s+2}return new so(r)}var Uu=function(t,e){this.seconds=t,this.nanoseconds=e},Hu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Hu.store="owner",Hu.key="owner";var qu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};qu.store="mutationQueues",qu.keyPath="userId";var Bu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Bu.store="mutations",Bu.keyPath="batchId",Bu.userMutationsIndex="userMutationsIndex",Bu.userMutationsKeyPath=["userId","batchId"];var zu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Fu(e)]},t.key=function(t,e,n){return[t,Fu(e),n]},t}();zu.store="documentMutations",zu.PLACEHOLDER=new zu;var Wu=function(t,e){this.path=t,this.readTime=e},Gu=function(t,e){this.path=t,this.version=e},Qu=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Qu.store="remoteDocuments",Qu.readTimeIndex="readTimeIndex",Qu.readTimeIndexPath="readTime",Qu.collectionReadTimeIndex="collectionReadTimeIndex",Qu.collectionReadTimeIndexPath=["parentPath","readTime"];var Ku=function(t){this.byteSize=t};Ku.store="remoteDocumentGlobal",Ku.key="remoteDocumentGlobalKey";var Yu=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Yu.store="targets",Yu.keyPath="targetId",Yu.queryTargetsIndexName="queryTargetsIndex",Yu.queryTargetsKeyPath=["canonicalId","targetId"];var Ju=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ju.store="targetDocuments",Ju.keyPath=["targetId","path"],Ju.documentTargetsIndex="documentTargetsIndex",Ju.documentTargetsKeyPath=["path","targetId"];var $u=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};$u.key="targetGlobalKey",$u.store="targetGlobal";var Xu=function(t,e){this.collectionId=t,this.parent=e};Xu.store="collectionParents",Xu.keyPath=["collectionId","parent"];var Zu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Zu.store="clientMetadata",Zu.keyPath="clientId";var tc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};tc.store="bundles",tc.keyPath="bundleId";var ec=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ec.store="namedQueries",ec.keyPath="name";var nc=Object(Ti.g)(Object(Ti.g)(Object(Ti.g)(Object(Ti.g)([qu.store,Bu.store,zu.store,Qu.store,Yu.store,Hu.store,$u.store,Ju.store],[Zu.store]),[Ku.store]),[Xu.store]),[tc.store,ec.store]),rc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).vs=e,r.Ss=n,r}return Object(Ti.c)(e,t),e}(Ru);function ic(t,e){var n=Pi(t);return Cu.Hn(n.vs,e)}var oc=function(){function t(t,e,n,r){this.batchId=t,this.Ds=e,this.baseMutations=n,this.mutations=r}return t.prototype.Cs=function(t,e,n){for(var r=n.xs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ys(o,e,r[i]))}return e},t.prototype.Ns=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Js(i,e,e,this.Ds))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=Js(u,e,o,this.Ds))}return e},t.prototype.Fs=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.Ns(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ia())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mi(this.mutations,t.mutations,function(t,e){return Xs(t,e)})&&Mi(this.baseMutations,t.baseMutations,function(t,e){return Xs(t,e)})},t}(),sc=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.xs=n,this.ks=r}return t.from=function(e,n,r){Di(e.mutations.length===r.length);for(var i=Oa(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ac=function(t){this.Ms=t};function uc(t,e){if(e.document)return ru(t.Ms,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=co.Tt(e.noDocument.path),r=dc(e.noDocument.readTime);return new Bo(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=co.Tt(e.unknownDocument.path);return r=dc(e.unknownDocument.version),new zo(i,r)}return ki()}function cc(t,e,n){var r=lc(n),i=e.key.path.Z().rt();if(e instanceof qo){var o=function(t,e){return{name:Ja(t,e.key),fields:e.vt().mapValue.fields,updateTime:za(t,e.version.G())}}(t.Ms,e),s=e.hasCommittedMutations;return new Qu(null,null,o,s,r,i)}if(e instanceof Bo){var a=e.key.path.rt(),u=fc(e.version);return s=e.hasCommittedMutations,new Qu(null,new Wu(a,u),null,s,r,i)}if(e instanceof zo){var c=e.key.path.rt(),l=fc(e.version);return new Qu(new Gu(c,l),null,null,!0,r,i)}return ki()}function lc(t){var e=t.G();return[e.seconds,e.nanoseconds]}function hc(t){var e=new ro(t[0],t[1]);return io.W(e)}function fc(t){var e=t.G();return new Uu(e.seconds,e.nanoseconds)}function dc(t){var e=new ro(t.seconds,t.nanoseconds);return io.W(e)}function pc(t,e){for(var n=(e.baseMutations||[]).map(function(e){return ou(t.Ms,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return ou(t.Ms,e)}),s=ro.fromMillis(e.localWriteTimeMs);return new oc(e.batchId,s,n,o)}function yc(t){var e,n,r=dc(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?dc(t.lastLimboFreeSnapshotVersion):io.min();return void 0!==t.query.documents?(Di(1===(n=t.query).documents.length),e=bs(ds(Za(n.documents[0])))):e=function(t){return bs(uu(t))}(t.query),new xs(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ui.fromBase64String(t.resumeToken))}function vc(t,e){var n,r=fc(e.Mt),i=fc(e.lastLimboFreeSnapshotVersion);n=Yo(e.target)?su(t.Ms,e.target):au(t.Ms,e.target);var o=e.resumeToken.toBase64();return new Yu(e.targetId,Qo(e.target),r,o,e.sequenceNumber,i,n)}function gc(t){var e=uu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ws(e,e.limit,"L"):e}var mc=function(){function t(){}return t.prototype.Ls=function(t,e){return _c(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:dc(e.createTime),version:e.version};var e})},t.prototype.$s=function(t,e){return _c(t).put({bundleId:(n=e).id,createTime:fc(Qa(n.createTime)),version:n.version});var n},t.prototype.Bs=function(t,e){return bc(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:gc(e.bundledQuery),readTime:dc(e.readTime)};var e})},t.prototype.qs=function(t,e){return bc(t).put(function(t){return{name:t.name,readTime:fc(Qa(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function _c(t){return ic(t,tc.store)}function bc(t){return ic(t,ec.store)}var wc=function(){function t(){this.Us=new Ec}return t.prototype.Qs=function(t,e){return this.Us.add(e),wu.resolve()},t.prototype.Ks=function(t,e){return wu.resolve(this.Us.getEntries(e))},t}(),Ec=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new va(so.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new va(so.J)).rt()},t}(),Cc=function(){function t(){this.Ws=new Ec}return t.prototype.Qs=function(t,e){var n=this;if(!this.Ws.has(e)){var r=e.et(),i=e.Z();t.ps(function(){n.Ws.add(e)});var o={collectionId:r,parent:Fu(i)};return Oc(t).put(o)}return wu.resolve()},t.prototype.Ks=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Vi(e),""],!1,!0);return Oc(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Vu(o.parent))}return n})},t}();function Oc(t){return ic(t,Xu.store)}var Tc={js:!1,Gs:0,zs:0,Hs:0},Ic=function(){function t(t,e,n){this.Js=t,this.Ys=e,this.Xs=n}return t.Zs=function(e){return new t(e,t.ti,t.ei)},t}();function Sc(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){if(t.code!==Hi.FAILED_PRECONDITION||t.message!==Pu)throw t;return xi("LocalStore","Unexpectedly lost primary lease"),[2]})})}Ic.ti=10,Ic.ei=1e3,Ic.ni=new Ic(41943040,Ic.ti,Ic.ei),Ic.si=new Ic(-1,0,0);var xc=function(){function t(t,e){this.ii=t,this.ri=e,this.oi={}}return t.prototype.get=function(t){var e=this.ii(t),n=this.oi[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ri(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ii(t),r=this.oi[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ri(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.oi[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ii(t),n=this.oi[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ri(n[r][0],t))return 1===n.length?delete this.oi[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ho(this.oi,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return fo(this.oi)},t}(),Nc=function(){function t(){this.ci=new xc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ai=!1}return t.prototype.ui=function(t){var e=this.ci.get(t);return e?e.readTime:io.min()},t.prototype.hi=function(t,e){this.li(),this.ci.set(t.key,{_i:t,readTime:e})},t.prototype.fi=function(t,e){void 0===e&&(e=null),this.li(),this.ci.set(t,{_i:null,readTime:e})},t.prototype.di=function(t,e){this.li();var n=this.ci.get(e);return void 0!==n?wu.resolve(n._i):this.wi(t,e)},t.prototype.getEntries=function(t,e){return this.Ei(t,e)},t.prototype.apply=function(t){return this.li(),this.ai=!0,this.Ti(t)},t.prototype.li=function(){},t}();function jc(t,e,n){var r=t.store(Bu.store),i=t.store(zu.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.ls({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){Di(1===a)}));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=zu.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return wu.$n(o).next(function(){return c})}function Ac(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ki();e=t.noDocument}return JSON.stringify(e).length}var kc=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ii=n,this.mi=r,this.Ai={}}return t.Ri=function(e,n,r,i){return Di(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Pi=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pc(t).ls({index:Bu.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.yi=function(t,e,n,r){var i=this,o=Rc(t),s=Pc(t);return s.add({}).next(function(a){Di("number"==typeof a);for(var u=new oc(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return iu(t.Ms,e)}),i=n.mutations.map(function(e){return iu(t.Ms,e)});return new Bu(e,n.batchId,n.Ds.toMillis(),r,i)}(i.Kt,i.userId,u),l=[],h=new va(function(t,e){return Li(t.ot(),e.ot())}),f=0,d=r;f<d.length;f++){var p=d[f],y=zu.key(i.userId,p.key.path,a);h=h.add(p.key.path.Z()),l.push(s.put(c)),l.push(o.put(y,zu.PLACEHOLDER))}return h.forEach(function(e){l.push(i.Ii.Qs(t,e))}),t.ps(function(){i.Ai[a]=u.keys()}),wu.$n(l).next(function(){return u})})},t.prototype.gi=function(t,e){var n=this;return Pc(t).get(e).next(function(t){return t?(Di(t.userId===n.userId),pc(n.Kt,t)):null})},t.prototype.Vi=function(t,e){var n=this;return this.Ai[e]?wu.resolve(this.Ai[e]):this.gi(t,e).next(function(t){if(t){var r=t.keys();return n.Ai[e]=r,r}return null})},t.prototype.pi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Pc(t).ls({index:Bu.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Di(e.batchId>=r),o=pc(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.bi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Pc(t).ls({index:Bu.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.vi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pc(t).os(Bu.userMutationsIndex,n).next(function(t){return t.map(function(t){return pc(e.Kt,t)})})},t.prototype.Si=function(t,e){var n=this,r=zu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Rc(t).ls({range:i},function(r,i,s){var a=r[0],u=r[2],c=Vu(r[1]);if(a===n.userId&&e.path.isEqual(c))return Pc(t).get(u).next(function(t){if(!t)throw ki();Di(t.userId===n.userId),o.push(pc(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Di=function(t,e){var n=this,r=new va(Li),i=[];return e.forEach(function(e){var o=zu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Rc(t).ls({range:s},function(t,i,o){var s=t[0],a=t[2],u=Vu(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),wu.$n(i).next(function(){return n.Ci(t,r)})},t.prototype.xi=function(t,e){var n=this,r=e.path,i=r.length+1,o=zu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new va(Li);return Rc(t).ls({range:s},function(t,e,o){var s=t[0],u=t[2],c=Vu(t[1]);s===n.userId&&r.st(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Ci(t,a)})},t.prototype.Ci=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Pc(t).get(e).next(function(t){if(null===t)throw ki();Di(t.userId===n.userId),r.push(pc(n.Kt,t))}))}),wu.$n(i).next(function(){return r})},t.prototype.Ni=function(t,e){var n=this;return jc(t.vs,this.userId,e).next(function(r){return t.ps(function(){n.Fi(e.batchId)}),wu.forEach(r,function(e){return n.mi.Oi(t,e)})})},t.prototype.Fi=function(t){delete this.Ai[t]},t.prototype.ki=function(t){var e=this;return this.Pi(t).next(function(n){if(!n)return wu.resolve();var r=IDBKeyRange.lowerBound(zu.prefixForUser(e.userId)),i=[];return Rc(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=Vu(t[1]);i.push(o)}else r.done()}).next(function(){Di(0===i.length)})})},t.prototype.Mi=function(t,e){return Dc(t,this.userId,e)},t.prototype.Li=function(t){var e=this;return Fc(t).get(this.userId).next(function(t){return t||new qu(e.userId,-1,"")})},t}();function Dc(t,e,n){var r=zu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Rc(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Pc(t){return ic(t,Bu.store)}function Rc(t){return ic(t,zu.store)}function Fc(t){return ic(t,qu.store)}var Lc=function(){function t(t){this.$i=t}return t.prototype.next=function(){return this.$i+=2,this.$i},t.Bi=function(){return new t(0)},t.qi=function(){return new t(-1)},t}(),Mc=function(){function t(t,e){this.mi=t,this.Kt=e}return t.prototype.Ui=function(t){var e=this;return this.Qi(t).next(function(n){var r=new Lc(n.highestTargetId);return n.highestTargetId=r.next(),e.Ki(t,n).next(function(){return n.highestTargetId})})},t.prototype.Wi=function(t){return this.Qi(t).next(function(t){return io.W(new ro(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.ji=function(t){return this.Qi(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Gi=function(t,e,n){var r=this;return this.Qi(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ki(t,i)})},t.prototype.zi=function(t,e){var n=this;return this.Hi(t,e).next(function(){return n.Qi(t).next(function(r){return r.targetCount+=1,n.Ji(e,r),n.Ki(t,r)})})},t.prototype.Yi=function(t,e){return this.Hi(t,e)},t.prototype.Xi=function(t,e){var n=this;return this.Zi(t,e.targetId).next(function(){return Vc(t).delete(e.targetId)}).next(function(){return n.Qi(t)}).next(function(e){return Di(e.targetCount>0),e.targetCount-=1,n.Ki(t,e)})},t.prototype.tr=function(t,e,n){var r=this,i=0,o=[];return Vc(t).ls(function(s,a){var u=yc(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Xi(t,u)))}).next(function(){return wu.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return Vc(t).ls(function(t,n){var r=yc(n);e(r)})},t.prototype.Qi=function(t){return Uc(t).get($u.key).next(function(t){return Di(null!==t),t})},t.prototype.Ki=function(t,e){return Uc(t).put($u.key,e)},t.prototype.Hi=function(t,e){return Vc(t).put(vc(this.Kt,e))},t.prototype.Ji=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.er=function(t){return this.Qi(t).next(function(t){return t.targetCount})},t.prototype.nr=function(t,e){var n=Qo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Vc(t).ls({range:r,index:Yu.queryTargetsIndexName},function(t,n,r){var o=yc(n);Ko(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.sr=function(t,e,n){var r=this,i=[],o=Hc(t);return e.forEach(function(e){var s=Fu(e.path);i.push(o.put(new Ju(n,s))),i.push(r.mi.ir(t,n,e))}),wu.$n(i)},t.prototype.rr=function(t,e,n){var r=this,i=Hc(t);return wu.forEach(e,function(e){var o=Fu(e.path);return wu.$n([i.delete([n,o]),r.mi.cr(t,n,e)])})},t.prototype.Zi=function(t,e){var n=Hc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ar=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Hc(t),i=Ia();return r.ls({range:n,hs:!0},function(t,e,n){var r=Vu(t[1]),o=new co(r);i=i.add(o)}).next(function(){return i})},t.prototype.Mi=function(t,e){var n=Fu(e.path),r=IDBKeyRange.bound([n],[Vi(n)],!1,!0),i=0;return Hc(t).ls({index:Ju.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return Vc(t).get(e).next(function(t){return t?yc(t):null})},t}();function Vc(t){return ic(t,Yu.store)}function Uc(t){return ic(t,$u.store)}function Hc(t){return ic(t,Ju.store)}function qc(t,e){var n=t[1],r=e[1],i=Li(t[0],e[0]);return 0===i?Li(n,r):i}var Bc=function(){function t(t){this.ur=t,this.buffer=new va(qc),this.hr=0}return t.prototype.lr=function(){return++this.hr},t.prototype._r=function(t){var e=[t,this.lr()];if(this.buffer.size<this.ur)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();qc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),zc=function(){function t(t,e){this.dr=t,this.fs=e,this.wr=!1,this.Er=null}return t.prototype.start=function(t){-1!==this.dr.params.Js&&this.Tr(t)},t.prototype.stop=function(){this.Er&&(this.Er.cancel(),this.Er=null)},Object.defineProperty(t.prototype,"Ir",{get:function(){return null!==this.Er},enumerable:!1,configurable:!0}),t.prototype.Tr=function(t){var e=this,n=this.wr?3e5:6e4;xi("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Er=this.fs.mr("lru_garbage_collection",n,function(){return Object(Ti.b)(e,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:this.Er=null,this.wr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ar(this.dr)];case 2:return n.sent(),[3,7];case 3:return Iu(e=n.sent())?(xi("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Sc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Tr(t)];case 8:return n.sent(),[2]}})})})},t}(),Wc=function(){function t(t,e){this.Rr=t,this.params=e}return t.prototype.Pr=function(t,e){return this.Rr.yr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.gr=function(t,e){var n=this;if(0===e)return wu.resolve(no.U);var r=new Bc(e);return this.Rr.mn(t,function(t){return r._r(t.sequenceNumber)}).next(function(){return n.Rr.Vr(t,function(t){return r._r(t)})}).next(function(){return r.maxValue})},t.prototype.tr=function(t,e,n){return this.Rr.tr(t,e,n)},t.prototype.pr=function(t,e){return this.Rr.pr(t,e)},t.prototype.br=function(t,e){var n=this;return-1===this.params.Js?(xi("LruGarbageCollector","Garbage collection skipped; disabled"),wu.resolve(Tc)):this.vr(t).next(function(r){return r<n.params.Js?(xi("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Js),Tc):n.Sr(t,e)})},t.prototype.vr=function(t){return this.Rr.vr(t)},t.prototype.Sr=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.Pr(t,this.params.Ys).next(function(e){return e>c.params.Xs?(xi("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Xs+" from "+e),r=c.params.Xs):r=e,o=Date.now(),c.gr(t,r)}).next(function(r){return n=r,s=Date.now(),c.tr(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.pr(t,n)}).next(function(t){return u=Date.now(),Si()<=wt.a.DEBUG&&xi("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),wu.resolve({js:!0,Gs:r,zs:i,Hs:t})})},t}(),Gc=function(){function t(t,e){this.db=t,this.dr=function(t,e){return new Wc(t,e)}(this,e)}return t.prototype.yr=function(t){var e=this.Dr(t);return this.db.Cr().er(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Dr=function(t){var e=0;return this.Vr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Cr().mn(t,e)},t.prototype.Vr=function(t,e){return this.Nr(t,function(t,n){return e(n)})},t.prototype.ir=function(t,e,n){return Qc(t,n)},t.prototype.cr=function(t,e,n){return Qc(t,n)},t.prototype.tr=function(t,e,n){return this.db.Cr().tr(t,e,n)},t.prototype.Oi=function(t,e){return Qc(t,e)},t.prototype.Fr=function(t,e){return function(t,e){var n=!1;return Fc(t)._s(function(r){return Dc(t,r,e).next(function(t){return t&&(n=!0),wu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.pr=function(t,e){var n=this,r=this.db.kr().Or(),i=[],o=0;return this.Nr(t,function(s,a){if(a<=e){var u=n.Fr(t,s).next(function(e){if(!e)return o++,r.di(t,s).next(function(){return r.fi(s),Hc(t).delete([0,Fu(s.path)])})});i.push(u)}}).next(function(){return wu.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.Ss);return this.db.Cr().Yi(t,n)},t.prototype.Mr=function(t,e){return Qc(t,e)},t.prototype.Nr=function(t,e){var n,r=Hc(t),i=no.U;return r.ls({index:Ju.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==no.U&&e(new co(Vu(n)),i),i=s,n=o):i=no.U}).next(function(){i!==no.U&&e(new co(Vu(n)),i)})},t.prototype.vr=function(t){return this.db.kr().Lr(t)},t}();function Qc(t,e){return Hc(t).put(function(t,e){return new Ju(0,Fu(t.path),e)}(e,t.Ss))}var Kc=function(){function t(t,e){this.Kt=t,this.Ii=e}return t.prototype.hi=function(t,e,n){return $c(t).put(Xc(e),n)},t.prototype.fi=function(t,e){var n=$c(t),r=Xc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.$r(t,r)})},t.prototype.di=function(t,e){var n=this;return $c(t).get(Xc(e)).next(function(t){return n.Br(t)})},t.prototype.qr=function(t,e){var n=this;return $c(t).get(Xc(e)).next(function(t){var e=n.Br(t);return e?{_i:e,size:Ac(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=ba();return this.Ur(t,e,function(t,e){var i=n.Br(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Qr=function(t,e){var n=this,r=ba(),i=new da(co.J);return this.Ur(t,e,function(t,e){var o=n.Br(e);o?(r=r.Ht(t,o),i=i.Ht(t,Ac(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Kr:r,Wr:i}})},t.prototype.Ur=function(t,e,n){if(e.nt())return wu.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return $c(t).ls({range:r},function(t,e,r){for(var s=co.Tt(t);o&&co.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.jr=function(t,e,n){var r=this,i=Ea(),o=e.path.length+1,s={};if(n.isEqual(io.min())){var a=e.path.rt();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.rt(),c=lc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Qu.collectionReadTimeIndex}return $c(t).ls(s,function(t,n,s){if(t.length===o){var a=uc(r.Kt,n);e.path.st(a.key.path)?a instanceof qo&&Ts(e,a)&&(i=i.Ht(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.Or=function(t){return new Yc(this,!!t&&t.Gr)},t.prototype.Lr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Jc(t).get(Ku.key).next(function(t){return Di(!!t),t})},t.prototype.$r=function(t,e){return Jc(t).put(Ku.key,e)},t.prototype.Br=function(t){if(t){var e=uc(this.Kt,t);return e instanceof Bo&&e.version.isEqual(io.min())?null:e}return null},t}(),Yc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).zr=e,r.Gr=n,r.Hr=new xc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(Ti.c)(e,t),e.prototype.Ti=function(t){var e=this,n=[],r=0,i=new va(function(t,e){return Li(t.ot(),e.ot())});return this.ci.forEach(function(o,s){var a=e.Hr.get(o);if(s._i){var u=cc(e.zr.Kt,s._i,e.ui(o));i=i.add(o.path.Z());var c=Ac(u);r+=c-a,n.push(e.zr.hi(t,o,u))}else if(r-=a,e.Gr){var l=cc(e.zr.Kt,new Bo(o,io.min()),e.ui(o));n.push(e.zr.hi(t,o,l))}else n.push(e.zr.fi(t,o))}),i.forEach(function(r){n.push(e.zr.Ii.Qs(t,r))}),n.push(this.zr.updateMetadata(t,r)),wu.$n(n)},e.prototype.wi=function(t,e){var n=this;return this.zr.qr(t,e).next(function(t){return null===t?(n.Hr.set(e,0),null):(n.Hr.set(e,t.size),t._i)})},e.prototype.Ei=function(t,e){var n=this;return this.zr.Qr(t,e).next(function(t){var e=t.Kr;return t.Wr.forEach(function(t,e){n.Hr.set(t,e)}),e})},e}(Nc);function Jc(t){return ic(t,Ku.store)}function $c(t){return ic(t,Qu.store)}function Xc(t){return t.path.rt()}var Zc=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;Di(n<r&&n>=0&&r<=11);var o=new Eu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Hu.store)}(t),function(t){t.createObjectStore(qu.store,{keyPath:qu.keyPath}),t.createObjectStore(Bu.store,{keyPath:Bu.keyPath,autoIncrement:!0}).createIndex(Bu.userMutationsIndex,Bu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(zu.store)}(t),tl(t),function(t){t.createObjectStore(Qu.store)}(t));var s=wu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ju.store),t.deleteObjectStore(Yu.store),t.deleteObjectStore($u.store)}(t),tl(t)),s=s.next(function(){return function(t){var e=t.store($u.store),n=new $u(0,0,io.min().G(),0);return e.put($u.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Bu.store).os().next(function(n){t.deleteObjectStore(Bu.store),t.createObjectStore(Bu.store,{keyPath:Bu.keyPath,autoIncrement:!0}).createIndex(Bu.userMutationsIndex,Bu.userMutationsKeyPath,{unique:!0});var r=e.store(Bu.store),i=n.map(function(t){return r.put(t)});return wu.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Zu.store,{keyPath:Zu.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Jr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Ku.store)}(t),i.Yr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Xr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Zr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Qu.store);e.createIndex(Qu.readTimeIndex,Qu.readTimeIndexPath,{unique:!1}),e.createIndex(Qu.collectionReadTimeIndex,Qu.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.eo(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(tc.store,{keyPath:tc.keyPath})}(t),function(t){t.createObjectStore(ec.store,{keyPath:ec.keyPath})}(t)})),s},t.prototype.Yr=function(t){var e=0;return t.store(Qu.store).ls(function(t,n){e+=Ac(n)}).next(function(){var n=new Ku(e);return t.store(Ku.store).put(Ku.key,n)})},t.prototype.Jr=function(t){var e=this,n=t.store(qu.store),r=t.store(Bu.store);return n.os().next(function(n){return wu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(Bu.userMutationsIndex,i).next(function(r){return wu.forEach(r,function(r){Di(r.userId===n.userId);var i=pc(e.Kt,r);return jc(t,n.userId,i).next(function(){})})})})})},t.prototype.Xr=function(t){var e=t.store(Ju.store),n=t.store(Qu.store);return t.store($u.store).get($u.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new so(n),s=function(t){return[0,Fu(t)]}(o);r.push(e.get(s).next(function(n){return n?wu.resolve():function(n){return e.put(new Ju(0,Fu(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return wu.$n(r)})})},t.prototype.Zr=function(t,e){t.createObjectStore(Xu.store,{keyPath:Xu.keyPath});var n=e.store(Xu.store),r=new Ec,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:Fu(i)})}};return e.store(Qu.store).ls({hs:!0},function(t,e){var n=new so(t);return i(n.Z())}).next(function(){return e.store(zu.store).ls({hs:!0},function(t,e){var n=Vu(t[1]);return i(n.Z())})})},t.prototype.eo=function(t){var e=this,n=t.store(Yu.store);return n.ls(function(t,r){var i=yc(r),o=vc(e.Kt,i);return n.put(o)})},t}();function tl(t){t.createObjectStore(Ju.store,{keyPath:Ju.keyPath}).createIndex(Ju.documentTargetsIndex,Ju.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Yu.store,{keyPath:Yu.keyPath}).createIndex(Yu.queryTargetsIndexName,Yu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore($u.store)}var el="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nl=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.no=o,this.window=s,this.document=a,this.so=c,this.io=l,this.ro=null,this.oo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.co=null,this.inForeground=!1,this.ao=null,this.uo=null,this.ho=Number.NEGATIVE_INFINITY,this.lo=function(t){return Promise.resolve()},!t.Wn())throw new qi(Hi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.mi=new Gc(this,i),this._o=n+"main",this.Kt=new ac(u),this.fo=new Cu(this._o,11,new Zc(this.Kt)),this.wo=new Mc(this.mi,this.Kt),this.Ii=new Cc,this.Eo=function(t,e){return new Kc(t,e)}(this.Kt,this.Ii),this.To=new mc,this.window&&this.window.localStorage?this.Io=this.window.localStorage:(this.Io=null,!1===l&&Ni("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.mo().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new qi(Hi.FAILED_PRECONDITION,el);return t.Ao(),t.Ro(),t.Po(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.wo.ji(e)})}).then(function(e){t.ro=new no(e,t.so)}).then(function(){t.oo=!0}).catch(function(e){return t.fo&&t.fo.close(),Promise.reject(e)})},t.prototype.yo=function(t){var e=this;return this.lo=function(n){return Object(Ti.b)(e,void 0,void 0,function(){return Object(Ti.d)(this,function(e){return this.Ir?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.Vo=function(t){var e=this;this.fo.Zn(function(n){return Object(Ti.b)(e,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.po=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.no.ys(function(){return Object(Ti.b)(e,void 0,void 0,function(){return Object(Ti.d)(this,function(t){switch(t.label){case 0:return this.Ir?[4,this.mo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.mo=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return il(e).put(new Zu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.bo(e).next(function(e){e||(t.isPrimary=!1,t.no.vo(function(){return t.lo(!1)}))})}).next(function(){return t.So(e)}).next(function(n){return t.isPrimary&&!n?t.Do(e).next(function(){return!1}):!!n&&t.Co(e).next(function(){return!0})})}).catch(function(e){if(Iu(e))return xi("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return xi("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.no.vo(function(){return t.lo(e)}),t.isPrimary=e})},t.prototype.bo=function(t){var e=this;return rl(t).get(Hu.key).next(function(t){return wu.resolve(e.xo(t))})},t.prototype.No=function(t){return il(t).delete(this.clientId)},t.prototype.Fo=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Oo(this.ho,18e5)?[3,2]:(this.ho=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=ic(t,Zu.store);return e.os().next(function(t){var n=r.ko(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return wu.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Io)for(e=0,n=t;e<n.length;e++)this.Io.removeItem(this.Mo(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Po=function(){var t=this;this.uo=this.no.mr("client_metadata_refresh",4e3,function(){return t.mo().then(function(){return t.Fo()}).then(function(){return t.Po()})})},t.prototype.xo=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.So=function(t){var e=this;return this.io?wu.resolve(!0):rl(t).get(Hu.key).next(function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Lo(n.ownerId)){if(e.xo(n)&&e.networkEnabled)return!0;if(!e.xo(n)){if(!n.allowTabSynchronization)throw new qi(Hi.FAILED_PRECONDITION,el);return!1}}return!(!e.networkEnabled||!e.inForeground)||il(t).os().next(function(t){return void 0===e.ko(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&xi("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.$o=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t=this;return Object(Ti.d)(this,function(e){switch(e.label){case 0:return this.oo=!1,this.Bo(),this.uo&&(this.uo.cancel(),this.uo=null),this.qo(),this.Uo(),[4,this.fo.runTransaction("shutdown","readwrite",[Hu.store,Zu.store],function(e){var n=new rc(e,no.U);return t.Do(n).next(function(){return t.No(n)})})];case 1:return e.sent(),this.fo.close(),this.Qo(),[2]}})})},t.prototype.ko=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Lo(t.clientId)})},t.prototype.Ko=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return il(e).os().next(function(e){return t.ko(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Ir",{get:function(){return this.oo},enumerable:!1,configurable:!0}),t.prototype.Wo=function(t){return kc.Ri(t,this.Kt,this.Ii,this.mi)},t.prototype.Cr=function(){return this.wo},t.prototype.kr=function(){return this.Eo},t.prototype.jo=function(){return this.Ii},t.prototype.Go=function(){return this.To},t.prototype.runTransaction=function(t,e,n){var r,i=this;return xi("IndexedDbPersistence","Starting transaction:",t),this.fo.runTransaction(t,"readonly"===e?"readonly":"readwrite",nc,function(o){return r=new rc(o,i.ro?i.ro.next():no.U),"readwrite-primary"===e?i.bo(r).next(function(t){return!!t||i.So(r)}).next(function(e){if(!e)throw Ni("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.no.vo(function(){return i.lo(!1)}),new qi(Hi.FAILED_PRECONDITION,Pu);return n(r)}).next(function(t){return i.Co(r).next(function(){return t})}):i.zo(r).next(function(){return n(r)})}).then(function(t){return r.bs(),t})},t.prototype.zo=function(t){var e=this;return rl(t).get(Hu.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Lo(t.ownerId)&&!e.xo(t)&&!(e.io||e.allowTabSynchronization&&t.allowTabSynchronization))throw new qi(Hi.FAILED_PRECONDITION,el)})},t.prototype.Co=function(t){var e=new Hu(this.clientId,this.allowTabSynchronization,Date.now());return rl(t).put(Hu.key,e)},t.Wn=function(){return Cu.Wn()},t.prototype.Do=function(t){var e=this,n=rl(t);return n.get(Hu.key).next(function(t){return e.xo(t)?(xi("IndexedDbPersistence","Releasing primary lease."),n.delete(Hu.key)):wu.resolve()})},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Ni("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ao=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ao=function(){t.no.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.mo()})},this.document.addEventListener("visibilitychange",this.ao),this.inForeground="visible"===this.document.visibilityState)},t.prototype.qo=function(){this.ao&&(this.document.removeEventListener("visibilitychange",this.ao),this.ao=null)},t.prototype.Ro=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.co=function(){e.Bo(),e.no.ys(function(){return e.$o()})},this.window.addEventListener("unload",this.co))},t.prototype.Uo=function(){this.co&&(this.window.removeEventListener("unload",this.co),this.co=null)},t.prototype.Lo=function(t){var e;try{var n=null!==(null===(e=this.Io)||void 0===e?void 0:e.getItem(this.Mo(t)));return xi("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Ni("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Bo=function(){if(this.Io)try{this.Io.setItem(this.Mo(this.clientId),String(Date.now()))}catch(t){Ni("Failed to set zombie client id.",t)}},t.prototype.Qo=function(){if(this.Io)try{this.Io.removeItem(this.Mo(this.clientId))}catch(t){}},t.prototype.Mo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function rl(t){return ic(t,Hu.store)}function il(t){return ic(t,Zu.store)}function ol(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var sl=function(){function t(t,e,n){this.Eo=t,this.Ho=e,this.Ii=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.Eo.di(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Ns(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=ba();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Ns(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.Eo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Di(t,e).next(function(r){var i=n.Xo(t,e,r),o=_a();return i.forEach(function(t,e){e||(e=new Bo(t,io.min())),o=o.Ht(t,e)}),o})},t.prototype.jr=function(t,e,n){return function(t){return co.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):ms(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new co(e)).next(function(t){var e=Ea();return t instanceof qo&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=Ea();return this.Ii.Ks(t,i).next(function(s){return wu.forEach(s,function(s){var a=function(t,e){return new hs(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,a,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.Eo.jr(t,e,n).next(function(n){return r=n,o.Ho.xi(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c),h=Js(u,l,l,o.Ds);r=h instanceof qo?r.Ht(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Ts(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=Ia(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ea&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Eo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof qo&&(c=c.Ht(t,e))}),c})},t}(),al=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=Ia(),i=Ia(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ul=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(io.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return(ps(e)||ys(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(Si()<=wt.a.DEBUG&&xi("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Os(e)),i.uc.jr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new va(Is(t));return e.forEach(function(e,r){r instanceof qo&&Ts(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return Si()<=wt.a.DEBUG&&xi("QueryEngine","Using full collection scan to execute query:",Os(e)),this.uc.jr(t,e,io.min())},t}(),cl=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new da(Li),this.wc=new xc(function(t){return Qo(t)},Ko),this.Ec=io.min(),this.Ho=t.Wo(n),this.Tc=t.kr(),this.wo=t.Cr(),this.Ic=new sl(this.Tc,this.Ho,this.persistence.jo()),this.To=t.Go(),this.fc.ac(this.Ic)}return t.prototype.Ar=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.br(n,e.dc)})},t}();function ll(t,e,n,r){return new cl(t,e,n,r)}function hl(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Ti.d)(this,function(s){switch(s.label){case 0:return n=Pi(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.vi(t).next(function(s){return o=s,r=n.persistence.Wo(e),i=new sl(n.Tc,r,n.persistence.jo()),r.vi(t)}).next(function(e){for(var n=[],r=[],s=Ia(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++)s=s.add(h[l].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var y=0,v=p.mutations;y<v.length;y++)s=s.add(v[y].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function fl(t,e){var n=Pi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Or({Gr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=wu.resolve();return o.forEach(function(t){s=s.next(function(){return r.di(e,t)}).next(function(e){var o=e,s=n.ks.get(t);Di(null!==s),(!o||o.version.u(s)<0)&&(o=i.Cs(t,o,n))&&r.hi(o,n.Os)})}),s.next(function(){return t.Ho.Ni(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.ki(t)}).next(function(){return n.Ic.Zo(t,r)})})}function dl(t){var e=Pi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.wo.Wi(t)})}function pl(t,e){var n=Pi(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Or({Gr:!0});i=n.dc;var s=[];e.Oe.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.wo.rr(t,e.Ke,o).next(function(){return n.wo.sr(t,e.Ue,o)}));var u=e.resumeToken;if(u.o()>0){var c=a.$t(u,r).Lt(t.Ss);i=i.Ht(o,c),function(t,e,n){return Di(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.j()-t.Mt.j()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(a,c,e)&&s.push(n.wo.Yi(t,c))}}});var a=_a();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.mi.Mr(t,r))}),s.push(yl(t,o,e.Me,r,void 0).next(function(t){a=t})),!r.isEqual(io.min())){var u=n.wo.Wi(t).next(function(e){return n.wo.Gi(t,t.Ss,r)});s.push(u)}return wu.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,a)})}).then(function(t){return n.dc=i,t})}function yl(t,e,n,r,i){var o=Ia();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=_a();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s instanceof Bo&&s.version.isEqual(io.min())?(e.fi(n,u),o=o.Ht(n,s)):null==a||s.version.u(a.version)>0||0===s.version.u(a.version)&&a.hasPendingWrites?(e.hi(s,u),o=o.Ht(n,s)):xi("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function vl(t,e){var n=Pi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.pi(t,e)})}function gl(t,e){var n=Pi(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.wo.nr(t,e).next(function(i){return i?wu.resolve(r=i):n.wo.Ui(t).next(function(i){return r=new xs(e,i,0,t.Ss),n.wo.zi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function ml(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Ti.d)(this,function(a){switch(a.label){case 0:r=Pi(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.mi.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Iu(s=a.sent()))throw s;return xi("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function _l(t,e,n){var r=Pi(t),i=io.min(),o=Ia();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Pi(t),i=r.wc.get(n);return void 0!==i?wu.resolve(r.dc.get(i)):r.wo.nr(e,n)}(r,t,bs(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.wo.ar(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.jr(t,e,n?i:io.min(),n?o:Ia())}).next(function(t){return{documents:t,Pc:o}})})}function bl(t,e){var n=Pi(t),r=Pi(n.wo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function wl(t){var e=Pi(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Pi(t),i=_a(),o=lc(n),s=$c(e),a=IDBKeyRange.lowerBound(o,!0);return s.ls({index:Qu.readTimeIndex,range:a},function(t,e){var n=uc(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{gs:i,readTime:hc(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.gs;return e.Ec=t.readTime,n})}function El(t){return Object(Ti.b)(this,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){return[2,(e=Pi(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=$c(t),n=io.min();return e.ls({index:Qu.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=hc(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function Cl(t,e,n,r){return Object(Ti.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,l,h,f,d;return Object(Ti.d)(this,function(p){switch(p.label){case 0:for(i=Pi(t),o=Ia(),s=_a(),a=Oa(),u=0,c=n;u<c.length;u++)h=e.yc((l=c[u]).metadata.name),l.document&&(o=o.add(h)),s=s.Ht(h,e.gc(l)),a=a.Ht(h,e.Vc(l.metadata.readTime));return f=i.Tc.Or({Gr:!0}),[4,gl(i,function(t){return bs(ds(so.ct("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return yl(t,f,s,io.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.wo.Zi(t,d.targetId).next(function(){return i.wo.sr(t,o,d.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function Ol(t,e,n){return void 0===n&&(n=Ia()),Object(Ti.b)(this,void 0,void 0,function(){var r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return[4,gl(t,bs(gc(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Pi(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Qa(e.readTime);if(r.Mt.u(o)>=0)return i.To.qs(t,e);var s=r.$t(Ui.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.wo.Yi(t,s).next(function(){return i.wo.Zi(t,r.targetId)}).next(function(){return i.wo.sr(t,n,r.targetId)}).next(function(){return i.To.qs(t,e)})})]}})})}var Tl=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ls=function(t,e){return wu.resolve(this.bc.get(e))},t.prototype.$s=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:Qa(n.createTime)}),wu.resolve()},t.prototype.Bs=function(t,e){return wu.resolve(this.vc.get(e))},t.prototype.qs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:gc(t.bundledQuery),readTime:Qa(t.readTime)}}(e)),wu.resolve()},t}(),Il=function(){function t(){this.Sc=new va(Sl.Dc),this.Cc=new va(Sl.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.ir=function(t,e){var n=new Sl(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},t.prototype.cr=function(t,e){this.Fc(new Sl(t,e))},t.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.cr(t,e)})},t.prototype.kc=function(t){var e=this,n=new co(new so([])),r=new Sl(n,t),i=new Sl(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Fc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Fc(e)})},t.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new co(new so([])),n=new Sl(e,t),r=new Sl(e,t+1),i=Ia();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Mi=function(t){var e=new Sl(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),Sl=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return co.J(t.key,e.key)||Li(t.$c,e.$c)},t.xc=function(t,e){return Li(t.$c,e.$c)||co.J(t.key,e.key)},t}(),xl=function(){function t(t,e){this.Ii=t,this.mi=e,this.Ho=[],this.Bc=1,this.qc=new va(Sl.Dc)}return t.prototype.Pi=function(t){return wu.resolve(0===this.Ho.length)},t.prototype.yi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new oc(i,e,n,r);this.Ho.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.qc=this.qc.add(new Sl(u.key,i)),this.Ii.Qs(t,u.key.path.Z())}return wu.resolve(o)},t.prototype.gi=function(t,e){return wu.resolve(this.Uc(e))},t.prototype.pi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return wu.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.bi=function(){return wu.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.vi=function(t){return wu.resolve(this.Ho.slice())},t.prototype.Si=function(t,e){var n=this,r=new Sl(e,0),i=new Sl(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),wu.resolve(o)},t.prototype.Di=function(t,e){var n=this,r=new va(Li);return e.forEach(function(t){var e=new Sl(t,0),i=new Sl(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),wu.resolve(this.Kc(r))},t.prototype.xi=function(t,e){var n=e.path,r=n.length+1,i=n;co.Et(i)||(i=i.child(""));var o=new Sl(new co(i),0),s=new va(Li);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),wu.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.Ni=function(t,e){var n=this;Di(0===this.Wc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return wu.forEach(e.mutations,function(i){var o=new Sl(i.key,e.batchId);return r=r.delete(o),n.mi.Oi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Fi=function(t){},t.prototype.Mi=function(t,e){var n=new Sl(e,0),r=this.qc.Pe(n);return wu.resolve(e.isEqual(r&&r.key))},t.prototype.ki=function(t){return wu.resolve()},t.prototype.Wc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),Nl=function(){function t(t,e){this.Ii=t,this.jc=e,this.docs=new da(co.J),this.size=0}return t.prototype.hi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jc(e);return this.docs=this.docs.Ht(r,{_i:e,size:s,readTime:n}),this.size+=s-o,this.Ii.Qs(t,r.path.Z())},t.prototype.fi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.di=function(t,e){var n=this.docs.get(e);return wu.resolve(n?n._i:null)},t.prototype.getEntries=function(t,e){var n=this,r=ba();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e._i:null)}),wu.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=Ea(),i=new co(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),a=s.value,u=a._i,c=a.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||u instanceof qo&&Ts(e,u)&&(r=r.Ht(u.key,u))}return wu.resolve(r)},t.prototype.Gc=function(t,e){return wu.forEach(this.docs,function(t){return e(t)})},t.prototype.Or=function(t){return new jl(this)},t.prototype.Lr=function(t){return wu.resolve(this.size)},t}(),jl=function(t){function e(e){var n=this;return(n=t.call(this)||this).zr=e,n}return Object(Ti.c)(e,t),e.prototype.Ti=function(t){var e=this,n=[];return this.ci.forEach(function(r,i){i&&i._i?n.push(e.zr.hi(t,i._i,e.ui(r))):e.zr.fi(r)}),wu.$n(n)},e.prototype.wi=function(t,e){return this.zr.di(t,e)},e.prototype.Ei=function(t,e){return this.zr.getEntries(t,e)},e}(Nc),Al=function(){function t(t){this.persistence=t,this.zc=new xc(function(t){return Qo(t)},Ko),this.lastRemoteSnapshotVersion=io.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Il,this.targetCount=0,this.Yc=Lc.Bi()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),wu.resolve()},t.prototype.Wi=function(t){return wu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return wu.resolve(this.Hc)},t.prototype.Ui=function(t){return this.highestTargetId=this.Yc.next(),wu.resolve(this.highestTargetId)},t.prototype.Gi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),wu.resolve()},t.prototype.Hi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Lc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.zi=function(t,e){return this.Hi(e),this.targetCount+=1,wu.resolve()},t.prototype.Yi=function(t,e){return this.Hi(e),wu.resolve()},t.prototype.Xi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,wu.resolve()},t.prototype.tr=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.zc.delete(s),o.push(r.Zi(t,a.targetId)),i++)}),wu.$n(o).next(function(){return i})},t.prototype.er=function(t){return wu.resolve(this.targetCount)},t.prototype.nr=function(t,e){var n=this.zc.get(e)||null;return wu.resolve(n)},t.prototype.sr=function(t,e,n){return this.Jc.Nc(e,n),wu.resolve()},t.prototype.rr=function(t,e,n){this.Jc.Oc(e,n);var r=this.persistence.mi,i=[];return r&&e.forEach(function(e){i.push(r.Oi(t,e))}),wu.$n(i)},t.prototype.Zi=function(t,e){return this.Jc.kc(e),wu.resolve()},t.prototype.ar=function(t,e){var n=this.Jc.Lc(e);return wu.resolve(n)},t.prototype.Mi=function(t,e){return wu.resolve(this.Jc.Mi(e))},t}(),kl=function(){function t(t,e){var n=this;this.Xc={},this.ro=new no(0),this.oo=!1,this.oo=!0,this.mi=t(this),this.wo=new Al(this),this.Ii=new wc,this.Eo=function(t,e){return new Nl(t,function(t){return n.mi.Zc(t)})}(this.Ii),this.Kt=new ac(e),this.To=new Tl(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.$o=function(){return this.oo=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ir",{get:function(){return this.oo},enumerable:!1,configurable:!0}),t.prototype.Vo=function(){},t.prototype.po=function(){},t.prototype.jo=function(){return this.Ii},t.prototype.Wo=function(t){var e=this.Xc[t.R()];return e||(e=new xl(this.Ii,this.mi),this.Xc[t.R()]=e),e},t.prototype.Cr=function(){return this.wo},t.prototype.kr=function(){return this.Eo},t.prototype.Go=function(){return this.To},t.prototype.runTransaction=function(t,e,n){var r=this;xi("MemoryPersistence","Starting transaction:",t);var i=new Dl(this.ro.next());return this.mi.ta(),n(i).next(function(t){return r.mi.ea(i).next(function(){return t})}).Mn().then(function(t){return i.bs(),t})},t.prototype.na=function(t,e){return wu.Bn(Object.values(this.Xc).map(function(n){return function(){return n.Mi(t,e)}}))},t}(),Dl=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ss=e,n}return Object(Ti.c)(e,t),e}(Ru),Pl=function(){function t(t){this.persistence=t,this.sa=new Il,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw ki()},enumerable:!1,configurable:!0}),t.prototype.ir=function(t,e,n){return this.sa.ir(n,e),this.oa.delete(n.toString()),wu.resolve()},t.prototype.cr=function(t,e,n){return this.sa.cr(n,e),this.oa.add(n.toString()),wu.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),wu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Cr();return r.ar(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Xi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.kr().Or();return wu.forEach(this.oa,function(r){var i=co.ft(r);return e.ca(t,i).next(function(t){t||n.fi(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.Mr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return wu.Bn([function(){return wu.resolve(n.sa.Mi(e))},function(){return n.persistence.Cr().Mi(t,e)},function(){return n.persistence.na(t,e)}])},t}();function Rl(t,e){return"firestore_clients_"+t+"_"+e}function Fl(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function Ll(t,e){return"firestore_targets_"+t+"_"+e}var Ml=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new qi(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Ni("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Vl=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new qi(r.error.code,r.error.message)),i?new t(e,r.state,o):(Ni("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ul=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=xa(),s=0;i&&s<r.activeTargetIds.length;++s)i=Oo(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Ni("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Hl=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Ni("SharedClientState","Failed to parse online state: "+e),null)},t}(),ql=function(){function t(){this.activeTargetIds=xa()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Bl=function(){function t(t,e,n,r,i){this.window=t,this.no=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new da(Li),this.Ir=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=Rl(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new ql),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.Wn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,l=this;return Object(Ti.d)(this,function(h){switch(h.label){case 0:return[4,this.fa.Ko()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(Rl(this.persistenceKey,r)))&&(o=Ul.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(a=this.ba(s))&&this.va(a),u=0,c=this.Ia;u<c.length;u++)this.Ea(c[u]);return this.Ia=[],this.window.addEventListener("unload",function(){return l.$o()}),this.Ir=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Fa=function(t,e,n){this.Na(t,e,n),this.Oa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(Ll(this.persistenceKey,t));if(n){var r=Vl.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(Ll(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Oa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.Wa(t)},t.prototype.ja=function(){this.Ga()},t.prototype.$o=function(){this.Ir&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Ir=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return xi("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){xi("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){xi("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(xi("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void Ni("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.no.vo(function(){return Object(Ti.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(Ti.d)(this,function(a){if(this.Ir){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=no.U;if(null!=t)try{var n=JSON.parse(t);Di("number"==typeof n),e=n}catch(t){Ni("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==no.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new Ml(this.currentUser,t,e,n),i=Fl(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Oa=function(t){var e=Fl(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Wa=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=Ll(this.persistenceKey,t),i=new Vl(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return Ul.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Ml.aa(new Ji(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return Vl.aa(r,e)},t.prototype.ba=function(t){return Hl.aa(t)},t.prototype.Xa=function(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(xi("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.fa.iu(s,a).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=xa();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),zl=function(){function t(){this.ru=new ql,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Fa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new ql,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.$o=function(){},t.prototype.q=function(t){},t.prototype.ja=function(){},t}(),Wl=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.$o=function(){},t}(),Gl=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){xi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){xi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Ql={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Kl=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Yl=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object(Ti.c)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new Oi;s.listenOnce(wi.COMPLETE,function(){try{switch(s.getLastErrorCode()){case bi.NO_ERROR:var e=s.getResponseJson();xi("Connection","XHR received:",JSON.stringify(e)),i(e);break;case bi.TIMEOUT:xi("Connection",'RPC "'+t+'" timed out'),o(new qi(Hi.DEADLINE_EXCEEDED,"Request time out"));break;case bi.HTTP_ERROR:var n=s.getStatus();if(xi("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Hi).indexOf(e)>=0?e:Hi.UNKNOWN}(r.status);o(new qi(a,r.message))}else o(new qi(Hi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new qi(Hi.UNAVAILABLE,"Connection failed."));break;default:ki()}}finally{xi("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new yi,i=mn(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(Et.t)()||Object(Et.w)()||Object(Et.q)()||Object(Et.s)()||Object(Et.x)()||Object(Et.p)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");xi("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,l=new Kl({du:function(t){c?xi("Connection","Not sending because WebChannel is closed:",t):(u||(xi("Connection","Opening WebChannel transport."),a.open(),u=!0),xi("Connection","WebChannel sending:",t),a.send(t))},wu:function(){return a.close()}}),h=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return h(a,Ci.EventType.OPEN,function(){c||xi("Connection","WebChannel transport opened.")}),h(a,Ci.EventType.CLOSE,function(){c||(c=!0,xi("Connection","WebChannel transport closed"),l.Pu())}),h(a,Ci.EventType.ERROR,function(t){c||(c=!0,ji("Connection","WebChannel transport errored:",t),l.Pu(new qi(Hi.UNAVAILABLE,"The operation could not be completed")))}),h(a,Ci.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Di(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){xi("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=sa[t];if(void 0!==e)return fa(e)}(i),s=r.message;void 0===o&&(o=Hi.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,l.Pu(new qi(o,s)),a.close()}else xi("Connection","WebChannel received:",n),l.yu(n)}}),h(i,Ei.STAT_EVENT,function(t){10===t.stat?xi("Connection","Detected buffering proxy"):11===t.stat&&xi("Connection","Detected no buffering proxy")}),setTimeout(function(){l.Ru()},0),l},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);xi("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return xi("RestConnection","Received: ",t),t},function(e){throw ji("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.1",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+Ql[t]},t}());function Jl(){return"undefined"!=typeof window?window:null}function $l(){return"undefined"!=typeof document?document:null}function Xl(t){return new Ba(t,!0)}var Zl=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.no=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Ou},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&xi("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.no.mr(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),th=function(){function t(t,e,n,r,i,o){this.no=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new Zl(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.no.mr(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==t?this.zu.reset():e&&e.code===Hi.RESOURCE_EXHAUSTED?(Ni(e.toString()),Ni("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===Hi.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.ju),n=this.ju;this.Wu.getToken().then(function(e){t.ju===n&&t.rh(e)},function(n){e(function(){var e=new qi(Hi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object(Ti.b)(t,void 0,void 0,function(){return Object(Ti.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return xi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.no.ys(function(){return e.ju===t?n():(xi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),eh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object(Ti.c)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ki()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(Di(void 0===e||"string"==typeof e),Ui.fromBase64String(e||"")):(Di(void 0===e||e instanceof Uint8Array),Ui.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Hi.UNKNOWN:fa(t.code);return new qi(e,t.message||"")}(a);n=new Fa(r,i,o,s||null)}else if("documentChange"in e){i=$a(t,(r=e.documentChange).document.name),o=Qa(r.document.updateTime);var a=new Mo({mapValue:{fields:r.document.fields}}),u=(s=new qo(i,o,a,{}),r.targetIds||[]);n=new Pa(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=$a(t,(r=e.documentDelete).document),o=r.readTime?Qa(r.readTime):io.min(),a=new Bo(i,o),n=new Pa([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=$a(t,(r=e.documentRemove).document),n=new Pa([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return ki();var c=e.filter;i=new la(r=c.count||0),n=new Ra(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return io.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?io.min():e.readTime?Qa(e.readTime):io.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=tu(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=Yo(r)?{documents:su(t,r)}:{query:au(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Wa(t,e.resumeToken):e.Mt.u(io.min())>0&&(n.readTime=za(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ki()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=tu(this.Kt),e.removeTarget=t,this.eh(e)},e}(th),nh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object(Ti.c)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(Di(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(Di(void 0!==e),t.map(function(t){return function(t,e){var n=Qa(t.updateTime?t.updateTime:e);n.isEqual(io.min())&&(n=Qa(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Ws(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Qa(t.commitTime);return this.listener.wh(n,e)}return Di(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=tu(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return iu(e.Kt,t)})};this.eh(n)},e}(th),rh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object(Ti.c)(e,t),e.prototype.mh=function(){if(this.Ih)throw new qi(Hi.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===Hi.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===Hi.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),ih=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.mr("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(Ni(e),this.Ph=!1):xi("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),oh=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object(Ti.b)(o,void 0,void 0,function(){return Object(Ti.d)(this,function(t){switch(t.label){case 0:return ph(this)?(xi("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(Ti.b)(this,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return(e=Pi(t)).Fh.add(4),[4,ah(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,sh(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new ih(n,r)};function sh(t){return Object(Ti.b)(this,void 0,void 0,function(){var e,n;return Object(Ti.d)(this,function(r){switch(r.label){case 0:if(!ph(t))return[3,4];e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ah(t){return Object(Ti.b)(this,void 0,void 0,function(){var e,n;return Object(Ti.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function uh(t,e){var n=Pi(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),dh(n)?fh(n):Nh(n).Ju()&&lh(n,e))}function ch(t,e){var n=Pi(t),r=Nh(n);n.Nh.delete(e),r.Ju()&&hh(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():ph(n)&&n.Mh.set("Unknown"))}function lh(t,e){t.Lh.cn(e.targetId),Nh(t).hh(e)}function hh(t,e){t.Lh.cn(e),Nh(t).lh(e)}function fh(t){t.Lh=new Ma({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),Nh(t).start(),t.Mh.yh()}function dh(t){return ph(t)&&!Nh(t).Hu()&&t.Nh.size>0}function ph(t){return 0===Pi(t).Fh.size}function yh(t){t.Lh=void 0}function vh(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){return t.Nh.forEach(function(e,n){lh(t,e)}),[2]})})}function gh(t,e){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(n){return yh(t),dh(t)?(t.Mh.ph(e),fh(t)):t.Mh.set("Unknown"),[2]})})}function mh(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i,o;return Object(Ti.d)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof Fa&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Ti.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),xi("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,_h(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Pa?t.Lh.wn(e):e instanceof Ra?t.Lh.yn(e):t.Lh.In(e),n.isEqual(io.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,dl(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Oe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(Ui.h,n.Mt)),hh(t,e);var r=new xs(n.target,e,1,n.sequenceNumber);lh(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return xi("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,_h(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function _h(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r=this;return Object(Ti.d)(this,function(i){switch(i.label){case 0:if(!Iu(e))throw e;return t.Fh.add(1),[4,ah(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return dl(t.Sh)}),t.fs.vo(function(){return Object(Ti.b)(r,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return xi("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Fh.delete(1),[4,sh(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function bh(t,e){return e().catch(function(n){return _h(t,n,e)})}function wh(t){return Object(Ti.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(Ti.d)(this,function(s){switch(s.label){case 0:e=Pi(t),n=jh(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return ph(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,vl(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=jh(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,_h(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Eh(e)&&Ch(e),[2]}})})}function Eh(t){return ph(t)&&!jh(t).Hu()&&t.xh.length>0}function Ch(t){jh(t).start()}function Oh(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){return jh(t).Th(),[2]})})}function Th(t){return Object(Ti.b)(this,void 0,void 0,function(){var e,n,r;return Object(Ti.d)(this,function(i){for(e=jh(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function Ih(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=sc.from(r,e,n),[4,bh(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,wh(t)];case 2:return o.sent(),[2]}})})}function Sh(t,e){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(n){switch(n.label){case 0:return e&&jh(t).fh?[4,function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return ha(r=e.code)&&r!==Hi.ABORTED?(n=t.xh.shift(),jh(t).Xu(),[4,bh(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,wh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Eh(t)&&Ch(t),[2]}})})}function xh(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return n=Pi(t),e?(n.Fh.delete(2),[4,sh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Fh.add(2),[4,ah(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Nh(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=Pi(t);return r.mh(),new eh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:vh.bind(null,t),Iu:gh.bind(null,t),uh:mh.bind(null,t)}),t.Oh.push(function(n){return Object(Ti.b)(e,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),dh(t)?fh(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),yh(t),e.label=3;case 3:return[2]}})})})),t.Qh}function jh(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=Pi(t);return r.mh(),new nh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Oh.bind(null,t),Iu:Sh.bind(null,t),Eh:Th.bind(null,t),wh:Ih.bind(null,t)}),t.Oh.push(function(n){return Object(Ti.b)(e,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,wh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(xi("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var Ah=function(){this.Wh=void 0,this.listeners=[]},kh=function(){this.queries=new xc(function(t){return Cs(t)},Es),this.onlineState="Unknown",this.jh=new Set};function Dh(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Ti.d)(this,function(c){switch(c.label){case 0:if(n=Pi(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Ah),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.Wh=c.sent(),[3,4];case 3:return a=c.sent(),u=ku(a,"Initialization of query '"+Os(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.Wh&&e.Hh(o.Wh)&&Lh(n),[2]}})})}function Ph(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Ti.d)(this,function(a){return n=Pi(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function Rh(t,e){for(var n=Pi(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hh(s)&&(r=!0);a.Wh=s}}r&&Lh(n)}function Fh(t,e,n){var r=Pi(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Lh(t){t.jh.forEach(function(t){t.next()})}var Mh=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Aa(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=Aa.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),Vh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),Uh=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return $a(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?ru(this.Kt,t.document,!1):new Bo(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return Qa(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new Uh(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],l=(e.get(c)||Ia()).add(s);e.set(c,l)}}return e},t.prototype.complete=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return[4,Cl(this.Sh,new Uh(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,Ol(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Du(Object.assign({},this.progress),t))]}})})}}();var Hh=function(t){this.key=t},qh=function(t){this.key=t},Bh=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=Ia(),this.Ce=Ia(),this.ll=Is(t),this._l=new Na(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new ja,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,a=!1,u=ps(this.query)&&i.size===this.query.limit?i.last():null,c=ys(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var l=i.get(t),h=e instanceof qo?e:null;h&&(h=Ts(n.query,h)?h:null);var f=!!l&&n.Ce.has(l.key),d=!!h&&(h.bt||n.Ce.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data().isEqual(h.data())?f!==d&&(r.track({type:3,doc:h}),p=!0):n.El(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.ll(h,u)>0||c&&n.ll(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(a=!0)),p&&(h?(s=s.add(h),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),ps(this.query)||ys(this.query))for(;s.size>this.query.limit;){var l=ps(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{_l:s,wl:r,_c:a,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ti=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ki()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],a=0===this.hl.size&&this.qe?1:0,u=a!==this.ul;return this.ul=a,0!==o.length||u?{snapshot:new Aa(this.query,t._l,i,o,t.Ce,0===a,u,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ti({_l:this._l,wl:new ja,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=Ia(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new qh(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new Hh(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=Ia();var e=this.dl(t.documents);return this.Ti(e,!0)},t.prototype.Pl=function(){return Aa.Fe(this.query,this._l,this.Ce,0===this.ul)},t}(),zh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Wh=function(t){this.key=t,this.yl=!1},Gh=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new xc(function(t){return Cs(t)},Es),this.Dl=new Map,this.Cl=[],this.xl=new da(co.J),this.Nl=new Map,this.Fl=new Il,this.Ol={},this.kl=new Map,this.Ml=Lc.qi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Qh(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Ti.d)(this,function(a){switch(a.label){case 0:return n=Cf(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,gl(n.Sh,bs(e))];case 2:return o=a.sent(),s=n.pl.ka(o.targetId),[4,Kh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.$l&&uh(n.gl,o),a.label=4;case 4:return[2,r]}})})}function Kh(t,e,n,r){return Object(Ti.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(Ti.d)(this,function(l){switch(l.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object(Ti.b)(this,void 0,void 0,function(){var i,o,s;return Object(Ti.d)(this,function(a){switch(a.label){case 0:return(i=e.view.dl(n))._c?[4,_l(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.Oe.get(e.targetId),s=e.view.Ti(i,t.$l,o),[2,(uf(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,_l(t.Sh,e,!0)];case 1:return i=l.sent(),o=new Bh(e,i.Pc),s=o.dl(i.documents),a=Da.Be(n,r&&"Offline"!==t.onlineState),u=o.Ti(s,t.$l,a),uf(t,n,u.ml),c=new zh(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),u.snapshot)]}})})}function Yh(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return n=Pi(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!Es(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,ml(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),ch(n.gl,r.targetId),sf(n,r.targetId)}).catch(Sc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return sf(n,r.targetId),[4,ml(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Jh(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Ti.d)(this,function(a){switch(a.label){case 0:r=Of(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Pi(t),i=ro.now(),o=e.reduce(function(t,e){return t.add(e.key)},Ia());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=$s(c,n.get(c.key));null!=l&&s.push(new ea(c.key,l,Uo(l.proto.mapValue),Gs.exists(!0)))}return r.Ho.yi(t,i,s,e)})}).then(function(t){var e=t.Fs(n);return{batchId:t.batchId,ci:e}})}(r.Sh,e)];case 2:return i=a.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Ol[t.currentUser.R()];r||(r=new da(Li)),r=r.Ht(e,n),t.Ol[t.currentUser.R()]=r}(r,i.batchId,n),[4,hf(r,i.ci)];case 3:return a.sent(),[4,wh(r.gl)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=ku(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function $h(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r;return Object(Ti.d)(this,function(i){switch(i.label){case 0:n=Pi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,pl(n.Sh,e)];case 2:return r=i.sent(),e.Oe.forEach(function(t,e){var r=n.Nl.get(e);r&&(Di(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?Di(r.yl):t.Ke.size>0&&(Di(r.yl),r.yl=!1))}),[4,hf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Sc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Xh(t,e,n){var r=Pi(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Pi(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&Lh(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function Zh(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(Ti.d)(this,function(c){switch(c.label){case 0:return(r=Pi(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new da(co.J)).Ht(o,new Bo(o,io.min())),a=Ia().add(o),u=new ka(io.min(),new Map,new va(Li),s,a),[4,$h(r,u)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),lf(r),[3,4];case 2:return[4,ml(r.Sh,e,!1).then(function(){return sf(r,e,n)}).catch(Sc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function tf(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:n=Pi(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,fl(n.Sh,e)];case 2:return i=o.sent(),of(n,r,null),rf(n,r),n.pl.Fa(r,"acknowledged"),[4,hf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Sc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function ef(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:r=Pi(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Pi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.gi(t,e).next(function(e){return Di(null!==e),r=e.keys(),n.Ho.Ni(t,e)}).next(function(){return n.Ho.ki(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),of(r,e,n),rf(r,e),r.pl.Fa(e,"rejected",n),[4,hf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Sc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function nf(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Ti.d)(this,function(a){switch(a.label){case 0:ph((n=Pi(t)).gl)||xi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Pi(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.bi(t)})}(n.Sh)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=a.sent(),s=ku(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function rf(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function of(t,e,n){var r=Pi(t),i=r.Ol[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i}}function sf(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Fl.kc(e).forEach(function(e){t.Fl.Mi(e)||af(t,e)})}function af(t,e){var n=t.xl.get(e);null!==n&&(ch(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),lf(t))}function uf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Hh?(t.Fl.ir(o.key,e),cf(t,o)):o instanceof qh?(xi("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.cr(o.key,e),t.Fl.Mi(o.key)||af(t,o.key)):ki()}}function cf(t,e){var n=e.key;t.xl.get(n)||(xi("SyncEngine","New document in limbo: "+n),t.Cl.push(n),lf(t))}function lf(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Wh(e)),t.xl=t.xl.Ht(e,n),uh(t.gl,new xs(bs(ds(e.path)),n,2,no.U))}}function hf(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Ti.d)(this,function(a){switch(a.label){case 0:return r=Pi(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,a){s.push(r.Bl(a,e,n).then(function(t){if(t){r.$l&&r.pl.qa(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=al.cc(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vl.uh(i),[4,function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(Ti.d)(this,function(l){switch(l.label){case 0:n=Pi(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return wu.forEach(e,function(e){return wu.forEach(e.rc,function(r){return n.persistence.mi.ir(t,e.targetId,r)}).next(function(){return wu.forEach(e.oc,function(r){return n.persistence.mi.cr(t,e.targetId,r)})})})})];case 2:return l.sent(),[3,4];case 3:if(!Iu(r=l.sent()))throw r;return xi("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.dc.get(a),c=u.Bt(u.Mt),n.dc=n.dc.Ht(a,c));return[2]}})})}(r.Sh,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function ff(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return(n=Pi(t)).currentUser.isEqual(e)?[3,3]:(xi("SyncEngine","User change. New user:",e.R()),[4,hl(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new qi(Hi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,hf(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function df(t,e){var n=Pi(t),r=n.Nl.get(e);if(r&&r.yl)return Ia().add(r.key);var i=Ia(),o=n.Dl.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Sl.get(a[s]);i=i.ye(u.view.fl)}return i}function pf(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return[4,_l((n=Pi(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&uf(n,e.targetId,i.ml),i)]}})})}function yf(t){return Object(Ti.b)(this,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){return[2,wl((e=Pi(t)).Sh).then(function(t){return hf(e,t)})]})})}function vf(t,e,n,r){return Object(Ti.b)(this,void 0,void 0,function(){var i,o;return Object(Ti.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Pi(t),r=Pi(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Vi(t,e).next(function(e){return e?n.Ic.Zo(t,e):wu.resolve(null)})})}((i=Pi(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,wh(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(of(i,e,r||null),rf(i,e),function(t,e){Pi(Pi(t).Ho).Fi(e)}(i.Sh,e)):ki(),s.label=4;case 4:return[4,hf(i,o)];case 5:return s.sent(),[3,7];case 6:xi("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function gf(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Ti.d)(this,function(c){switch(c.label){case 0:return Cf(n=Pi(t)),Of(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,mf(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,xh(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)uh(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(a=[],u=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?a.push(e):u=u.then(function(){return sf(n,e),ml(n.Sh,e,!0)}),ch(n.gl,e)}),[4,u]);case 4:return c.sent(),[4,mf(n,a)];case 5:return c.sent(),function(t){var e=Pi(t);e.Nl.forEach(function(t,n){ch(e.gl,n)}),e.Fl.Mc(),e.Nl=new Map,e.xl=new da(co.J)}(n),n.Ll=!1,[4,xh(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function mf(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,l,h,f,d,p;return Object(Ti.d)(this,function(y){switch(y.label){case 0:n=Pi(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=void 0,(c=n.Dl.get(a=s[o]))&&0!==c.length?[4,gl(n.Sh,bs(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),l=0,h=c,y.label=3;case 3:return l<h.length?(f=n.Sl.get(h[l]),[4,pf(n,f)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,bl(n.Sh,a)];case 8:return p=y.sent(),[4,gl(n.Sh,p)];case 9:return u=y.sent(),[4,Kh(n,_f(p),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function _f(t){return fs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function bf(t){var e=Pi(t);return Pi(Pi(e.Sh).persistence).Ko()}function wf(t,e,n,r){return Object(Ti.b)(this,void 0,void 0,function(){var i,o,s;return Object(Ti.d)(this,function(a){switch(a.label){case 0:return(i=Pi(t)).Ll?(xi("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,wl(i.Sh)];case 3:return o=a.sent(),s=ka.$e(e,"current"===n),[4,hf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,ml(i.Sh,e,!0)];case 6:return a.sent(),sf(i,e,r),[3,8];case 7:ki(),a.label=8;case 8:return[2]}})})}function Ef(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,l,h;return Object(Ti.d)(this,function(f){switch(f.label){case 0:if(!(r=Cf(t)).Ll)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(xi("SyncEngine","Adding an already active target "+s),[3,5]):[4,bl(r.Sh,s)]:[3,6];case 2:return a=f.sent(),[4,gl(r.Sh,a)];case 3:return u=f.sent(),[4,Kh(r,_f(a),u.targetId,!1)];case 4:f.sent(),uh(r.gl,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,ml(r.Sh,t,!1).then(function(){ch(r.gl,t),sf(r,t)}).catch(Sc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},l=0,h=n,f.label=7;case 7:return l<h.length?[5,c(h[l])]:[3,10];case 8:f.sent(),f.label=9;case 9:return l++,[3,7];case 10:return[2]}})})}function Cf(t){var e=Pi(t);return e.gl.Ch.Bh=$h.bind(null,e),e.gl.Ch.Sn=df.bind(null,e),e.gl.Ch.$h=Zh.bind(null,e),e.vl.uh=Rh.bind(null,e.Vl),e.vl.ql=Fh.bind(null,e.Vl),e}function Of(t){var e=Pi(t);return e.gl.Ch.qh=tf.bind(null,e),e.gl.Ch.Uh=ef.bind(null,e),e}var Tf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return this.Kt=Xl(t.gu.T),this.pl=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return ll(this.persistence,new ul,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new kl(Pl.ra,this.Kt)},t.prototype.jl=function(t){return new zl},t.prototype.terminate=function(){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},t}(),If=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Ti.c)(e,t),e.prototype.initialize=function(e){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,El(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Of(this.Xl.fa)];case 4:return n.sent(),[4,wh(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return ll(this.persistence,new ul,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new zc(this.persistence.mi.dr,t.fs)},e.prototype.Gl=function(t){var e=ol(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?Ic.Zs(this.cacheSizeBytes):Ic.ni;return new nl(this.synchronizeTabs,e,t.clientId,n,t.fs,Jl(),$l(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.jl=function(t){return new zl},e}(Tf),Sf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Ti.c)(e,t),e.prototype.initialize=function(e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r=this;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof Bl?(this.pl.fa={nu:vf.bind(null,n),su:wf.bind(null,n),iu:Ef.bind(null,n),Ko:bf.bind(null,n),eu:yf.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.yo(function(t){return Object(Ti.b)(r,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return[4,gf(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Ir?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=Jl();if(!Bl.Wn(e))throw new qi(Hi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ol(t.gu.T,t.gu.persistenceKey);return new Bl(e,t.fs,n,t.clientId,t.Yl)},e}(If),xf=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n=this;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Xh(n.fa,t,1)},this.gl.Ch.s_=ff.bind(null,this.fa),[4,xh(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new kh},t.prototype.Zl=function(t){var e=Xl(t.gu.T),n=new Yl(t.gu);return function(t,e,n){return new rh(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Xh(s.fa,t,0)},o=Gl.Wn()?new Gl:new Wl,new oh(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var a=new Gh(t,e,n,r,i,o);return s&&(a.Ll=!0),a}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object(Ti.b)(this,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return e=Pi(t),xi("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,ah(e)];case 1:return n.sent(),e.kh.$o(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),Nf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),jf=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new bu,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new Vh(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object(Ti.b)(this,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new qi(Hi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new uo(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),Af=function(t){this._methodName=t};function kf(t,e,n){if(!n)throw new qi(Hi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Df(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new qi(Hi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Pf(t,e,n,r){if(!0===e&&!0===r)throw new qi(Hi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Rf(t){if(!co.Et(t))throw new qi(Hi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Ff(t){if(co.Et(t))throw new qi(Hi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Lf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ki()}function Mf(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new qi(Hi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Lf(t);throw new qi(Hi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Vf(t,e){if(e<=0)throw new qi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Uf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qi(Hi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qi(Hi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Pf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Hf=new Map,qf=function(){function t(t,e){this.w_="(lite)",this.E_=new Uf({}),this.T_=!1,t instanceof Yi?(this.I_=t,this.m_=new Xi):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qi(Hi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yi(t.options.projectId)}(t),this.m_=new Zi(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new qi(Hi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new qi(Hi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Uf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Xi;switch(t.type){case"gapi":var e=t.client;return Di(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new eo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new qi(Hi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=Hf.get(this))&&(xi("ComponentProvider","Removing Datastore"),Hf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Bf=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Wf(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),zf=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Wf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ds(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(Ti.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Bf(this.firestore,null,new co(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(zf);function Gf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zi&&(t=t._),kf("collection","path",e),t instanceof qf)return Ff(n=so.ct.apply(so,Object(Ti.g)([e],r))),new Wf(t,null,n);if(!(t instanceof Bf||t instanceof Wf))throw new qi(Hi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ff(n=so.ct.apply(so,Object(Ti.g)([t.path],r)).child(so.ct(e))),new Wf(t.firestore,null,n)}function Qf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof zi&&(t=t._),1===arguments.length&&(e=Fi.t()),kf("doc","path",e),t instanceof qf)return Rf(n=so.ct.apply(so,Object(Ti.g)([e],r))),new Bf(t,null,new co(n));if(!(t instanceof Bf||t instanceof Wf))throw new qi(Hi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Rf(n=t.D_.child(so.ct.apply(so,Object(Ti.g)([e],r)))),new Bf(t.firestore,t instanceof Wf?t.v_:null,new co(n))}function Kf(t,e){return t instanceof zi&&(t=t._),e instanceof zi&&(e=e._),(t instanceof Bf||t instanceof Wf)&&(e instanceof Bf||e instanceof Wf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Yf(t,e){return t instanceof zi&&(t=t._),e instanceof zi&&(e=e._),t instanceof zf&&e instanceof zf&&t.firestore===e.firestore&&Es(t.C_,e.C_)&&t.v_===e.v_}var Jf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new qi(Hi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new qi(Hi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return Li(this.x_,t.x_)||Li(this.N_,t.N_)},t}(),$f=/^__.*__$/,Xf=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.zt?new ea(t,this.data,this.zt,e,this.fieldTransforms):new ta(t,this.data,e,this.fieldTransforms)},t}(),Zf=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new ea(t,this.data,this.zt,e,this.fieldTransforms)},t}();function td(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ki()}}var ed=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return wd(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(td(this.k_)&&$f.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),nd=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Xl(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new ed({k_:t,methodName:e,j_:n,path:uo.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function rd(t){var e=t.p_(),n=Xl(t.I_);return new nd(t.I_,!!e.ignoreUndefinedProperties,n)}function id(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);gd("Data must be an object, but it was:",s,r);var a,u,c=yd(r,s);if(o.merge)a=new po(s.zt),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=md(e,f[h],n);if(!s.contains(d))throw new qi(Hi.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Ed(l,d)||l.push(d)}a=new po(l),u=s.fieldTransforms.filter(function(t){return a.It(t.field)})}else a=null,u=s.fieldTransforms;return new Xf(new Mo(c),a,u)}var od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Af);function sd(t,e,n){return new ed({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.z_=function(t){return new zs(t.path,new Fs)},e.prototype.isEqual=function(t){return t instanceof e},e}(Af),ud=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(Ti.c)(e,t),e.prototype.z_=function(t){var e=sd(this,t,!0),n=this.H_.map(function(t){return pd(t,e)}),r=new Ls(n);return new zs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Af),cd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(Ti.c)(e,t),e.prototype.z_=function(t){var e=sd(this,t,!0),n=this.H_.map(function(t){return pd(t,e)}),r=new Vs(n);return new zs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Af),ld=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(Ti.c)(e,t),e.prototype.z_=function(t){var e=new Hs(t.Kt,As(t.Kt,this.J_));return new zs(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Af);function hd(t,e,n,r){var i=t.G_(1,e,n);gd("Data must be an object, but it was:",i,r);var o=[],s=new Vo;ho(r,function(t,r){var a=bd(e,t,n);r instanceof zi&&(r=r._);var u=i.U_(a);if(r instanceof od)o.push(a);else{var c=pd(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new po(o);return new Zf(s.yt(),a,i.fieldTransforms)}function fd(t,e,n,r,i,o){var s=t.G_(1,e,n),a=[md(e,r,n)],u=[i];if(o.length%2!=0)throw new qi(Hi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(md(e,o[c])),u.push(o[c+1]);for(var l=[],h=new Vo,f=a.length-1;f>=0;--f)if(!Ed(l,a[f])){var d=a[f],p=u[f];p instanceof zi&&(p=p._);var y=s.U_(d);if(p instanceof od)l.push(d);else{var v=pd(p,y);null!=v&&(l.push(d),h.set(d,v))}}var g=new po(l);return new Zf(h.yt(),g,s.fieldTransforms)}function dd(t,e,n,r){return void 0===r&&(r=!1),pd(n,t.G_(r?4:3,e))}function pd(t,e){if(t instanceof zi&&(t=t._),vd(t))return gd("Unsupported field value:",e,t),yd(t,e);if(t instanceof Af)return function(t,e){if(!td(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=pd(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof zi&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return As(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ro.fromDate(t);return{timestampValue:za(e.Kt,n)}}if(t instanceof ro)return n=new ro(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:za(e.Kt,n)};if(t instanceof Jf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bi)return{bytesValue:Wa(e.Kt,t.l)};if(t instanceof Bf){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ka(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Lf(t))}(t,e)}function yd(t,e){var n={};return fo(t)?e.path&&e.path.length>0&&e.zt.push(e.path):ho(t,function(t,r){var i=pd(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function vd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ro||t instanceof Jf||t instanceof Bi||t instanceof Bf||t instanceof Af)}function gd(t,e,n){if(!vd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Lf(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function md(t,e,n){if(e instanceof zi&&(e=e._),e instanceof jf)return e.d_;if("string"==typeof e)return bd(t,e);throw wd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var _d=new RegExp("[~\\*/\\[\\]]");function bd(t,e,n){if(e.search(_d)>=0)throw wd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(jf.bind.apply(jf,Object(Ti.g)([void 0],e.split("."))))).d_}catch(r){throw wd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function wd(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new qi(Hi.INVALID_ARGUMENT,(a+=". ")+t+u)}function Ed(t,e){return t.some(function(t){return t.isEqual(e)})}var Cd=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(Ti.b)(this,void 0,void 0,function(){var e,n=this;return Object(Ti.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new qi(Hi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(Ti.d)(this,function(u){switch(u.label){case 0:return n=Pi(t),r=tu(n.Kt)+"/documents",i={documents:e.map(function(t){return Ja(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Di(!!e.found);var n=$a(t,e.found.name),r=Qa(e.found.updateTime),i=new Mo({mapValue:{fields:e.found.fields}});return new qo(n,r,i,{})}(t,e):"missing"in e?function(t,e){Di(!!e.missing),Di(!!e.readTime);var n=$a(t,e.missing),r=Qa(e.readTime);return new Bo(n,r)}(t,e):ki()}(n.Kt,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Di(!!e),a.push(e)}),a)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Bo||t instanceof qo?n.sf(t):ki()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new ua(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e=this;return Object(Ti.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=co.ft(n);e.mutations.push(new ca(r,e.Gt(r)))}),[4,function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return n=Pi(t),r=tu(n.Kt)+"/documents",i={writes:e.map(function(t){return iu(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof qo)e=t.version;else{if(!(t instanceof Bo))throw ki();e=io.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new qi(Hi.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Gs.updateTime(e):Gs.Wt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(io.min()))throw new qi(Hi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Gs.updateTime(e)}return Gs.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),Od=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Zl(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object(Ti.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(Ti.d)(this,function(r){return t=new Cd(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Eo(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ha(e)}return!1},t}(),Td=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Ji.UNAUTHENTICATED,this.clientId=Fi.t(),this._f=function(){},this.N=new bu,this.credentials.S(function(t){xi("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new qi(Hi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new bu;return this.fs.Tf(function(){return Object(Ti.b)(t,void 0,void 0,function(){var t,n;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=ku(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Id(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return t.fs.Af(),xi("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.vo(function(){return Object(Ti.b)(i,void 0,void 0,function(){return Object(Ti.d)(this,function(t){switch(t.label){case 0:return[4,hl(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.Vo(function(){return t.terminate()}),t.mf=e,[2]}})})}function Sd(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,xd(t)];case 1:return n=i.sent(),xi("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.vo(function(){return function(t,e){return Object(Ti.b)(this,void 0,void 0,function(){var n,r;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return(n=Pi(t)).fs.Af(),xi("RemoteStore","RemoteStore received new credentials"),r=ph(n),n.Fh.add(3),[4,ah(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Fh.delete(3),[4,sh(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function xd(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(xi("FirestoreClient","Using default OfflineComponentProvider"),[4,Id(t,new Tf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function Nd(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(xi("FirestoreClient","Using default OnlineComponentProvider"),[4,Sd(t,new xf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function jd(t){return xd(t).then(function(t){return t.persistence})}function Ad(t){return xd(t).then(function(t){return t.Sh})}function kd(t){return Nd(t).then(function(t){return t.gl})}function Dd(t){return Nd(t).then(function(t){return t.fa})}function Pd(t){return Object(Ti.b)(this,void 0,void 0,function(){var e,n;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return[4,Nd(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Qh.bind(null,e.fa),n.Jh=Yh.bind(null,e.fa),n)]}})})}function Rd(t,e,n){var r=this;void 0===n&&(n={});var i=new bu;return t.fs.ys(function(){return Object(Ti.b)(r,void 0,void 0,function(){var r;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Nf({next:function(o){e.ys(function(){return Ph(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new qi(Hi.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new qi(Hi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Mh(ds(n.path),o,{includeMetadataChanges:!0,sl:!0});return Dh(t,s)},[4,Pd(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function Fd(t,e,n){var r=this;void 0===n&&(n={});var i=new bu;return t.fs.ys(function(){return Object(Ti.b)(r,void 0,void 0,function(){var r;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Nf({next:function(n){e.ys(function(){return Ph(t,s)}),n.fromCache&&"server"===r.source?i.reject(new qi(Hi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Mh(n,o,{includeMetadataChanges:!0,sl:!0});return Dh(t,s)},[4,Pd(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var Ld=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Zl(this,"async_queue_retry"),this.vf=function(){var e=$l();e&&xi("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=$l();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=$l();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.vo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t,e=this;return Object(Ti.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!Iu(t=n.sent()))throw t;return xi("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,Ni("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.mr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=Au.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&ki()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(Ti.b)(this,void 0,void 0,function(){var t;return Object(Ti.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Of=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),Md=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new Ld,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(Ti.c)(e,t),e.prototype.b_=function(){return this.Lf||Ud(this),this.Lf.terminate()},e}(qf);function Vd(t){return t.Lf||Ud(t),t.Lf.df(),t.Lf}function Ud(t){var e=t.p_(),n=function(t,e,n){return new Ki(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new Td(t.m_,t.Mf,n)}function Hd(t,e,n){var r=this,i=new bu;return t.fs.enqueue(function(){return Object(Ti.b)(r,void 0,void 0,function(){var r;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Id(t,n)];case 1:return o.sent(),[4,Sd(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Hi.FAILED_PRECONDITION||t.code===Hi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function qd(t){if(t.R_||t.P_)throw new qi(Hi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Bd=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),To(t)){case 0:return null;case 1:return t.booleanValue;case 2:return go(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(mo(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw ki()}},t.prototype.jf=function(t,e){var n=this,r={};return ho(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Jf(go(t.latitude),go(t.longitude))},t.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=bo(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(wo(t));default:return null}},t.prototype.Bf=function(t){var e=vo(t);return new ro(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=so.ct(t);Di(_u(n));var r=new Yi(n.get(1),n.get(3)),i=new co(n.X(5));return r.isEqual(e)||Ni("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),zd=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Bf(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Wd(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Gd("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),Wd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(zd);function Gd(t,e){return"string"==typeof e?bd(t,e):e instanceof zi?e._.d_:e.d_}function Qd(t){if(ys(t)&&0===t.Nt.length)throw new qi(Hi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kd=function(){};function Yd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var Jd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(Ti.c)(e,t),e.prototype.Yf=function(t){var e=rd(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new qi(Hi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){rp(s,o);for(var u=[],c=0,l=s;c<l.length;c++)u.push(np(r,t,l[c]));a={arrayValue:{values:u}}}else a=np(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||rp(s,o),a=dd(n,"where",s,"in"===o||"not-in"===o);var h=Jo.create(i,o,a);return function(t,e){if(e.xt()){var n=gs(t);if(null!==n&&!n.isEqual(e.field))throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=vs(t);null!==r&&ip(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new qi(Hi.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,h),h}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new zf(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new hs(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Kd),$d=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(Ti.c)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new as(e,n);return function(t,e){if(null===vs(t)){var n=gs(t);null!==n&&ip(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new zf(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new hs(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Kd),Xd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(Ti.c)(e,t),e.prototype.Yf=function(t){return new zf(t.firestore,t.v_,ws(t.C_,this.nd,this.sd))},e}(Kd),Zd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(Ti.c)(e,t),e.prototype.Yf=function(t){var e=ep(t,this.type,this.rd,this.od);return new zf(t.firestore,t.v_,function(t,e){return new hs(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Kd),tp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(Ti.c)(e,t),e.prototype.Yf=function(t){var e=ep(t,this.type,this.rd,this.od);return new zf(t.firestore,t.v_,function(t,e){return new hs(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Kd);function ep(t,e,n,r){if(n[0]instanceof zi&&(n[0]=n[0]._),n[0]instanceof zd)return function(t,e,n,r,i){if(!r)throw new qi(Hi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=_s(t);s<a.length;s++){var u=a[s];if(u.field.ht())o.push(ko(e,r.key));else{var c=r.field(u.field);if(_o(c))throw new qi(Hi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.ot();throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new os(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=rd(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new qi(Hi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.ht()){if("string"!=typeof c)throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ms(t)&&-1!==c.indexOf("/"))throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(so.ct(c));if(!co.Et(l))throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new co(l);a.push(ko(e,h))}else{var f=dd(n,r,c);a.push(f)}}return new os(a,o)}(t.C_,t.firestore.I_,i,e,n,r)}function np(t,e,n){if(n instanceof zi&&(n=n._),"string"==typeof n){if(""===n)throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ms(e)&&-1!==n.indexOf("/"))throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(so.ct(n));if(!co.Et(r))throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ko(t,new co(r))}if(n instanceof Bf)return ko(t,n.S_);throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Lf(n)+".")}function rp(t,e){if(!Array.isArray(t)||0===t.length)throw new qi(Hi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new qi(Hi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ip(t,e,n){if(!n.isEqual(e))throw new qi(Hi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function op(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function sp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ap=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Ti.c)(e,t),e.prototype.Uf=function(t){return new Bi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Bf(this.firestore,null,e)},e}(Bd),up=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),cp=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this).zf=e,a.ad=e,a.metadata=o,a}return Object(Ti.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new lp(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Gd("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(zd),lp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(cp),hp=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new up(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new lp(n.zf,n.Hf,r.key,r,new up(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new qi(Hi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new lp(t.zf,t.Hf,e.doc.key,e.doc,new up(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new lp(t.zf,t.Hf,e.doc.key,e.doc,new up(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:fp(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function fp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ki()}}function dp(t,e){return t instanceof cp&&e instanceof cp?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof hp&&e instanceof hp&&t.zf===e.zf&&Yf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var pp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Ti.c)(e,t),e.prototype.Uf=function(t){return new Bi(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Bf(this.firestore,null,e)},e}(Bd);function yp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Mf(t,Bf);var o=Mf(t.firestore,Md),s=rd(o);return e instanceof zi&&(e=e._),gp(o,[("string"==typeof e||e instanceof jf?fd(s,"updateDoc",t.S_,e,n,r):hd(s,"updateDoc",t.S_,e)).F_(t.S_,Gs.exists(!0))])}function vp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof zi&&(t=t._);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||op(i[a])||(s=i[a],a++);var u,c,l,h={includeMetadataChanges:s.includeMetadataChanges};if(op(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Bf)c=Mf(t.firestore,Md),l=ds(t.S_.path),u={next:function(e){i[a]&&i[a](mp(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=Mf(t,zf);c=Mf(d.firestore,Md),l=d.C_;var p=new pp(c);u={next:function(t){i[a]&&i[a](new hp(c,p,d,t))},error:i[a+1],complete:i[a+2]},Qd(t.C_)}return function(t,e,n,r){var i=this,o=new Nf(r),s=new Mh(e,o,n);return t.fs.ys(function(){return Object(Ti.b)(i,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return e=Dh,[4,Pd(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object(Ti.b)(i,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return e=Ph,[4,Pd(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Vd(c),l,h,u)}function gp(t,e){return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(Ti.b)(n,void 0,void 0,function(){var n;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return n=Jh,[4,Dd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Vd(t),e)}function mp(t,e,n){var r=n.docs.get(e.S_),i=new pp(t);return new cp(t,i,e.S_,r,new up(n.hasPendingWrites,n.fromCache),e.v_)}var _p=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=rd(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=bp(t,this.zf),i=sp(r.v_,e,n),o=id(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.F_(r.S_,Gs.Wt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=bp(t,this.zf);return e instanceof zi&&(e=e._),o="string"==typeof e||e instanceof jf?fd(this.wd,"WriteBatch.update",s.S_,e,n,r):hd(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.F_(s.S_,Gs.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=bp(t,this.zf);return this.fd=this.fd.concat(new ua(e.S_,Gs.Wt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new qi(Hi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function bp(t,e){if(t instanceof zi&&(t=t._),t.firestore!==e)throw new qi(Hi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var wp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(Ti.c)(e,t),e.prototype.get=function(e){var n=this,r=bp(e,this.zf),i=new pp(this.zf);return t.prototype.get.call(this,e).then(function(t){return new cp(n.zf,i,r.S_,t.Jf,new up(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=rd(t)}return t.prototype.get=function(t){var e=this,n=bp(t,this.zf),r=new ap(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return ki();var i=t[0];if(i instanceof Bo)return new zd(e.zf,r,n.S_,null,n.v_);if(i instanceof qo)return new zd(e.zf,r,i.key,i,n.v_);throw ki()})},t.prototype.set=function(t,e,n){var r=bp(t,this.zf),i=sp(r.v_,e,n),o=id(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=bp(t,this.zf);return e instanceof zi&&(e=e._),o="string"==typeof e||e instanceof jf?fd(this.wd,"Transaction.update",s.S_,e,n,r):hd(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=bp(t,this.zf);return this.Td.delete(e.S_),this},t}()),Ep=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){qd(t=Mf(t,Md));var n=Vd(t),r=t.p_(),i=new xf;return Hd(n,i,new If(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){qd(t=Mf(t,Md));var e=Vd(t),n=t.p_(),r=new xf;return Hd(e,r,new Sf(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new qi(Hi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new bu;return t.Mf.Tf(function(){return Object(Ti.b)(e,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(Ti.b)(this,void 0,void 0,function(){return Object(Ti.d)(this,function(e){switch(e.label){case 0:return Cu.Wn()?[4,Cu.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(ol(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),Cp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Yi||(i.md=e),i}return Object(Ti.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.V_().host&&ji("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(Ti.b)(e,void 0,void 0,function(){var e,n;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return[4,jd(t)];case 1:return e=r.sent(),[4,kd(t)];case 2:return n=r.sent(),[2,(e.po(!0),function(t){var e=Pi(t);return e.Fh.delete(0),sh(e)}(n))]}})})})}(Vd(Mf(this._,Md)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(Ti.b)(e,void 0,void 0,function(){var e,n;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return[4,jd(t)];case 1:return e=r.sent(),[4,kd(t)];case 2:return n=r.sent(),[2,(e.po(!1),function(t){return Object(Ti.b)(this,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return(e=Pi(t)).Fh.add(0),[4,ah(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(Vd(Mf(this._,Md)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Pf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new bu;return t.fs.ys(function(){return Object(Ti.b)(e,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(r){switch(r.label){case 0:return e=nf,[4,Dd(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Vd(Mf(this._,Md)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Nf(e);return t.fs.ys(function(){return Object(Ti.b)(n,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Pi(t).jh.add(e),e.next()},[4,Pd(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object(Ti.b)(n,void 0,void 0,function(){var e;return Object(Ti.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Pi(t).jh.delete(e)},[4,Pd(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Vd(t=Mf(t,Md)),op(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new qi(Hi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Fp(this,Gf(this._,t))}catch(t){throw xp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Sp(this,Qf(this._,t))}catch(t){throw xp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Dp(this,function(t,e){if(t=Mf(t,qf),kf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new qi(Hi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new zf(t,null,function(t){return new hs(so.at(),t)}(e))}(this._,t))}catch(t){throw xp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(Ti.b)(n,void 0,void 0,function(){var n;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Nd(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new Od(t.fs,n,e,r).run(),[2]}})})}),r.promise}(Vd(t),function(n){return e(new wp(t,n))})}(this._,function(n){return t(new Tp(e,n))})},e.prototype.batch=function(){var t=this;return Vd(this._),new Ip(new _p(this._,function(e){return gp(t._,e)}))},e.prototype.loadBundle=function(t){throw new qi(Hi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new qi(Hi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(zi),Op=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Ti.c)(e,t),e.prototype.Uf=function(t){return new Qi(new Bi(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return Sp.Ad(e,this.firestore,null)},e}(Bd),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(Ti.c)(e,t),e.prototype.get=function(t){var e=this,n=Lp(t);return this._.get(n).then(function(t){return new Ap(e.zf,t)})},e.prototype.set=function(t,e,n){var r=Lp(t);return n?(Df("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Lp(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(Ti.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Lp(t);return this._.delete(e),this},e}(zi),Ip=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.set=function(t,e,n){var r=Lp(t);return n?(Df("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Lp(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(Ti.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Lp(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(zi),Sp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Op(e),r}return Object(Ti.c)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new qi(Hi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new Bf(n._,r,new co(t)))},e.Ad=function(t,n,r){return new e(n,new Bf(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Fp(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Fp(this.firestore,Gf(this._,t))}catch(t){throw xp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof zi&&(t=t._),t instanceof Bf&&Kf(this._,t)},e.prototype.set=function(t,e){e=Df("DocumentReference.set",e);try{return function(t,e,n){t=Mf(t,Bf);var r=Mf(t.firestore,Md),i=sp(t.v_,e,n);return gp(r,[id(rd(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Gs.Wt())])}(this._,t,e)}catch(t){throw xp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?yp(this._,t):yp.apply(void 0,Object(Ti.g)([this._,t,e],n))}catch(t){throw xp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return gp(Mf((t=this._).firestore,Md),[new ua(t.S_,Gs.Wt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Np(e),i=jp(e,function(e){return new Ap(t.firestore,new cp(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return vp(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Mf(t,Bf);var e=Mf(t.firestore,Md),n=Vd(e),r=new pp(e);return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(Ti.b)(n,void 0,void 0,function(){var n;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i;return Object(Ti.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Pi(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof qo?n.resolve(i):i instanceof Bo?n.resolve(null):n.reject(new qi(Hi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=ku(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Ad(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new cp(e,r,t.S_,n,new up(n instanceof qo&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Mf(t,Bf);var e=Mf(t.firestore,Md);return Rd(Vd(e),t.S_,{source:"server"}).then(function(n){return mp(e,t,n)})}(this._):function(t){t=Mf(t,Bf);var e=Mf(t.firestore,Md);return Rd(Vd(e),t.S_).then(function(n){return mp(e,t,n)})}(this._)).then(function(t){return new Ap(e.firestore,new cp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(zi);function xp(t,e,n){return t.message=t.message.replace(e,n),t}function Np(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!op(r))return r}return{}}function jp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=op(t[0])?t[0]:op(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Ap=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(Ti.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Sp(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return dp(this._,t._)},e}(zi),kp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(Ap),Dp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Op(e),r}return Object(Ti.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Yd(this._,function(t,e,n){var r=e,i=Gd("where",t);return new Jd(i,r,n)}(t,n,r)))}catch(t){throw xp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Yd(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Gd("orderBy",t);return new $d(r,n)}(t,n)))}catch(t){throw xp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Yd(this._,function(t){return Vf("limit",t),new Xd("limit",t,"F")}(t)))}catch(t){throw xp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Yd(this._,function(t){return Vf("limitToLast",t),new Xd("limitToLast",t,"L")}(t)))}catch(t){throw xp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zd("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw xp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zd("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw xp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new tp("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw xp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Yd(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new tp("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw xp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Yf(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Mf(t,zf);var e=Mf(t.firestore,Md),n=Vd(e),r=new pp(e);return function(t,e){var n=this,r=new bu;return t.fs.ys(function(){return Object(Ti.b)(n,void 0,void 0,function(){var n;return Object(Ti.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Ti.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(Ti.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,_l(t,e,!0)];case 1:return a=u.sent(),r=new Bh(e,a.Pc),i=r.dl(a.documents),o=r.Ti(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=ku(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Ad(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new hp(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Mf(t,zf);var e=Mf(t.firestore,Md),n=Vd(e),r=new pp(e);return Fd(n,t.C_,{source:"server"}).then(function(n){return new hp(e,r,t,n)})}(this._):function(t){t=Mf(t,zf);var e=Mf(t.firestore,Md),n=Vd(e),r=new pp(e);return Qd(t.C_),Fd(n,t.C_).then(function(n){return new hp(e,r,t,n)})}(this._)).then(function(t){return new Rp(e.firestore,new hp(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Np(e),i=jp(e,function(e){return new Rp(t.firestore,new hp(t.firestore._,t.Hf,t._,e.ud))});return vp(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(zi),Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(Ti.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new kp(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(zi),Rp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(Ti.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Dp(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new kp(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Pp(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new kp(n.zf,r))})},e.prototype.isEqual=function(t){return dp(this._,t._)},e}(zi),Fp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(Ti.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new Sp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Sp(this.firestore,void 0===t?Qf(this._):Qf(this._,t))}catch(t){throw xp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Mf(t.firestore,Md),r=Qf(t),i=sp(t.v_,e);return gp(n,[id(rd(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Gs.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new Sp(e.firestore,t)})},e.prototype.isEqual=function(t){return Kf(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Dp);function Lp(t){return t instanceof zi&&(t=t._),Mf(t,Bf)}var Mp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(jf.bind.apply(jf,Object(Ti.g)([void 0],e))))||this}return Object(Ti.c)(e,t),e.documentId=function(){return new e(uo.lt().ot())},e.prototype.isEqual=function(t){return t instanceof zi&&(t=t._),t instanceof jf&&this._.d_.isEqual(t.d_)},e}(zi),Vp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Ti.c)(e,t),e.serverTimestamp=function(){var t=new ad("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new od("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ud("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cd("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new ld("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(zi);!function(){function t(){this.Pd={},this.yd=new bu,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.Wl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var Up,Hp=n("/6Yf"),qp={Firestore:Cp,GeoPoint:Jf,Timestamp:ro,Blob:Qi,Transaction:Tp,WriteBatch:Ip,DocumentReference:Sp,DocumentSnapshot:Ap,Query:Dp,QueryDocumentSnapshot:kp,QuerySnapshot:Rp,CollectionReference:Fp,FieldPath:Mp,FieldValue:Vp,setLogLevel:function(t){Ii.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Hp.a("firestore",function(t){return function(t,e){return new Cp(t,new Md(t,e),new Ep)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},qp)))})(Up=bt.a),Up.registerVersion("@firebase/firestore","2.1.1");var Bp=n("XNiG"),zp=n("VRyK"),Wp=n("zx2A");function Gp(t,e){return"function"==typeof e?n=>n.pipe(Gp((n,r)=>Object($.a)(t(n,r)).pipe(Object(at.a)((t,i)=>e(n,t,r,i))))):e=>e.lift(new Qp(t))}class Qp{constructor(t){this.project=t}call(t,e){return e.subscribe(new Kp(t,this.project))}}class Kp extends Wp.b{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new Wp.a(this),r=this.destination;r.add(n),this.innerSubscription=Object(Wp.c)(t,n),this.innerSubscription!==n&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}var Yp=n("qgXg"),Jp=n("quSY"),$p=n("9ppp"),Xp=n("Ylt2");class Zp extends Bp.a{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new ty(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,n=e?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;let o;if(this.closed)throw new $p.a;if(this.isStopped||this.hasError?o=Jp.a.EMPTY:(this.observers.push(t),o=new Xp.a(this,t)),r&&t.add(t=new gt.a(t,r)),e)for(let s=0;s<i&&!t.closed;s++)t.next(n[s]);else for(let s=0;s<i&&!t.closed;s++)t.next(n[s].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),o}_getNow(){return(this.scheduler||Yp.a).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length;let o=0;for(;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r}}class ty{constructor(t,e){this.time=t,this.value=e}}function ey(t,e,n){let r;return r=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},t=>t.lift(function({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:n,scheduler:r}){let i,o,s=0,a=!1,u=!1;return function(c){let l;s++,!i||a?(a=!1,i=new Zp(t,e,r),l=i.subscribe(this),o=c.subscribe({next(t){i.next(t)},error(t){a=!0,i.error(t)},complete(){u=!0,o=void 0,i.complete()}})):l=i.subscribe(this),this.add(()=>{s--,l.unsubscribe(),o&&!u&&n&&0===s&&(o.unsubscribe(),o=void 0,i=void 0)})}}(r))}const ny=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})(),ry=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();var iy=n("EY2u");function oy(t){return e=>0===t?Object(iy.a)():e.lift(new sy(t))}class sy{constructor(t){if(this.total=t,this.total<0)throw new ry}call(t,e){return e.subscribe(new ay(t,this.total))}}class ay extends rt.a{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function uy(t=null){return e=>e.lift(new cy(t))}class cy{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new ly(t,this.defaultValue))}}class ly extends rt.a{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function hy(t=py){return e=>e.lift(new fy(t))}class fy{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new dy(t,this.errorFactory))}}class dy extends rt.a{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let t;try{t=this.errorFactory()}catch(Up){t=Up}this.destination.error(t)}}}function py(){return new ny}var yy=n("SpAZ");function vy(t,e){return e?Gp(()=>t,e):Gp(()=>t)}var gy=n("tf+s");const my=new r.l("angularfire2.auth.use-emulator"),_y=new r.l("angularfire2.auth.settings"),by=new r.l("angularfire2.auth.tenant-id"),wy=new r.l("angularfire2.auth.langugage-code"),Ey=new r.l("angularfire2.auth.use-device-language"),Cy=new r.l("angularfire.auth.persistence");let Oy=(()=>{class t{constructor(t,e,r,i,o,s,a,u,c,l){const h=new mt.d(i),f=Object(mt.h)(h),d=new Bp.a,p=Object(X.a)(void 0).pipe(Object(gt.b)(h.outsideAngular),Gp(()=>i.runOutsideAngular(()=>n.e(4).then(n.bind(null,"6nsN")))),Object(at.a)(()=>Object(mt.g)(t,i,e)),Object(at.a)(t=>i.runOutsideAngular(()=>{const e=o,n=s;return Object(mt.f)(t.name+".auth","AngularFireAuth",t,()=>{const r=i.runOutsideAngular(()=>t.auth());return e&&r.useEmulator("http://"+e.join(":")),a&&(r.tenantId=a),r.languageCode=u,c&&r.useDeviceLanguage(),n&&(r.settings=n),l&&r.setPersistence(l),r},[e,a,u,c,n,l])})),ey({bufferSize:1,refCount:!1}));if(v(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Object(X.a)(null);else{p.pipe(function(t,e){const n=arguments.length>=2;return r=>r.pipe(t?pt((e,n)=>t(e,n,r)):yy.a,oy(1),n?uy(e):hy(()=>new ny))}()).subscribe();const t=p.pipe(Gp(t=>t.getRedirectResult().then(t=>t,()=>null)),f,ey({bufferSize:1,refCount:!1})),e=t=>new J.a(e=>({unsubscribe:i.runOutsideAngular(()=>t(e))})),n=p.pipe(Gp(t=>e(t.onAuthStateChanged.bind(t)))),r=p.pipe(Gp(t=>e(t.onIdTokenChanged.bind(t))));this.authState=t.pipe(vy(n),Object(gy.a)(h.outsideAngular),Object(gt.b)(h.insideAngular)),this.user=t.pipe(vy(r),Object(gy.a)(h.outsideAngular),Object(gt.b)(h.insideAngular)),this.idToken=this.user.pipe(Gp(t=>t?Object($.a)(t.getIdToken()):Object(X.a)(null))),this.idTokenResult=this.user.pipe(Gp(t=>t?Object($.a)(t.getIdTokenResult()):Object(X.a)(null))),this.credential=Object(zp.a)(t,d,this.authState.pipe(pt(t=>!t))).pipe(Object(at.a)(t=>(null==t?void 0:t.user)?t:null),Object(gy.a)(h.outsideAngular),Object(gt.b)(h.insideAngular))}return Object(mt.i)(this,p,i,{spy:{apply:(t,e,n)=>{(t.startsWith("signIn")||t.startsWith("createUser"))&&n.then(t=>d.next(t))}}})}}return t.\u0275fac=function(e){return new(e||t)(r.wb(mt.c),r.wb(mt.b,8),r.wb(r.u),r.wb(r.s),r.wb(my,8),r.wb(_y,8),r.wb(by,8),r.wb(wy,8),r.wb(Ey,8),r.wb(Cy,8))},t.\u0275prov=Object(r.ob)({factory:function(){return new t(Object(r.wb)(mt.c),Object(r.wb)(mt.b,8),Object(r.wb)(r.u),Object(r.wb)(r.s),Object(r.wb)(my,8),Object(r.wb)(_y,8),Object(r.wb)(by,8),Object(r.wb)(wy,8),Object(r.wb)(Ey,8),Object(r.wb)(Cy,8))},token:t,providedIn:"any"}),t})();function Ty(t,e){return function(t,e=Y.a){return new J.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function Iy(t,e){return Ty(t,e).pipe(Object(at.a)(t=>({payload:t,type:"query"})))}function Sy(t,e){return Iy(t,e).pipe(nt(void 0),it(),Object(at.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function xy(t,e,n){return Sy(t,n).pipe(ut((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return Ny(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return Ny(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Ny(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),ht(),Object(at.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function Ny(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function jy(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}Object(mt.e)(Oy,[{app:null,applyActionCode:null,checkActionCode:null,confirmPasswordReset:null,createUserWithEmailAndPassword:null,currentUser:null,fetchSignInMethodsForEmail:null,isSignInWithEmailLink:null,getRedirectResult:null,languageCode:null,settings:null,onAuthStateChanged:null,onIdTokenChanged:null,sendSignInLinkToEmail:null,sendPasswordResetEmail:null,setPersistence:null,signInAndRetrieveDataWithCredential:null,signInAnonymously:null,signInWithCredential:null,signInWithCustomToken:null,signInWithEmailAndPassword:null,signInWithPhoneNumber:null,signInWithEmailLink:null,signInWithPopup:null,signInWithRedirect:null,signOut:null,tenantId:null,updateCurrentUser:null,useDeviceLanguage:null,useEmulator:null,verifyPasswordResetCode:null}]);class Ay{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=Sy(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(at.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(nt(void 0),it(),pt(([t,e])=>e.length>0||!t),Object(at.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(ut((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=jy(t);return xy(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Iy(this.query,this.afs.schedulers.outsideAngular).pipe(Object(at.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object($.a)(this.query.get(t)).pipe(Object(gt.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new ky(this.ref.doc(t),this.afs)}}class ky{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=My(n,e);return new Ay(r,i,this.afs)}snapshotChanges(){return Ty(this.ref,this.afs.schedulers.outsideAngular).pipe(nt(void 0),it(),Object(at.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(at.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object($.a)(this.ref.get(t)).pipe(Object(gt.b)(this.afs.schedulers.insideAngular))}}class Dy{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Sy(this.query,this.afs.schedulers.outsideAngular).pipe(Object(at.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),pt(t=>t.length>0),this.afs.keepUnstableUntilFirst):Sy(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(ut((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=jy(t);return xy(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Iy(this.query,this.afs.schedulers.outsideAngular).pipe(Object(at.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object($.a)(this.query.get(t)).pipe(Object(gt.b)(this.afs.schedulers.insideAngular))}}const Py=new r.l("angularfire2.enableFirestorePersistence"),Ry=new r.l("angularfire2.firestore.persistenceSettings"),Fy=new r.l("angularfire2.firestore.settings"),Ly=new r.l("angularfire2.firestore.use-emulator");function My(t,e=(t=>t)){return{query:e(t),ref:t}}let Vy=(()=>{class t{constructor(t,e,n,r,i,o,s,a,u){this.schedulers=new mt.d(o),this.keepUnstableUntilFirst=Object(mt.h)(this.schedulers);const c=Object(mt.g)(t,o,e);!_t.a.auth&&u&&Object(mt.j)();const l=a;[this.firestore,this.persistenceEnabled$]=Object(mt.f)(c.name+".firestore","AngularFirestore",c,()=>{const t=o.runOutsideAngular(()=>c.firestore());if(r&&t.settings(r),l&&t.useEmulator(...l),n&&!v(i)){const e=()=>{try{return Object($.a)(t.enablePersistence(s||void 0).then(()=>!0,()=>!1))}catch(Up){return"undefined"!=typeof console&&console.warn(Up),Object(X.a)(!1)}};return[t,o.runOutsideAngular(e)]}return[t,Object(X.a)(!1)]},[r,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=My(n,e),o=this.schedulers.ngZone.run(()=>r);return new Ay(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new Dy(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new ky(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(r.wb(mt.c),r.wb(mt.b,8),r.wb(Py,8),r.wb(Fy,8),r.wb(r.u),r.wb(r.s),r.wb(Ry,8),r.wb(Ly,8),r.wb(my,8))},t.\u0275prov=Object(r.ob)({factory:function(){return new t(Object(r.wb)(mt.c),Object(r.wb)(mt.b,8),Object(r.wb)(Py,8),Object(r.wb)(Fy,8),Object(r.wb)(r.u),Object(r.wb)(r.s),Object(r.wb)(Ry,8),Object(r.wb)(Ly,8),Object(r.wb)(my,8))},token:t,providedIn:"any"}),t})(),Uy=(()=>{class t{static enablePersistence(e){return{ngModule:t,providers:[{provide:Py,useValue:!0},{provide:Ry,useValue:e}]}}}return t.\u0275mod=r.qb({type:t}),t.\u0275inj=r.pb({factory:function(e){return new(e||t)},providers:[Vy]}),t})(),Hy=(()=>{class t{constructor(t){this.db=t}getBricks(t){return this.db.collection(t).valueChanges()}}return t.\u0275fac=function(e){return new(e||t)(r.wb(Vy))},t.\u0275prov=r.ob({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),qy=(()=>{class t{constructor(){this.onColorChange=new r.j}onBrickClick(t){this.onColorChange.emit(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.mb({type:t,selectors:[["app-bricks"]],inputs:{data:"data"},outputs:{onColorChange:"onColorChange"},decls:1,vars:2,consts:[[1,"brick",3,"click"]],template:function(t,e){1&t&&(r.ub(0,"div",0),r.zb("click",function(){return e.onBrickClick(e.data.id)}),r.tb()),2&t&&r.Eb("background-color",e.data.color)},styles:[".brick[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:5px;margin:5px;cursor:pointer}"]}),t})();function By(t,e){if(1&t){const t=r.vb();r.ub(0,"div",4),r.ub(1,"app-bricks",5),r.zb("onColorChange",function(e){return r.Cb(t),r.Ab().changeColor(e)}),r.tb(),r.tb()}if(2&t){const t=e.$implicit;r.lb(1),r.Bb("data",t)}}let zy=(()=>{class t{constructor(t,e){this.db=t,this.resourceService=e,this.items=[],this.state=!0,this.result="true"}ngOnInit(){this.resourceService.getBricks("Bricks").subscribe(t=>{t.length?this.items=t[0].bricks:this.setBricksRndColors("Bricks").then(t=>this.items=t)})}changeColor(t){const e=this.items.findIndex(e=>e.id===t);this.items[e].color=this.getRandomColor(),this.updateBricksColors(this.items,"Bricks"),this.result=this.state?"false":"true",this.state=!this.state,console.log(this.result),this.items[e].transition=2}setBricksRndColors(t){const e=new Array(9).fill(null).map(t=>({id:Math.floor(1e3*Math.random()),color:this.getRandomColor()}));return new Promise(n=>{this.updateBricksColors(e,t).then(t=>n(e))})}updateBricksColors(t,e){return new Promise(n=>{this.db.collection(e).doc(e).set({bricks:t}).then(e=>n(t))})}getRandomColor(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}}return t.\u0275fac=function(e){return new(e||t)(r.sb(Vy),r.sb(Hy))},t.\u0275cmp=r.mb({type:t,selectors:[["app-root"]],decls:5,vars:1,consts:[[1,"main"],[1,"main_brick"],["class","orders-container",4,"ngFor","ngForOf"],[1,"author"],[1,"orders-container"],[3,"data","onColorChange"]],template:function(t,e){1&t&&(r.ub(0,"div",0),r.ub(1,"div",1),r.Fb(2,By,2,1,"div",2),r.tb(),r.ub(3,"h1",3),r.Gb(4,"Author: Vlad Belenki"),r.tb(),r.tb()),2&t&&(r.lb(2),r.Bb("ngForOf",e.items))},directives:[d,qy],styles:[".main[_ngcontent-%COMP%]{width:100%;height:100%;background-image:url(pexels-daniel-absi-952670.755f1a40882d562dcdd0.jpg);background-repeat:no-repeat;background-size:100%}.main_brick[_ngcontent-%COMP%]{max-width:350px;display:flex;flex-wrap:wrap;position:relative;left:50%;top:50%;transform:translate(-50%,-50%)}.author[_ngcontent-%COMP%]{color:#fff;font-family:monospace;position:absolute;top:21%;left:9%;font-size:30px}"],data:{animation:[G("tr",[K("true  => false",[Q(2e3)]),K("false  => true",[Q(2e3)])])]}}),t})();var Wy=n("w1tV");class Gy extends rt.a{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class Qy extends rt.a{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var Ky=n("SeVD");function Yy(t,e,n,r,i=new Qy(t,n,r)){if(!i.closed)return e instanceof J.a?e.subscribe(i):Object(Ky.a)(e)(i)}class Jy{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new $y(t,this.observables,this.project))}}class $y extends Gy{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const r=e.length;this.values=new Array(r);for(let i=0;i<r;i++)this.toRespond.push(i);for(let i=0;i<r;i++)this.add(Yy(this,e[i],void 0,i))}notifyNext(t,e,n){this.values[n]=e;const r=this.toRespond;if(r.length>0){const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}class Xy{constructor(t){this.predicate=t}call(t,e){return e.subscribe(new Zy(t,this.predicate))}}class Zy extends rt.a{constructor(t,e){super(t),this.predicate=e,this.skipping=!0,this.index=0}_next(t){const e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)}tryCallPredicate(t){try{const e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(e){this.destination.error(e)}}}function tv(t){return null==t}function ev(t){return"function"==typeof t.set}function nv(t,e){return ev(e)?e:t.ref(e)}function rv(t,e){if("string"==typeof t)return e.stringCase();if(ev(t))return e.firebaseCase();if("function"==typeof t.exportVal)return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof t)}function iv(t,e,n="on",r=Y.a){return new J.a(i=>{let o=null;return o=t[n](e,(t,e)=>{r.schedule(()=>{i.next({snapshot:t,prevKey:e})}),"once"===n&&r.schedule(()=>i.complete())},t=>{r.schedule(()=>i.error(t))}),"on"===n?{unsubscribe(){null!=o&&t.off(e,o)}}:{unsubscribe(){}}}).pipe(Object(at.a)(t=>{const{snapshot:n,prevKey:r}=t;let i=null;return n.exists()&&(i=n.key),{type:e,payload:n,prevKey:r,key:i}}),Object(Wy.a)())}function ov(t,e){const n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function sv(t,e){const{payload:n,prevKey:r,key:i}=e,o=ov(t,i),s=function(t,e){if(tv(e))return 0;{const n=ov(t,e);return-1===n?t.length:n+1}}(t,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let n=null;e.payload.forEach(e=>{const r={payload:e,type:"value",prevKey:n,key:e.key};return n=e.key,t=[...t,r],!1})}return t;case"child_added":if(o>-1){const i=t[o-1];(i&&i.key||null)!==r&&(t=t.filter(t=>t.payload.key!==n.key)).splice(s,0,e)}else{if(null==r)return[e,...t];(t=t.slice()).splice(s,0,e)}return t;case"child_removed":return t.filter(t=>t.payload.key!==n.key);case"child_changed":return t.map(t=>t.payload.key===i?e:t);case"child_moved":if(o>-1){const e=t.splice(o,1)[0];return(t=t.slice()).splice(s,0,e),t}return t;default:return t}}function av(t){return(tv(t)||0===t.length)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function uv(t,e,n){return function(t,e,n){return iv(t,"value","once",n).pipe(Gp(r=>{const i=[Object(X.a)(r)];return e.forEach(e=>i.push(iv(t,e,"on",n))),Object(zp.a)(...i).pipe(ut(sv,[]))}),ht())}(t,e=av(e),n)}function cv(t,e,n){const r=(e=av(e)).map(e=>iv(t,e,"on",n));return Object(zp.a)(...r)}function lv(t,e){return function(n,r){return rv(n,{stringCase:()=>t.child(n)[e](r),firebaseCase:()=>n[e](r),snapshotCase:()=>n.ref[e](r)})}}function hv(t,e){return function(){return iv(t,"value","on",e)}}n("6Uf2");const fv=new r.l("angularfire2.realtimeDatabaseURL"),dv=new r.l("angularfire2.database.use-emulator");let pv=(()=>{class t{constructor(t,e,n,r,i,o,s){this.schedulers=new mt.d(i),this.keepUnstableUntilFirst=Object(mt.h)(this.schedulers);const a=o,u=Object(mt.g)(t,i,e);!_t.a.auth&&s&&Object(mt.j)(),this.database=Object(mt.f)(`${u.name}.database.${n}`,"AngularFireDatabase",u,()=>{const t=i.runOutsideAngular(()=>u.database(n||void 0));return a&&t.useEmulator(...a),t},[a])}list(t,e){const n=this.schedulers.ngZone.runOutsideAngular(()=>nv(this.database,t));let r=n;return e&&(r=e(n)),function(t,e){const n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:lv(r,"update"),set:lv(r,"set"),push:t=>r.push(t),remove:(i=r,function(t){return t?rv(t,{stringCase:()=>i.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):i.remove()}),snapshotChanges:r=>uv(t,r,n).pipe(e.keepUnstableUntilFirst),stateChanges:r=>cv(t,r,n).pipe(e.keepUnstableUntilFirst),auditTrail:r=>function(t,e,n){return function(t,e,n){return function(t,e){return iv(t,"value","on",e).pipe(Object(at.a)(t=>{let e;return t.payload.forEach(t=>(e=t.key,!1)),{data:t,lastKeyToLoad:e}}))}(t,n).pipe(function(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new Jy(t,n))}}(e),Object(at.a)(([t,e])=>{const n=t.lastKeyToLoad,r=e.map(t=>t.key);return{actions:e,lastKeyToLoad:n,loadedKeys:r}}),(r=t=>-1===t.loadedKeys.indexOf(t.lastKeyToLoad),t=>t.lift(new Xy(r))),Object(at.a)(t=>t.actions));var r}(t,cv(t,e).pipe(ut((t,e)=>[...t,e],[])),n)}(t,r,n).pipe(e.keepUnstableUntilFirst),valueChanges:(r,i)=>uv(t,r,n).pipe(Object(at.a)(t=>t.map(t=>i&&i.idField?Object.assign(Object.assign({},t.payload.val()),{[i.idField]:t.key}):t.payload.val())),e.keepUnstableUntilFirst)};var i}(r,this)}object(t){const e=this.schedulers.ngZone.runOutsideAngular(()=>nv(this.database,t));return r=this,{query:n=e,snapshotChanges:()=>hv(n,r.schedulers.outsideAngular)().pipe(r.keepUnstableUntilFirst),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>hv(n,r.schedulers.outsideAngular)().pipe(r.keepUnstableUntilFirst,Object(at.a)(t=>t.payload.exists()?t.payload.val():null))};var n,r}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return t.\u0275fac=function(e){return new(e||t)(r.wb(mt.c),r.wb(mt.b,8),r.wb(fv,8),r.wb(r.u),r.wb(r.s),r.wb(dv,8),r.wb(my,8))},t.\u0275prov=Object(r.ob)({factory:function(){return new t(Object(r.wb)(mt.c),Object(r.wb)(mt.b,8),Object(r.wb)(fv,8),Object(r.wb)(r.u),Object(r.wb)(r.s),Object(r.wb)(dv,8),Object(r.wb)(my,8))},token:t,providedIn:"any"}),t})(),yv=(()=>{class t{}return t.\u0275mod=r.qb({type:t}),t.\u0275inj=r.pb({factory:function(e){return new(e||t)},providers:[pv]}),t})(),vv=(()=>{class t{}return t.\u0275mod=r.qb({type:t,bootstrap:[zy]}),t.\u0275inj=r.pb({factory:function(e){return new(e||t)},providers:[Hy],imports:[[W,mt.a.initializeApp(i),yv,Uy]]}),t})();Object(r.I)(),B().bootstrapModule(vv).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"},zx2A:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return u});var r=n("7o/Q"),i=n("HDdC"),o=n("SeVD");class s extends r.a{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class a extends r.a{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function u(t,e){if(!e.closed)return t instanceof i.a?t.subscribe(e):Object(o.a)(t)(e)}}},[[0,0]]]);